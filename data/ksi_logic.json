{
  "KSI_AFR_01": {
    "title": "Apply the FedRAMP Minimum Assessment Standard (MAS) to identify and document the scope of the cloud service offering to be assessed for FedRAMP authorization and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Apply the FedRAMP Minimum Assessment Standard (MAS) to identify and document the scope of the cloud service offering to be assessed for FedRAMP authorization and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 Documentation\n\u2022 Quality\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "1 commands (1 successful): aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/minimum_assessment_scope.html"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_01(evidence_bundle):\n    \"\"\"\n    Apply the FedRAMP Minimum Assessment Standard (MAS) to identify and document the scope of the cloud service offering to be assessed for FedRAMP authorization and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/minimum_assessment_scope.html\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/minimum_assessment_scope.html')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Apply the FedRAMP Minimum Assessment Standard (MAS) to identify and document the scope of the cloud service offering to be assessed for FedRAMP authorization and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Apply the Fed...\")\n    \n    # Check: Documentation\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Documentation...\")\n    \n    # Check: Quality\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Quality...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_02": {
    "title": "Set security goals for the cloud service offering based on FedRAMP 20x Phase Two Key Security Indicators (KSIs - you are here), develop automated validation of status and progress to the greatest extent possible, and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Set security goals for the cloud service offering based on FedRAMP 20x Phase Two Key Security Indicators (KSIs - you are here), develop automated validation of status and progress to the greatest extent possible, and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 Documentation\n\u2022 Quality\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "1 commands (1 successful): aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_02(evidence_bundle):\n    \"\"\"\n    Set security goals for the cloud service offering based on FedRAMP 20x Phase Two Key Security Indicators (KSIs - you are here), develop automated validation of status and progress to the greatest extent possible, and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Set security goals for the cloud service offering based on FedRAMP 20x Phase Two Key Security Indicators (KSIs - you are here), develop automated validation of status and progress to the greatest extent possible, and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Set security ...\")\n    \n    # Check: Documentation\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Documentation...\")\n    \n    # Check: Quality\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Quality...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_03": {
    "title": "Determine how authorization data will be shared with all necessary parties in alignment with the FedRAMP Authorization Data Sharing (ADS) standard and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Determine how authorization data will be shared with all necessary parties in alignment with the FedRAMP Authorization Data Sharing (ADS) standard and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 Documentation\n\u2022 Quality\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "1 commands (1 successful): aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-03/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_03(evidence_bundle):\n    \"\"\"\n    Determine how authorization data will be shared with all necessary parties in alignment with the FedRAMP Authorization Data Sharing (ADS) standard and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Determine how authorization data will be shared with all necessary parties in alignment with the FedRAMP Authorization Data Sharing (ADS) standard and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Determine how...\")\n    \n    # Check: Documentation\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Documentation...\")\n    \n    # Check: Quality\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Quality...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_04": {
    "title": "Document the vulnerability detection and vulnerability response methodology used within the cloud service offering in alignment with the FedRAMP Vulnerability Detection and Response (VDR) standard and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Document the vulnerability detection and vulnerability response methodology used within the cloud service offering in alignment with the FedRAMP Vulnerability Detection and Response (VDR) standard and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 Technical\n\u2022 Documentation\n\u2022 Quality\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "2 commands (2 successful): aws inspector2 get-configuration --output json",
      "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-04/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_04(evidence_bundle):\n    \"\"\"\n    Document the vulnerability detection and vulnerability response methodology used within the cloud service offering in alignment with the FedRAMP Vulnerability Detection and Response (VDR) standard and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws inspector2 get-configuration --output json\n    evidence = run_cli('aws', args='inspector2 get-configuration --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Document the vulnerability detection and vulnerability response methodology used within the cloud service offering in alignment with the FedRAMP Vulnerability Detection and Response (VDR) standard and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Document the ...\")\n    \n    # Check: Technical\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Technical...\")\n    \n    # Check: Documentation\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Documentation...\")\n    \n    # Check: Quality\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Quality...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_05": {
    "title": "Determine how significant changes will be tracked and how all necessary parties will be notified in alignment with the FedRAMP Significant Change Notifications (SCN) standard and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Determine how significant changes will be tracked and how all necessary parties will be notified in alignment with the FedRAMP Significant Change Notifications (SCN) standard and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 Governance\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "2 commands (2 successful): aws codecommit get-file --repository-name security-governance --file-path procedures/scn_procedures.md --output json",
      "gh issue list --repo Meridian-Knowledge-Solutions/fedramp-20x-submission-final --state all --limit 30 --json number,title,state,labels,createdAt --jq '.' 2>/dev/null || echo '[]'"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-05/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_05(evidence_bundle):\n    \"\"\"\n    Determine how significant changes will be tracked and how all necessary parties will be notified in alignment with the FedRAMP Significant Change Notifications (SCN) standard and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path procedures/scn_procedures.md --output json\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path procedures/scn_procedures.md --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Determine how significant changes will be tracked and how all necessary parties will be notified in alignment with the FedRAMP Significant Change Notifications (SCN) standard and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Determine how...\")\n    \n    # Check: Governance\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Governance...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_06": {
    "title": "Maintain a plan and process for providing Ongoing Authorization Reports and Quarterly Reviews for all necessary parties in alignment with the FedRAMP Collaborative Continuous Monitoring (CCM) standard and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Maintain a plan and process for providing Ongoing Authorization Reports and Quarterly Reviews for all necessary parties in alignment with the FedRAMP Collaborative Continuous Monitoring (CCM) standard and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 Documentation\n\u2022 Quality\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "1 commands (1 successful): aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-06/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_06(evidence_bundle):\n    \"\"\"\n    Maintain a plan and process for providing Ongoing Authorization Reports and Quarterly Reviews for all necessary parties in alignment with the FedRAMP Collaborative Continuous Monitoring (CCM) standard and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Maintain a plan and process for providing Ongoing Authorization Reports and Quarterly Reviews for all necessary parties in alignment with the FedRAMP Collaborative Continuous Monitoring (CCM) standard and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Maintain a pl...\")\n    \n    # Check: Documentation\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Documentation...\")\n    \n    # Check: Quality\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Quality...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_07": {
    "title": "Develop secure by default configurations and provide guidance for secure configuration of the cloud service offering to customers in alignment with the FedRAMP Recommended Secure Configuration (RSC) guidance standard and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Develop secure by default configurations and provide guidance for secure configuration of the cloud service offering to customers in alignment with the FedRAMP Recommended Secure Configuration (RSC) guidance standard and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 Documentation\n\u2022 Quality\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "1 commands (1 successful): aws codecommit get-file --repository-name security-governance --file-path fedramp-20x-secure-configuration.md --output json"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-07/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_07(evidence_bundle):\n    \"\"\"\n    Develop secure by default configurations and provide guidance for secure configuration of the cloud service offering to customers in alignment with the FedRAMP Recommended Secure Configuration (RSC) guidance standard and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path fedramp-20x-secure-configuration.md --output json\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path fedramp-20x-secure-configuration.md --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Develop secure by default configurations and provide guidance for secure configuration of the cloud service offering to customers in alignment with the FedRAMP Recommended Secure Configuration (RSC) guidance standard and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Develop secur...\")\n    \n    # Check: Documentation\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Documentation...\")\n    \n    # Check: Quality\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Quality...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_08": {
    "title": "Operate a secure inbox to receive critical communication from FedRAMP and other government entities in alignment with FedRAMP Security Inbox (FSI) requirements and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Operate a secure inbox to receive critical communication from FedRAMP and other government entities in alignment with FedRAMP Security Inbox (FSI) requirements and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 MX Records\n\u2022 SPF\n\u2022 DMARC\n\u2022 Procedures\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "4 commands (4 successful): nslookup -type=MX meridianks.com | grep 'mail exchanger' || echo 'No MX records found'",
      "nslookup -type=TXT meridianks.com | grep -i 'v=spf1' || echo 'No SPF record found' (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-08/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_08(evidence_bundle):\n    \"\"\"\n    Operate a secure inbox to receive critical communication from FedRAMP and other government entities in alignment with FedRAMP Security Inbox (FSI) requirements and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: nslookup -type=MX meridianks.com | grep 'mail exchanger' || echo 'No MX records found'\n    evidence = run_cli('nslookup', args='-type=MX meridianks.com | grep 'mail exchanger' || echo 'No MX records found'')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Operate a secure inbox to receive critical communication from FedRAMP and other government entities in alignment with FedRAMP Security Inbox (FSI) requirements and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Operate a sec...\")\n    \n    # Check: MX Records\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: MX Records...\")\n    \n    # Check: SPF\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: SPF...\")\n    \n    # Check: DMARC\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: DMARC...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_09": {
    "title": "Persistently validate, assess, and report on the effectiveness and status of security decisions and policies that are implemented within the cloud service offering in alignment with the FedRAMP 20x Persistent Validation and Assessment (PVA) standard, and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Persistently validate, assess, and report on the effectiveness and status of security decisions and policies that are implemented within the cloud service offering in alignment with the FedRAMP 20x Persistent Validation and Assessment (PVA) standard, and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 Documentation\n\u2022 Quality\n\u2022 Technical\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "2 commands (1 successful): aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/fedramp-phase2-validation-architecture.mmd --output json",
      "gh run list --workflow \"FedRAMP 20x CLI Validation Pipeline + Phase 2 Master Validator\" --limit 1 --json name,status,conclusion,databaseId,updatedAt"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-09/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_09(evidence_bundle):\n    \"\"\"\n    Persistently validate, assess, and report on the effectiveness and status of security decisions and policies that are implemented within the cloud service offering in alignment with the FedRAMP 20x Persistent Validation and Assessment (PVA) standard, and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/fedramp-phase2-validation-architecture.mmd --output json\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/fedramp-phase2-validation-architecture.mmd --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Persistently validate, assess, and report on the effectiveness and status of security decisions and policies that are implemented within the cloud service offering in alignment with the FedRAMP 20x Persistent Validation and Assessment (PVA) standard, and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Persistently ...\")\n    \n    # Check: Documentation\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Documentation...\")\n    \n    # Check: Quality\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Quality...\")\n    \n    # Check: Technical\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Technical...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_10": {
    "title": "Integrate FedRAMP's Incident Communications Procedures (ICP) into incident response procedures and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Integrate FedRAMP's Incident Communications Procedures (ICP) into incident response procedures and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 Governance\n\u2022 Governance\n\u2022 Infrastructure\n\u2022 Infrastructure\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "4 commands (4 successful): aws codecommit get-file --repository-name security-governance --file-path procedures/icp_playbook.md --output json",
      "aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-10/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_10(evidence_bundle):\n    \"\"\"\n    Integrate FedRAMP's Incident Communications Procedures (ICP) into incident response procedures and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path procedures/icp_playbook.md --output json\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path procedures/icp_playbook.md --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Integrate FedRAMP's Incident Communications Procedures (ICP) into incident response procedures and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Integrate Fed...\")\n    \n    # Check: Governance\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Governance...\")\n    \n    # Check: Governance\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Governance...\")\n    \n    # Check: Infrastructure\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Infrastructure...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_AFR_11": {
    "title": "Ensure that cryptographic modules used to protect potentially sensitive federal customer data are selected and used in alignment with the FedRAMP 20x Using Cryptographic Modules (UCM) policy and persistently address all related requirements and recommendations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Ensure that cryptographic modules used to protect potentially sensitive federal customer data are selected and used in alignment with the FedRAMP 20x Using Cryptographic Modules (UCM) policy and persistently address all related requirements and recommendations.\n\nEvidence analyzed:\n\u2022 KMS Infrastructure\n\u2022 RDS Encryption\n\u2022 TLS Policies\n\u2022 UCM Policy\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "8 commands (7 successful): aws kms list-aliases --output json",
      "aws kms list-keys --output json (+6 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-AFR-11/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_AFR_11(evidence_bundle):\n    \"\"\"\n    Ensure that cryptographic modules used to protect potentially sensitive federal customer data are selected and used in alignment with the FedRAMP 20x Using Cryptographic Modules (UCM) policy and persistently address all related requirements and recommendations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws kms list-aliases --output json\n    evidence = run_cli('aws', args='kms list-aliases --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Ensure that cryptographic modules used to protect potentially sensitive federal customer data are selected and used in alignment with the FedRAMP 20x Using Cryptographic Modules (UCM) policy and persistently address all related requirements and recommendations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Ensure that c...\")\n    \n    # Check: KMS Infrastructure\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: KMS Infrastructure...\")\n    \n    # Check: RDS Encryption\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: RDS Encryption...\")\n    \n    # Check: TLS Policies\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: TLS Policies...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CED_01": {
    "title": "Require and monitor the effectiveness of training given to all employees on policies, procedures, and security-related topics.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Require and monitor the effectiveness of training given to all employees on policies, procedures, and security-related topics.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 10/10 (100%): \u2705 Specific security awareness training evidence found: cyber_security_training.png, security_training_roster.png, fedramp_role_based.png.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "1 commands (1 successful): evidence_check"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CED-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CED_01(evidence_bundle):\n    \"\"\"\n    Require and monitor the effectiveness of training given to all employees on policies, procedures, and security-related topics.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: evidence_check\n    evidence = run_cli('evidence_check', args='evidence_check')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Require and monitor the effectiveness of training given to all employees on policies, procedures, and security-related topics.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Require and m...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CED_02": {
    "title": "Require and monitor the effectiveness of role-specific training for high risk roles, including at least roles with privileged access.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Require and monitor the effectiveness of role-specific training for high risk roles, including at least roles with privileged access.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 10/10 (100%): \u2705 Role-specific and privileged access training evidence found: fedramp_role_based.png, cyber_security_training.png, security_training_roster.png.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "1 commands (1 successful): evidence_check"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CED-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CED_02(evidence_bundle):\n    \"\"\"\n    Require and monitor the effectiveness of role-specific training for high risk roles, including at least roles with privileged access.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: evidence_check\n    evidence = run_cli('evidence_check', args='evidence_check')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Require and monitor the effectiveness of role-specific training for high risk roles, including at least roles with privileged access.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Require and m...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CED_03": {
    "title": "Require and monitor the effectiveness of role-specific training provided to development and engineering staff that covers best practices for delivering secure software.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Require and monitor the effectiveness of role-specific training provided to development and engineering staff that covers best practices for delivering secure software.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u274c Insufficient 3/7 (43%): \u2705 Development security automation: Found 2 potentially security-related Lambda function(s).; \u2705 Enterprise governance: AWS Organizations detected (enables central training/security policies).\n",
    "passing_criteria": "Failure: Did not meet minimum evidence requirements.",
    "cli_commands": [
      "3 commands (3 successful): aws lambda list-functions --output json",
      "aws events list-rules --output json",
      "aws organizations describe-organization --output json"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CED-03/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CED_03(evidence_bundle):\n    \"\"\"\n    Require and monitor the effectiveness of role-specific training provided to development and engineering staff that covers best practices for delivering secure software.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws lambda list-functions --output json\n    evidence = run_cli('aws', args='lambda list-functions --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Require and monitor the effectiveness of role-specific training provided to development and engineering staff that covers best practices for delivering secure software.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Require and m...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CED_04": {
    "title": "Require and monitor the effectiveness of role-specific training to staff involved with incident response or disaster recovery.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Require and monitor the effectiveness of role-specific training to staff involved with incident response or disaster recovery.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: Below threshold: 3/5 (60.0%) - requires 64.0% for MODERATE impact: \u26a0\ufe0f Files found but filenames lack keywords (expected 'incident', 'dr', etc.): cli_output.json\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "1 commands (1 successful): evidence_check"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CED-04/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CED_04(evidence_bundle):\n    \"\"\"\n    Require and monitor the effectiveness of role-specific training to staff involved with incident response or disaster recovery.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: evidence_check\n    evidence = run_cli('evidence_check', args='evidence_check')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Require and monitor the effectiveness of role-specific training to staff involved with incident response or disaster recovery.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Require and m...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CMT_01": {
    "title": "Log and monitor modifications to the cloud service offering.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Log and monitor modifications to the cloud service offering.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 20/20 (100%): \u2705 System modification logging: 1/1 CloudTrail trails configured.; \u2139\ufe0f Trail activity status not provided; assuming active based on configuration.; \u2705 Global service modification tracking: 1/1 trails monitoring global AWS services.; \u2705 Multi-region modification coverage: 1/1 trails across regions.; \u2705 Encrypted modification logs: 1/1 trails use KMS encryption.; \u2705 Tamper-resistant modification logs: 1/1 trails have log file validation enabled.; \u2705 Centralized logging: 1/1 trails configured as Organization trails.; \u2705 Comprehensive event logging: 33 CloudWatch log groups found.; \u2705 Real-time modification detection: 12 relevant EventBridge rules enabled.; \u2705 Modification alerting: 13 potentially relevant CloudWatch alarms found.; \u2705 Modification notification infrastructure: 10 SNS topics available.; \u2705 Automated modification response: 2 potentially relevant Lambda functions found.; \u2705 Instance-level modification tracking capability: 6/6 SSM-managed instances online.; \u2705 Enterprise-wide modification governance: AWS Organizations enables centralized change tracking.; \u2705 Advanced organization features: SCPs available for modification policy enforcement.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "9 commands (9 successful): aws cloudtrail describe-trails --output json",
      "aws cloudtrail describe-trails --output json | jq -r '.trailList[].TrailARN' | xargs -I {} aws cloudtrail get-trail-status --name {} --output json | jq -s '.' || echo '[]' (+7 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CMT-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CMT_01(evidence_bundle):\n    \"\"\"\n    Log and monitor modifications to the cloud service offering.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws cloudtrail describe-trails --output json\n    evidence = run_cli('aws', args='cloudtrail describe-trails --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Log and monitor modifications to the cloud service offering.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Log and monit...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CMT_02": {
    "title": "Execute changes though redeployment of version controlled immutable resources rather than direct modification wherever possible",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Execute changes though redeployment of version controlled immutable resources rather than direct modification wherever possible\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 20/20 (100%): \u2705 External Terraform Evidence: 10 managed files documented.; \u2705 Automated immutable deployment: GitHub Actions CI/CD integration detected.; \u2705 External Terraform management approach documented.; \ud83c\udfaf Infrastructure as Code (IaC) validated via external Terraform evidence.; \u2705 Immutable serverless-first architecture: 20 Lambda functions detected (inherently immutable).; \u2705 Enterprise-wide immutable deployment governance: AWS Organizations enables centralized policies.; \u2705 Advanced organization features: SCPs available for immutable deployment policy enforcement.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "9 commands (9 successful): aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE --output json",
      "aws ec2 describe-instances --query 'Reservations[*].Instances[*].[InstanceId,ImageId,LaunchTime]' --output json (+7 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CMT-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CMT_02(evidence_bundle):\n    \"\"\"\n    Execute changes though redeployment of version controlled immutable resources rather than direct modification wherever possible\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE --output json\n    evidence = run_cli('aws', args='cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Execute changes though redeployment of version controlled immutable resources rather than direct modification wherever possible\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Execute chang...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CMT_03": {
    "title": "Automate persistent testing and validation of changes throughout deployment.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Automate persistent testing and validation of changes throughout deployment.\n\nEvidence analyzed:\n\u2022 Persistent Validation\n\u2022 Automated Testing\n\u2022 Automated Testing\n\u2022 Automated Testing\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "1 commands (1 successful): aws configservice describe-config-rules --output json"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CMT-03/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CMT_03(evidence_bundle):\n    \"\"\"\n    Automate persistent testing and validation of changes throughout deployment.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws configservice describe-config-rules --output json\n    evidence = run_cli('aws', args='configservice describe-config-rules --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Automate persistent testing and validation of changes throughout deployment.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Automate pers...\")\n    \n    # Check: Persistent Validation\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Persistent Validation...\")\n    \n    # Check: Automated Testing\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Automated Testing...\")\n    \n    # Check: Automated Testing\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Automated Testing...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CMT_04": {
    "title": "Always follow a documented change management procedure.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Always follow a documented change management procedure.\n\nEvidence analyzed:\n\u2022 Documentation\n\u2022 Evidence\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "2 commands (2 successful): aws codecommit get-file --repository-name security-governance --file-path procedures/change-management-procedure.md",
      "aws s3 ls s3://mks-states/plans/ --recursive"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CMT-04/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CMT_04(evidence_bundle):\n    \"\"\"\n    Always follow a documented change management procedure.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path procedures/change-management-procedure.md\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path procedures/change-management-procedure.md')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Always follow a documented change management procedure.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Always follow...\")\n    \n    # Check: Documentation\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Documentation...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CNA_01": {
    "title": "Configure all machine-based information resources to limit inbound and outbound network traffic.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Configure all machine-based information resources to limit inbound and outbound network traffic.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 16/16 (97%): \u2705 VPC infrastructure: 1 VPC(s) detected; \u2705 Strong ingress controls: 15/15 security groups restrictive; \u2705 Strong egress controls: 14/15 security groups control outbound traffic; \u2705 Default security group properly secured; \u2705 Custom network controls: 1/1 Network ACLs with custom traffic filtering rules; \u2705 Controlled egress routing: 1 private route tables with NAT gateway routing; \u2705 Managed egress: 1 NAT gateways for controlled outbound access; \u2705 Private service access: 7 VPC endpoints reduce internet-bound traffic; \u2705 Application-layer protection: 1 WAF Web ACLs configured; \u2705 Traffic distribution: 1 load balancers (1 public, 0 internal); \u2705 Traffic visibility: 2 VPC Flow Log groups for traffic monitoring\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "8 commands (8 successful): aws ec2 describe-security-groups --output json",
      "aws ec2 describe-network-acls --output json (+6 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CNA-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CNA_01(evidence_bundle):\n    \"\"\"\n    Configure all machine-based information resources to limit inbound and outbound network traffic.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws ec2 describe-security-groups --output json\n    evidence = run_cli('aws', args='ec2 describe-security-groups --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Configure all machine-based information resources to limit inbound and outbound network traffic.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Configure all...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CNA_02": {
    "title": "Design systems to minimize the attack surface and minimize lateral movement if compromised.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Design systems to minimize the attack surface and minimize lateral movement if compromised.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Strong 17/20 (85%): \u2705 Strong attack surface minimization: 6/8 private subnets (75%); \u2705 Good AZ segmentation: 8 subnets across 2 availability zones; \u2705 Strong micro-segmentation: 14/15 custom security groups; \u2705 Lateral movement barriers: 11/15 security groups with specific rules; \u2705 Minimal compute exposure: 9/9 instances in private subnets; \u2705 Database isolation: All 1 RDS instances private; \u2705 Controlled service exposure: Single internet-facing load balancer with private backend services; \u2705 Lambda isolation: 2/20 functions in VPC; \u2705 Advanced segmentation barriers: 1/1 Network ACLs with custom isolation rules\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "7 commands (7 successful): aws ec2 describe-subnets --output json",
      "aws ec2 describe-security-groups --output json (+5 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CNA-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CNA_02(evidence_bundle):\n    \"\"\"\n    Design systems to minimize the attack surface and minimize lateral movement if compromised.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws ec2 describe-subnets --output json\n    evidence = run_cli('aws', args='ec2 describe-subnets --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Design systems to minimize the attack surface and minimize lateral movement if compromised.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Design system...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CNA_03": {
    "title": "Use logical networking and related capabilities to enforce traffic flow controls.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Use logical networking and related capabilities to enforce traffic flow controls.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 17/16 (106%): \u2705 Logical routing infrastructure: 5/5 route tables with intentional traffic flows; \u2705 Advanced routing patterns: 4 route tables with custom traffic control; \u2705 Advanced network access control: 1/1 NACLs with custom traffic flow policies; \u2705 Advanced service routing: 7 VPC endpoints (1 gateway, 4 interface, 2 GWLB); \u2705 Single-VPC architecture: No Transit Gateways needed (appropriate design); \u2705 Application-layer traffic control: 1 Application Load Balancers; \u2705 Controlled egress routing: 1 active NAT Gateways; \u2705 Traffic flow monitoring: 2 VPC Flow Log groups found.\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "7 commands (7 successful): aws ec2 describe-route-tables --output json",
      "aws ec2 describe-network-acls --output json (+5 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CNA-03/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CNA_03(evidence_bundle):\n    \"\"\"\n    Use logical networking and related capabilities to enforce traffic flow controls.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws ec2 describe-route-tables --output json\n    evidence = run_cli('aws', args='ec2 describe-route-tables --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Use logical networking and related capabilities to enforce traffic flow controls.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Use logical n...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CNA_04": {
    "title": "Use immutable infrastructure with strictly defined functionality and privileges by default.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Use immutable infrastructure with strictly defined functionality and privileges by default.\n\nEvidence analyzed:\n\u2022 Least Privilege\n\u2022 Network Security\n\u2022 IaC Controls\n\u2022 IaC Controls\n\u2022 Foundational IaC\n\u2022 Serverless Adoption\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "5 commands (5 successful): aws s3 ls s3://mks-states/ --recursive",
      "aws lambda list-functions --output json (+3 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CNA-04/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CNA_04(evidence_bundle):\n    \"\"\"\n    Use immutable infrastructure with strictly defined functionality and privileges by default.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws s3 ls s3://mks-states/ --recursive\n    evidence = run_cli('aws', args='s3 ls s3://mks-states/ --recursive')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Use immutable infrastructure with strictly defined functionality and privileges by default.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Use immutable...\")\n    \n    # Check: Least Privilege\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Least Privilege...\")\n    \n    # Check: Network Security\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Network Security...\")\n    \n    # Check: IaC Controls\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: IaC Controls...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CNA_05": {
    "title": "Protect against denial of service attacks and other unwanted activity.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Protect against denial of service attacks and other unwanted activity.\n\nEvidence analyzed:\n\u2022 DDoS\n\u2022 DDoS\n\u2022 DDoS\n\u2022 Spam\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "9 commands (9 successful): aws wafv2 list-web-acls --scope REGIONAL --output json",
      "aws wafv2 list-web-acls --scope CLOUDFRONT --region us-east-1 --output json (+7 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CNA-05/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CNA_05(evidence_bundle):\n    \"\"\"\n    Protect against denial of service attacks and other unwanted activity.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws wafv2 list-web-acls --scope REGIONAL --output json\n    evidence = run_cli('aws', args='wafv2 list-web-acls --scope REGIONAL --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Protect against denial of service attacks and other unwanted activity.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Protect again...\")\n    \n    # Check: DDoS\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: DDoS...\")\n    \n    # Check: DDoS\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: DDoS...\")\n    \n    # Check: DDoS\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: DDoS...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CNA_06": {
    "title": "Design systems for high availability and rapid recovery.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Design systems for high availability and rapid recovery.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 12/14.5 (86%): \u2705 Strong network HA: 8 subnets across 2 AZs; \u2705 Balanced subnet distribution across availability zones; \u2705 Application HA: 1 multi-AZ load balancer(s) providing traffic distribution; \u2705 Active backup strategy: 2/2 AWS Backup plan(s) with recent execution; \u2705 Storage redundancy: 10 S3 bucket(s) with built-in 11-9s durability; \u2705 Database HA-ready: 1/1 RDS instance(s) with multi-AZ subnet groups (easily convertible); \u2705 Bonus: Enhanced storage recovery via 976 EBS snapshot(s) managed by AWS Backup; \u2705 DNS infrastructure: 1 Route 53 hosted zone(s)\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "9 commands (9 successful): aws ec2 describe-subnets --output json",
      "aws ec2 describe-availability-zones --output json (+7 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CNA-06/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CNA_06(evidence_bundle):\n    \"\"\"\n    Design systems for high availability and rapid recovery.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws ec2 describe-subnets --output json\n    evidence = run_cli('aws', args='ec2 describe-subnets --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Design systems for high availability and rapid recovery.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Design system...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CNA_07": {
    "title": "Ensure cloud-native information resources are implemented based on host provider's best practices and documented guidance.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Ensure cloud-native information resources are implemented based on host provider's best practices and documented guidance.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 30/30 (98%): \u2705 CloudTrail excellently configured: 'meridianks-Management-events' ready for activation (cost-optimized for pilot); \u2705 Multi-region audit coverage: CloudTrail spans all AWS regions; \u2705 Log integrity protection: CloudTrail log file validation enabled; \u2705 Encrypted audit logs: CloudTrail using KMS encryption; \u2705 Global service monitoring: CloudTrail capturing global AWS events; \u2705 Real-time log analysis: CloudTrail integrated with CloudWatch Logs; \u2705 Enterprise governance: Organization-wide CloudTrail; \u2705 Encryption key management: 17 KMS keys for data protection; \u2705 IAM best practices: 97 roles vs 0 users (service-oriented architecture); \u2705 Excellent reliability architecture: 1/1 load balancers multi-AZ; \u2705 Standardized deployment patterns: Infrastructure as Code approach detected (appropriate for pilot); \u2705 Active data protection: 2/2 backup plan(s) with recent execution; \u2705 Performance optimization: 6/6 instances using modern types; \u2705 Storage optimization: 10 S3 buckets (cost-effective storage); \u2705 Proactive monitoring: 13 CloudWatch alarms; \u2705 Compliance automation: 333 active Config rules; \u2705 Enterprise governance: AWS Organizations with ALL features enabled (including SCPs)\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "15 commands (15 successful): aws configservice describe-config-rules --output json",
      "aws cloudtrail describe-trails --output json (+13 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CNA-07/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CNA_07(evidence_bundle):\n    \"\"\"\n    Ensure cloud-native information resources are implemented based on host provider's best practices and documented guidance.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws configservice describe-config-rules --output json\n    evidence = run_cli('aws', args='configservice describe-config-rules --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Ensure cloud-native information resources are implemented based on host provider's best practices and documented guidance.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Ensure cloud-...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_CNA_08": {
    "title": "Use automated services to persistently assess the security posture of all machine-based information resources and automatically enforce their intended operational state.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Use automated services to persistently assess the security posture of all machine-based information resources and automatically enforce their intended operational state.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Strong 10/12 (83%): \u2705 Measurement Framework: Basic - 1/1 Security Hub standard(s) READY.; \u2705 Measurement Instruments: Extensive - 333 AWS Config rules deployed.; \u2705 Active Measurement: At least one Config recorder is actively capturing data successfully.; \u2705 Measurement Visibility: Centralized - Security Hub is enabled.\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "7 commands (7 successful): aws securityhub get-enabled-standards --output json",
      "aws configservice describe-config-rules --output json (+5 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-CNA-08/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_CNA_08(evidence_bundle):\n    \"\"\"\n    Use automated services to persistently assess the security posture of all machine-based information resources and automatically enforce their intended operational state.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws securityhub get-enabled-standards --output json\n    evidence = run_cli('aws', args='securityhub get-enabled-standards --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Use automated services to persistently assess the security posture of all machine-based information resources and automatically enforce their intended operational state.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Use automated...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_IAM_01": {
    "title": "Enforce multi-factor authentication (MFA) using methods that are difficult to intercept or impersonate (phishing-resistant MFA) for all user authentication.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Enforce multi-factor authentication (MFA) using methods that are difficult to intercept or impersonate (phishing-resistant MFA) for all user authentication.\n\nEvidence analyzed:\n\u2022 Modern Identity\n\u2022 Federation\n\u2022 IAM Hygiene\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "5 commands (5 successful): aws iam list-users --output json",
      "aws sso-admin list-instances --output json (+3 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-IAM-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_IAM_01(evidence_bundle):\n    \"\"\"\n    Enforce multi-factor authentication (MFA) using methods that are difficult to intercept or impersonate (phishing-resistant MFA) for all user authentication.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws iam list-users --output json\n    evidence = run_cli('aws', args='iam list-users --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Enforce multi-factor authentication (MFA) using methods that are difficult to intercept or impersonate (phishing-resistant MFA) for all user authentication.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Enforce multi...\")\n    \n    # Check: Modern Identity\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Modern Identity...\")\n    \n    # Check: Federation\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Federation...\")\n    \n    # Check: IAM Hygiene\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: IAM Hygiene...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_IAM_02": {
    "title": "Use secure passwordless methods for user authentication and authorization when feasible, otherwise enforce strong passwords with MFA.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Use secure passwordless methods for user authentication and authorization when feasible, otherwise enforce strong passwords with MFA.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Strong 5/6 (83%): \u2705 1 SAML providers configured (passwordless authentication); \u2705 Using temporary credentials (assumed role - passwordless method); \u2705 Centralized MFA via SAML/IdP assumed (IAM MFA devices not strictly required).\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "4 commands (4 successful): aws iam list-saml-providers --output json",
      "aws iam list-virtual-mfa-devices --output json (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-IAM-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_IAM_02(evidence_bundle):\n    \"\"\"\n    Use secure passwordless methods for user authentication and authorization when feasible, otherwise enforce strong passwords with MFA.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws iam list-saml-providers --output json\n    evidence = run_cli('aws', args='iam list-saml-providers --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Use secure passwordless methods for user authentication and authorization when feasible, otherwise enforce strong passwords with MFA.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Use secure pa...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_IAM_03": {
    "title": "Enforce appropriately secure authentication methods for non-user accounts and services.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Enforce appropriately secure authentication methods for non-user accounts and services.\n\nEvidence analyzed:\n\u2022 Roles\n\u2022 EC2 Security\n\u2022 IAM Hygiene\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "4 commands (4 successful): aws iam list-roles --output json",
      "aws iam list-users --output json (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-IAM-03/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_IAM_03(evidence_bundle):\n    \"\"\"\n    Enforce appropriately secure authentication methods for non-user accounts and services.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws iam list-roles --output json\n    evidence = run_cli('aws', args='iam list-roles --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Enforce appropriately secure authentication methods for non-user accounts and services.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Enforce appro...\")\n    \n    # Check: Roles\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Roles...\")\n    \n    # Check: EC2 Security\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: EC2 Security...\")\n    \n    # Check: IAM Hygiene\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: IAM Hygiene...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_IAM_04": {
    "title": "Use a least-privileged, role and attribute-based, and just-in-time security authorization model for all user and non-user accounts and services.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Use a least-privileged, role and attribute-based, and just-in-time security authorization model for all user and non-user accounts and services.\n\nEvidence analyzed:\n\u2022 Modern Auth\n\u2022 Role Mapping\n\u2022 Least Privilege\n\u2022 Just-in-Time\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "7 commands (7 successful): aws sso-admin list-instances --output json",
      "aws sso-admin list-instances --output json | jq -r '.Instances[].InstanceArn' | xargs -I {} aws sso-admin list-permission-sets --instance-arn {} --output json | jq -s '.' || echo '[]' (+5 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-IAM-04/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_IAM_04(evidence_bundle):\n    \"\"\"\n    Use a least-privileged, role and attribute-based, and just-in-time security authorization model for all user and non-user accounts and services.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws sso-admin list-instances --output json\n    evidence = run_cli('aws', args='sso-admin list-instances --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Use a least-privileged, role and attribute-based, and just-in-time security authorization model for all user and non-user accounts and services.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Use a least-p...\")\n    \n    # Check: Modern Auth\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Modern Auth...\")\n    \n    # Check: Role Mapping\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Role Mapping...\")\n    \n    # Check: Least Privilege\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Least Privilege...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_IAM_05": {
    "title": "Configure identity and access management with measures that always verify each user or device can only access the resources they need.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Configure identity and access management with measures that always verify each user or device can only access the resources they need.\n\nEvidence analyzed:\n\u2022 Identity\n\u2022 Segmentation\n\u2022 Credentials\n\u2022 Secure Communications\n\u2022 Monitoring\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "10 commands (10 successful): aws iam list-users --output json",
      "aws sso-admin list-instances --output json (+8 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-IAM-05/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_IAM_05(evidence_bundle):\n    \"\"\"\n    Configure identity and access management with measures that always verify each user or device can only access the resources they need.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws iam list-users --output json\n    evidence = run_cli('aws', args='iam list-users --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Configure identity and access management with measures that always verify each user or device can only access the resources they need.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Configure ide...\")\n    \n    # Check: Identity\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Identity...\")\n    \n    # Check: Segmentation\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Segmentation...\")\n    \n    # Check: Credentials\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Credentials...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_IAM_06": {
    "title": "Automatically disable or otherwise secure accounts with privileged access in response to suspicious activity",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Automatically disable or otherwise secure accounts with privileged access in response to suspicious activity\n\nEvidence analyzed:\n\u2022 Detection\n\u2022 Detection\n\u2022 Triggering\n\u2022 Response\n\u2022 Response\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "5 commands (5 successful): aws guardduty list-detectors --output json",
      "aws securityhub describe-hub --output json (+3 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-IAM-06/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_IAM_06(evidence_bundle):\n    \"\"\"\n    Automatically disable or otherwise secure accounts with privileged access in response to suspicious activity\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws guardduty list-detectors --output json\n    evidence = run_cli('aws', args='guardduty list-detectors --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Automatically disable or otherwise secure accounts with privileged access in response to suspicious activity\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Automatically...\")\n    \n    # Check: Detection\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Detection...\")\n    \n    # Check: Detection\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Detection...\")\n    \n    # Check: Triggering\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Triggering...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_IAM_07": {
    "title": "Securely manage the lifecycle and privileges of all accounts, roles, and groups, using automation.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Securely manage the lifecycle and privileges of all accounts, roles, and groups, using automation.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Strong 8/10 (80%): \u2705 Service Oriented Architecture: Excellent - 97 roles with 0 IAM users indicates strong role-based access.; \u2705 Active Lifecycle Management: 17/21 custom policies updated in the last 90 days.; \u2705 Advanced Identity Management: AWS Identity Center is active (1 instance(s) found). Enables central privilege/access reviews.\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "4 commands (4 successful): aws iam list-roles --output json",
      "aws iam list-users --output json (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-IAM-07/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_IAM_07(evidence_bundle):\n    \"\"\"\n    Securely manage the lifecycle and privileges of all accounts, roles, and groups, using automation.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws iam list-roles --output json\n    evidence = run_cli('aws', args='iam list-roles --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Securely manage the lifecycle and privileges of all accounts, roles, and groups, using automation.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Securely mana...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_INR_01": {
    "title": "Always follow a documented incident response procedure.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Always follow a documented incident response procedure.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 11/11 (100%): \u2705 Incident response plan documented in CodeCommit.; \u2705 Incident response plan appears comprehensive (based on size >5KB).; \u2705 Security Hub integration detected (50 findings tracked).; \u2705 GuardDuty threat detection enabled (1 detectors).; \u2705 CloudTrail audit logging configured (1 trails).; \u2705 Incident response plan maintenance: 1 recent update(s) detected.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "8 commands (8 successful): aws codecommit get-repository --repository-name security-governance --output json",
      "aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json (+6 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-INR-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_INR_01(evidence_bundle):\n    \"\"\"\n    Always follow a documented incident response procedure.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-repository --repository-name security-governance --output json\n    evidence = run_cli('aws', args='codecommit get-repository --repository-name security-governance --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Always follow a documented incident response procedure.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Always follow...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_INR_02": {
    "title": "Maintain a log of incidents and periodically review past incidents for patterns or vulnerabilities.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Maintain a log of incidents and periodically review past incidents for patterns or vulnerabilities.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 10/10 (100%): \u2705 Incident response infrastructure fully configured (4/4 components found).; \u2705 Operational log artifact ('incident_database.csv') found and valid (1 incidents).; \u2705 Periodic review report artifact ('quarterly_incident_review_minutes.md') found and appears valid.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "5 commands (5 successful): aws events list-rules --output json",
      "aws logs describe-log-groups --output json (+3 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-INR-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_INR_02(evidence_bundle):\n    \"\"\"\n    Maintain a log of incidents and periodically review past incidents for patterns or vulnerabilities.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws events list-rules --output json\n    evidence = run_cli('aws', args='events list-rules --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Maintain a log of incidents and periodically review past incidents for patterns or vulnerabilities.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Maintain a lo...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_INR_03": {
    "title": "Generate after action reports and regularly incorporate lessons learned into operations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Generate after action reports and regularly incorporate lessons learned into operations.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 10/10 (100%): \u2705 Incident analysis capability: Security Hub findings accessible.; \u2705 Automated reporting: 4 Lambda functions for after-action reporting deployed.; \u2705 Continuous improvement framework: Security Hub standards definitions available.; \u2705 Standards actively enabled: 1 Security Hub standard(s) are enabled and READY.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "4 commands (4 successful): aws securityhub get-findings --max-results 50 --output json",
      "aws lambda list-functions --output json (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-INR-03/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_INR_03(evidence_bundle):\n    \"\"\"\n    Generate after action reports and regularly incorporate lessons learned into operations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws securityhub get-findings --max-results 50 --output json\n    evidence = run_cli('aws', args='securityhub get-findings --max-results 50 --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Generate after action reports and regularly incorporate lessons learned into operations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Generate afte...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_MLA_01": {
    "title": "Operate a Security Information and Event Management (SIEM) or similar system(s) for centralized, tamper-resistent logging of events, activities, and changes.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Operate a Security Information and Event Management (SIEM) or similar system(s) for centralized, tamper-resistent logging of events, activities, and changes.\n\nEvidence analyzed:\n\u2022 Collection\n\u2022 Integrity\n\u2022 Storage\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "7 commands (7 successful): aws cloudtrail describe-trails --output json",
      "aws cloudtrail describe-trails --output json | jq -r '.trailList[].TrailARN' | xargs -I {} aws cloudtrail get-trail-status --name {} --output json | jq -s '.' || echo '[]' (+5 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-MLA-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_MLA_01(evidence_bundle):\n    \"\"\"\n    Operate a Security Information and Event Management (SIEM) or similar system(s) for centralized, tamper-resistent logging of events, activities, and changes.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws cloudtrail describe-trails --output json\n    evidence = run_cli('aws', args='cloudtrail describe-trails --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Operate a Security Information and Event Management (SIEM) or similar system(s) for centralized, tamper-resistent logging of events, activities, and changes.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Operate a Sec...\")\n    \n    # Check: Collection\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Collection...\")\n    \n    # Check: Integrity\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Integrity...\")\n    \n    # Check: Storage\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Storage...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_MLA_02": {
    "title": "Regularly review and audit logs.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Regularly review and audit logs.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Strong 15/18 (83%): \u2705 Log review notifications: 10 SNS topics available for alert delivery.; \u2705 Manual review capability: 33 log groups available for analysis.; \u2705 Automated log monitoring: 7 potentially log-related CloudWatch alarms found.; \u2705 Security-focused review: 13 potentially security-related alarms detected.; \u2705 Advanced log correlation: 1 Security Hub insights available for intelligent analysis.; \u2705 Audit event analysis: 10 recent CloudTrail events retrieved via lookup (indicates analysis capability).; \u2705 Custom log processing: 1 Lambda functions potentially used for advanced log analysis.; \u2705 Compliance retention: 31/33 log groups with explicit retention policies (94%).; \u2705 Long-term audit capability: 26/33 log groups meet compliance retention (>= 365 days).; \u2705 Enterprise log aggregation: AWS Organizations enables centralized multi-account log review.\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "8 commands (8 successful): aws cloudwatch describe-alarms --output json",
      "aws logs describe-metric-filters --output json (+6 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-MLA-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_MLA_02(evidence_bundle):\n    \"\"\"\n    Regularly review and audit logs.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws cloudwatch describe-alarms --output json\n    evidence = run_cli('aws', args='cloudwatch describe-alarms --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Regularly review and audit logs.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Regularly rev...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_MLA_05": {
    "title": "Perform Infrastructure as Code and configuration evaluation and testing.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Perform Infrastructure as Code and configuration evaluation and testing.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 20/20 (100%): \u2705 Automated change management: Validated via external CI/CD evidence (GitHub Actions, Terraform).; \u2705 IaC change process: Validated via external Terraform evidence (10 files).; \u2705 Configuration compliance evaluation: 333 active Config rules detected.; \u2705 Centralized configuration management: 7 SSM parameters found.; \u2705 Resource governance: 7 resources found with IaC-related tags.; \u2705 Deployment audit trail: 20 relevant change events found in CloudTrail.; \u2705 Organizational infrastructure: Centralized account management (o-wfu71gr2nf).; \u2705 Enterprise multi-account governance: AWS Organizations with ALL features enabled (SCPs available).\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "5 commands (5 successful): aws configservice describe-config-rules --output json",
      "aws ssm describe-parameters --max-results 50 --output json (+3 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-MLA-05/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_MLA_05(evidence_bundle):\n    \"\"\"\n    Perform Infrastructure as Code and configuration evaluation and testing.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws configservice describe-config-rules --output json\n    evidence = run_cli('aws', args='configservice describe-config-rules --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Perform Infrastructure as Code and configuration evaluation and testing.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Perform Infra...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_MLA_07": {
    "title": "Maintain a list of information resources and event types that will be monitored, logged, and audited, then do so.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Maintain a list of information resources and event types that will be monitored, logged, and audited, then do so.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 8/8 (100%): \u2705 Comprehensive log infrastructure: 33 CloudWatch log groups found.; \u2705 Comprehensive audit coverage: 1 trail(s) found, including multi-region and organization trail.; \u2705 Comprehensive monitoring configuration: 13 CloudWatch alarms found.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "3 commands (3 successful): aws logs describe-log-groups --output json",
      "aws cloudtrail describe-trails --output json",
      "aws cloudwatch describe-alarms --output json"
    ],
    "evidence_files": [
      "evidence_v2/KSI-MLA-07/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_MLA_07(evidence_bundle):\n    \"\"\"\n    Maintain a list of information resources and event types that will be monitored, logged, and audited, then do so.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws logs describe-log-groups --output json\n    evidence = run_cli('aws', args='logs describe-log-groups --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Maintain a list of information resources and event types that will be monitored, logged, and audited, then do so.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Maintain a li...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_MLA_08": {
    "title": "Use a least-privileged, role and attribute-based, and just-in-time access authorization model for access to log data based on organizationally defined data sensitivity.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Use a least-privileged, role and attribute-based, and just-in-time access authorization model for access to log data based on organizationally defined data sensitivity.\n\nEvidence analyzed:\n\u2022 Integrity\n\u2022 Encryption\n\u2022 Retention\n\u2022 Access Control\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "4 commands (3 successful): aws cloudtrail describe-trails --output json",
      "aws logs describe-log-groups --output json (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-MLA-08/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_MLA_08(evidence_bundle):\n    \"\"\"\n    Use a least-privileged, role and attribute-based, and just-in-time access authorization model for access to log data based on organizationally defined data sensitivity.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws cloudtrail describe-trails --output json\n    evidence = run_cli('aws', args='cloudtrail describe-trails --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Use a least-privileged, role and attribute-based, and just-in-time access authorization model for access to log data based on organizationally defined data sensitivity.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Use a least-p...\")\n    \n    # Check: Integrity\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Integrity...\")\n    \n    # Check: Encryption\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Encryption...\")\n    \n    # Check: Retention\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Retention...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_PIY_01": {
    "title": "Use authoritative sources to automatically maintain real-time inventories of all information resources.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Use authoritative sources to automatically maintain real-time inventories of all information resources.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Strong 18/23 (78%): \u2705 Compute inventory: 9 EC2 instances discovered.; \u2705 Database inventory: 1 RDS instances discovered.; \u2705 Serverless inventory: 20 Lambda functions discovered.; \u2705 Storage inventory: 10 S3 buckets discovered.; \u2705 Network inventory: 1 Load Balancers (v1/v2) discovered.; \u2705 DNS inventory: 1 Route53 hosted zones discovered.; \u2705 Infrastructure as Code inventory: 14 CloudFormation stacks discovered (14 active).; \u2705 Regular maintenance evidence: 3 inventory file artifact(s) found.; \u2705 Automated maintenance mechanism: Lambda function 'aws_inventory' (python3.9) for inventory automation found.; \ud83d\udcca Inventory Maturity: 9/9 components discovered (100% coverage).\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "9 commands (9 successful): aws ec2 describe-instances --output json",
      "aws rds describe-db-instances --output json (+7 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-PIY-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_PIY_01(evidence_bundle):\n    \"\"\"\n    Use authoritative sources to automatically maintain real-time inventories of all information resources.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws ec2 describe-instances --output json\n    evidence = run_cli('aws', args='ec2 describe-instances --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Use authoritative sources to automatically maintain real-time inventories of all information resources.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Use authorita...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_PIY_02": {
    "title": "Document the security objectives and requirements for each information resource or set of information resources.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Document the security objectives and requirements for each information resource or set of information resources.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Strong 13/16 (81%): \u2705 Security governance repository configured.; \u2705 System-level security overview documented.; \u2705 Component security documentation: 4 components documented (Api Gateway, Application Load Balancer, Ec2 Instances...).; \u2705 PR approval workflow capability detected.; \u2705 Active documentation management indicated by recent repository activity.; \u2705 Main/Master branch configured.\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "5 commands (5 successful): aws codecommit get-repository --repository-name security-governance --output json",
      "aws codecommit get-folder --repository-name security-governance --folder-path policies/security-objectives/ --output json (+3 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-PIY-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_PIY_02(evidence_bundle):\n    \"\"\"\n    Document the security objectives and requirements for each information resource or set of information resources.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-repository --repository-name security-governance --output json\n    evidence = run_cli('aws', args='codecommit get-repository --repository-name security-governance --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Document the security objectives and requirements for each information resource or set of information resources.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Document the ...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_PIY_03": {
    "title": "Maintain a vulnerability disclosure program.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Maintain a vulnerability disclosure program.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 14/14 (100%): \u2705 Vulnerability disclosure policy document found and appears valid.; \u2705 Submission process appears documented within the policy.; \u2705 Response procedures/timelines appear defined within the policy.; \u2705 Public security contact information appears provided within the policy.; \u2705 VDP maintenance activity: 1 recent update(s) to policy detected.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "4 commands (3 successful): aws codecommit list-repositories --output json",
      "aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-disclosure-policy.md --output json (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-PIY-03/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_PIY_03(evidence_bundle):\n    \"\"\"\n    Maintain a vulnerability disclosure program.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit list-repositories --output json\n    evidence = run_cli('aws', args='codecommit list-repositories --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Maintain a vulnerability disclosure program.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Maintain a vu...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_PIY_04": {
    "title": "Monitor the effectiveness of building security and privacy considerations into the Software Development Lifecycle and aligning with CISA Secure By Design principles.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Monitor the effectiveness of building security and privacy considerations into the Software Development Lifecycle and aligning with CISA Secure By Design principles.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 7/8 (88%): \u2705 Build Security Integration: Found 3 security-focused CodeBuild projects.; \u2705 Pipeline Security Gates: Found 1 CodePipeline workflows (assumes security stages).; \u2705 Security Automation Functions: Found 1 Lambda function for SDLC security.; \u2705 Development Governance: AWS Organizations detected (enables central policies/SCPs).; \ud83d\udcca SDLC Security Maturity: 4/4 capabilities detected (100% coverage).\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "4 commands (4 successful): aws codebuild list-projects --output json",
      "aws codepipeline list-pipelines --output json (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-PIY-04/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_PIY_04(evidence_bundle):\n    \"\"\"\n    Monitor the effectiveness of building security and privacy considerations into the Software Development Lifecycle and aligning with CISA Secure By Design principles.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codebuild list-projects --output json\n    evidence = run_cli('aws', args='codebuild list-projects --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Monitor the effectiveness of building security and privacy considerations into the Software Development Lifecycle and aligning with CISA Secure By Design principles.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Monitor the e...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_PIY_05": {
    "title": "Document methods used to evaluate information resource implementations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Document methods used to evaluate information resource implementations.\n\nEvidence analyzed:\n\u2022 Documentation\n\u2022 Content\n\u2022 Content\n\u2022 Maintenance\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "3 commands (3 successful): aws codecommit get-file --repository-name security-governance --file-path policies/evaluation-methodology.md --output json",
      "aws codecommit get-folder --repository-name security-governance --folder-path procedures/ --output json",
      "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json"
    ],
    "evidence_files": [
      "evidence_v2/KSI-PIY-05/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_PIY_05(evidence_bundle):\n    \"\"\"\n    Document methods used to evaluate information resource implementations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path policies/evaluation-methodology.md --output json\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path policies/evaluation-methodology.md --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Document methods used to evaluate information resource implementations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Document meth...\")\n    \n    # Check: Documentation\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Documentation...\")\n    \n    # Check: Content\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Content...\")\n    \n    # Check: Content\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Content...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_PIY_06": {
    "title": "Monitor the effectiveness of the organization's investments in achieving security objectives.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Monitor the effectiveness of the organization's investments in achieving security objectives.\n\nEvidence analyzed:\n\u2022 Engagement\n\u2022 Engineering\n\u2022 Engineering\n\u2022 Capabilities\n\u2022 Capabilities\n\u2022 Capabilities\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "6 commands (6 successful): aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=ConsoleLogin --start-time $(date -u -d '30 days ago' '+%Y-%m-%dT%H:%M:%S') --max-items 50 --output json",
      "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=PutConfigRule --start-time $(date -u -d '90 days ago' '+%Y-%m-%dT%H:%M:%S') --max-items 50 --output json (+4 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-PIY-06/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_PIY_06(evidence_bundle):\n    \"\"\"\n    Monitor the effectiveness of the organization's investments in achieving security objectives.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=ConsoleLogin --start-time $(date -u -d '30 days ago' '+%Y-%m-%dT%H:%M:%S') --max-items 50 --output json\n    evidence = run_cli('aws', args='cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=ConsoleLogin --start-time $(date -u -d '30 days ago' '+%Y-%m-%dT%H:%M:%S') --max-items 50 --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Monitor the effectiveness of the organization's investments in achieving security objectives.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Monitor the e...\")\n    \n    # Check: Engagement\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Engagement...\")\n    \n    # Check: Engineering\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Engineering...\")\n    \n    # Check: Engineering\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Engineering...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_PIY_07": {
    "title": "Document risk management decisions for software supply chain security.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Document risk management decisions for software supply chain security.\n\nEvidence analyzed:\n\u2022 Policy\n\u2022 Approval\n\u2022 Audit Trail\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "3 commands (3 successful): aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md --output json",
      "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
      "aws codecommit list-approval-rule-templates --output json"
    ],
    "evidence_files": [
      "evidence_v2/KSI-PIY-07/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_PIY_07(evidence_bundle):\n    \"\"\"\n    Document risk management decisions for software supply chain security.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md --output json\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Document risk management decisions for software supply chain security.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Document risk...\")\n    \n    # Check: Policy\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Policy...\")\n    \n    # Check: Approval\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Approval...\")\n    \n    # Check: Audit Trail\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Audit Trail...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_PIY_08": {
    "title": "Regularly measure executive support for achieving the organization\u2019s security objectives.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Regularly measure executive support for achieving the organization\u2019s security objectives.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u274c Insufficient 0/10 (0%): \u274c [Executive Support] Failed to retrieve financial data (Cost Explorer CLI command failed).\n",
    "passing_criteria": "Failure: Did not meet minimum evidence requirements.",
    "cli_commands": [
      "1 commands (0 successful): aws ce get-cost-and-usage --time-period Start=$(date -u -d \"$(date -u +%Y)-01-01\" +%Y-%m-%d),End=$(date -u -d \"1 day\" +%Y-%m-%d) --granularity MONTHLY --metrics UnblendedCost --output json"
    ],
    "evidence_files": [
      "evidence_v2/KSI-PIY-08/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_PIY_08(evidence_bundle):\n    \"\"\"\n    Regularly measure executive support for achieving the organization\u2019s security objectives.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws ce get-cost-and-usage --time-period Start=$(date -u -d \"$(date -u +%Y)-01-01\" +%Y-%m-%d),End=$(date -u -d \"1 day\" +%Y-%m-%d) --granularity MONTHLY --metrics UnblendedCost --output json\n    evidence = run_cli('aws', args='ce get-cost-and-usage --time-period Start=$(date -u -d \"$(date -u +%Y)-01-01\" +%Y-%m-%d),End=$(date -u -d \"1 day\" +%Y-%m-%d) --granularity MONTHLY --metrics UnblendedCost --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Regularly measure executive support for achieving the organization\u2019s security objectives.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Regularly mea...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_RPL_01": {
    "title": "Define Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Define Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 16/17 (94%): \u2705 Database backup capability: Max retention meets/exceeds 7 days (7 days).; \u2705 Point-in-time recovery: Enabled for 1/1 databases.; \u2705 Backup infrastructure: 2 AWS Backup plan(s) configured.; \u2705 Backup plan execution confirmed (at least one plan has run).; \u2705 Defined RTO objectives found: '4 hours'.; \u2705 Defined RPO objectives found: 'Not configured'.; \u2705 Backup vault configured (1 vault(s) found).; \u2705 Backup selection coverage: 1 backup selection(s) defined.\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "6 commands (6 successful): aws rds describe-db-instances --output json",
      "aws backup list-backup-plans --output json (+4 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-RPL-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_RPL_01(evidence_bundle):\n    \"\"\"\n    Define Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws rds describe-db-instances --output json\n    evidence = run_cli('aws', args='rds describe-db-instances --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Define Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Define Recove...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_RPL_02": {
    "title": "Develop and maintain a recovery plan that aligns with the defined recovery objectives.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Develop and maintain a recovery plan that aligns with the defined recovery objectives.\n\nEvidence analyzed:\n\u2022 Plan\n\u2022 Storage\n\u2022 Maintenance\n\u2022 Evidence\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "3 commands (3 successful): aws backup list-backup-plans --output json",
      "aws backup list-backup-vaults --output json",
      "aws ec2 describe-snapshots --owner-ids self --max-results 100 --output json"
    ],
    "evidence_files": [
      "evidence_v2/KSI-RPL-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_RPL_02(evidence_bundle):\n    \"\"\"\n    Develop and maintain a recovery plan that aligns with the defined recovery objectives.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws backup list-backup-plans --output json\n    evidence = run_cli('aws', args='backup list-backup-plans --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Develop and maintain a recovery plan that aligns with the defined recovery objectives.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Develop and m...\")\n    \n    # Check: Plan\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Plan...\")\n    \n    # Check: Storage\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Storage...\")\n    \n    # Check: Maintenance\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Maintenance...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_RPL_03": {
    "title": "Perform system backups aligned with recovery objectives.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Perform system backups aligned with recovery objectives.\n\nEvidence analyzed:\n\u2022 Retention\n\u2022 Execution\n\u2022 Coverage\n\u2022 Coverage\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "6 commands (6 successful): aws backup list-backup-plans --output json",
      "aws backup list-backup-plans --output json | jq -r '.BackupPlansList[].BackupPlanId' | xargs -I {} aws backup get-backup-plan --backup-plan-id {} --output json | jq -s '.' || echo '[]' (+4 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-RPL-03/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_RPL_03(evidence_bundle):\n    \"\"\"\n    Perform system backups aligned with recovery objectives.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws backup list-backup-plans --output json\n    evidence = run_cli('aws', args='backup list-backup-plans --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Perform system backups aligned with recovery objectives.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Perform syste...\")\n    \n    # Check: Retention\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Retention...\")\n    \n    # Check: Execution\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Execution...\")\n    \n    # Check: Coverage\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Coverage...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_RPL_04": {
    "title": "Regularly test the capability to recover from incidents and contingencies.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Regularly test the capability to recover from incidents and contingencies.\n\nEvidence analyzed:\n\u2022 Backup Success\n\u2022 Backup Encryption\n\u2022 Backup Retention\n\u2022 PITR\n\u2022 Automation\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "4 commands (4 successful): aws backup list-backup-jobs --by-state COMPLETED --by-created-after $(date -u -d '30 days ago' +%Y-%m-%dT%H:%M:%SZ 2>/dev/null || date -u -v-30d +%Y-%m-%dT%H:%M:%SZ) --max-results 50 --output json",
      "aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier,LatestRestorableTime]' --output json (+2 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-RPL-04/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_RPL_04(evidence_bundle):\n    \"\"\"\n    Regularly test the capability to recover from incidents and contingencies.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws backup list-backup-jobs --by-state COMPLETED --by-created-after $(date -u -d '30 days ago' +%Y-%m-%dT%H:%M:%SZ 2>/dev/null || date -u -v-30d +%Y-%m-%dT%H:%M:%SZ) --max-results 50 --output json\n    evidence = run_cli('aws', args='backup list-backup-jobs --by-state COMPLETED --by-created-after $(date -u -d '30 days ago' +%Y-%m-%dT%H:%M:%SZ 2>/dev/null || date -u -v-30d +%Y-%m-%dT%H:%M:%SZ) --max-results 50 --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Regularly test the capability to recover from incidents and contingencies.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Regularly tes...\")\n    \n    # Check: Backup Success\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Backup Success...\")\n    \n    # Check: Backup Encryption\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Backup Encryption...\")\n    \n    # Check: Backup Retention\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Backup Retention...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_SVC_01": {
    "title": "Implement improvements based on persistent evaluation of information resources for opportunities to improve security.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Implement improvements based on persistent evaluation of information resources for opportunities to improve security.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 20/20 (100%): \u2705 Network hardening foundation: 15 security groups (15 hardened, 0 require review); \u2705 System configuration management: 6 running instances configured (out of 9 total).; \u2705 Comprehensive system management: 6/6 running instances under SSM and online (100% coverage); \u2705 Automated patch management: 17 patch baselines configured; \u2705 Configuration compliance: 333/333 active Config rules (333 security-focused); \u2705 Threat detection enabled: 1 GuardDuty detectors monitoring for threats; \u2705 Application layer protection: 1 Web ACLs configured; \u2705 Automated security assessments: Inspector enabled for ECR; \u2705 Secure service access: 7 VPC endpoints (4 interface, 3 gateway); \u2705 Enterprise-wide security governance: AWS Organizations enables centralized hardening policies; \u2705 Advanced organization features: SCPs and advanced governance capabilities enabled\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "11 commands (11 successful): aws ec2 describe-security-groups --output json",
      "aws ec2 describe-instances --output json (+9 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-SVC-01/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_SVC_01(evidence_bundle):\n    \"\"\"\n    Implement improvements based on persistent evaluation of information resources for opportunities to improve security.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws ec2 describe-security-groups --output json\n    evidence = run_cli('aws', args='ec2 describe-security-groups --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Implement improvements based on persistent evaluation of information resources for opportunities to improve security.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Implement imp...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_SVC_02": {
    "title": "Encrypt or otherwise secure network traffic.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Encrypt or otherwise secure network traffic.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Sufficient 12/18 (67%): \u2705 Private service communication: 7 VPC endpoints configured.; \u2705 API encryption capability: 3 API Gateway endpoints (HTTPS by default).; \u2705 Database encryption capability: 1 RDS instances (1 encrypted at rest).; \u2705 Certificate management: 2/2 ACM certificates are in ISSUED status (100%).; \u2705 Enterprise-wide encryption governance: AWS Organizations enables centralized policies.; \u2705 Advanced organization features: SCPs for encryption policy enforcement enabled.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "9 commands (9 successful): aws elbv2 describe-load-balancers --output json",
      "for arn in $(aws elbv2 describe-load-balancers --query 'LoadBalancers[].LoadBalancerArn' --output text 2>/dev/null || echo '')",
      "do aws elbv2 describe-listeners --load-balancer-arn $arn --output json",
      "done (+7 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-SVC-02/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_SVC_02(evidence_bundle):\n    \"\"\"\n    Encrypt or otherwise secure network traffic.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws elbv2 describe-load-balancers --output json\n    evidence = run_cli('aws', args='elbv2 describe-load-balancers --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Encrypt or otherwise secure network traffic.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Encrypt or ot...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_SVC_04": {
    "title": "Manage configuration of machine-based information resources using automation.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Manage configuration of machine-based information resources using automation.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 20/20 (100%): \u2705 Parameter management: 7 SSM parameters for centralized configuration.; \u2705 Configuration recording: 1 Config recorders configured.; \u2705 Configuration automation: 482 SSM documents (9 custom).; \u2705 Infrastructure as Code: 14/14 successful CloudFormation stacks (100%).; \u2705 Secure configuration management: 2 centrally managed secrets.; \u2705 System configuration standards: 17 patch baselines for standardized management.; \u2705 Configuration compliance automation: 333/333 active Config rules.; \u2705 Centralized instance management: 6/6 instances under SSM management (100% online).; \u2705 Enterprise-wide configuration governance: AWS Organizations enables centralized policies.; \u2705 Advanced organization features: SCPs for configuration policy enforcement enabled.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "10 commands (10 successful): aws ssm describe-parameters --output json",
      "aws configservice describe-configuration-recorders --output json (+8 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-SVC-04/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_SVC_04(evidence_bundle):\n    \"\"\"\n    Manage configuration of machine-based information resources using automation.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws ssm describe-parameters --output json\n    evidence = run_cli('aws', args='ssm describe-parameters --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Manage configuration of machine-based information resources using automation.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Manage config...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_SVC_05": {
    "title": "Use cryptographic methods to validate the integrity of machine-based information resources.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Use cryptographic methods to validate the integrity of machine-based information resources.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 20/20 (100%): \u2705 Audit integrity foundation: 1/1 CloudTrail trails with log file validation.; \u2705 Cryptographic infrastructure: 17 KMS keys available.; \u2705 Key management governance: 6 customer-managed KMS aliases.; \u2705 Object integrity capability: 10 S3 buckets available for versioning and integrity protection.; \u2705 Database integrity: 1/1 RDS instances with encrypted storage (protects data at rest).; \u2705 Configuration integrity: 1 active Config recorders covering global & all supported types.; \u2705 Backup integrity: 3/3 encrypted backup vaults.; \u2705 Integrity monitoring: 13 CloudWatch alarms potentially related to integrity violations detected.; \u2705 Integrity notification infrastructure: 10 SNS topics available for event communication.; \u2705 Enterprise-wide integrity governance: AWS Organizations enables centralized policies.; \u2705 Advanced organization features: SCPs for integrity policy enforcement enabled.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "10 commands (10 successful): aws cloudtrail describe-trails --output json",
      "aws kms list-keys --output json (+8 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-SVC-05/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_SVC_05(evidence_bundle):\n    \"\"\"\n    Use cryptographic methods to validate the integrity of machine-based information resources.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws cloudtrail describe-trails --output json\n    evidence = run_cli('aws', args='cloudtrail describe-trails --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Use cryptographic methods to validate the integrity of machine-based information resources.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Use cryptogra...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_SVC_06": {
    "title": "Automate management, protection, and regular rotation of digital keys, certificates, and other secrets.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Automate management, protection, and regular rotation of digital keys, certificates, and other secrets.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 18/20 (90%): \u2705 Automated key management infrastructure: 17 KMS keys detected.; \u2705 Automated certificate management: 2/2 ACM certificates are ISSUED.; \u2705 Key governance structure: 6 customer-managed KMS aliases found.; \u2705 Automated encryption integration: 4 SecureString parameters found (implies KMS usage).; \u2705 Secrets management in use: 2 secrets found in Secrets Manager.; \u2705 Modern certificate management: No legacy IAM server certificates found.; \u2705 Infrastructure as Code key management: 14/14 successful CloudFormation stacks (implies IaC practices).; \u2705 Key management audit trail: 20 recent key management events tracked via CloudTrail lookup.; \u2705 Enterprise-wide key management governance: AWS Organizations enables centralized key policies.; \u2705 Advanced organization features: SCPs for key management policy enforcement enabled.\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "9 commands (9 successful): aws kms list-keys --output json",
      "aws acm list-certificates --output json (+7 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-SVC-06/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_SVC_06(evidence_bundle):\n    \"\"\"\n    Automate management, protection, and regular rotation of digital keys, certificates, and other secrets.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws kms list-keys --output json\n    evidence = run_cli('aws', args='kms list-keys --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Automate management, protection, and regular rotation of digital keys, certificates, and other secrets.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Automate mana...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_SVC_07": {
    "title": "Use a consistent, risk-informed approach for applying security patches.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Use a consistent, risk-informed approach for applying security patches.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Sufficient 13/20 (65%): \u2705 Consistent patch management: 17 patch baselines configured.; \u2705 Automated patch deployment capability: 6/6 instances with SSM agent online (100%).; \u2705 Patch automation framework: 32 relevant SSM documents found.; \u2705 Serverless patch management: 1 Lambda layers for runtime dependency management.; \u2705 Patch compliance monitoring: 12 Config rules related to patch/SSM governance found.; \u2705 Enterprise-wide patch governance: AWS Organizations enables centralized policies.; \u2705 Advanced organization features: SCPs for patch management policy enforcement enabled.\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "10 commands (10 successful): aws ssm describe-patch-baselines --output json",
      "aws ssm describe-instance-information --output json (+8 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-SVC-07/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_SVC_07(evidence_bundle):\n    \"\"\"\n    Use a consistent, risk-informed approach for applying security patches.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws ssm describe-patch-baselines --output json\n    evidence = run_cli('aws', args='ssm describe-patch-baselines --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Use a consistent, risk-informed approach for applying security patches.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Use a consist...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_SVC_08": {
    "title": "Do not introduce or leave behind residual elements that could negatively affect confidentiality, integrity, or availability of federal customer data during operations.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Do not introduce or leave behind residual elements that could negatively affect confidentiality, integrity, or availability of federal customer data during operations.\n\nEvidence analyzed:\n\u2022 IaC Usage\n\u2022 IaC Management\n\u2022 IaC Controls\n\u2022 IaC Controls\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "1 commands (1 successful): aws s3 ls s3://mks-states/ --recursive"
    ],
    "evidence_files": [
      "evidence_v2/KSI-SVC-08/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_SVC_08(evidence_bundle):\n    \"\"\"\n    Do not introduce or leave behind residual elements that could negatively affect confidentiality, integrity, or availability of federal customer data during operations.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws s3 ls s3://mks-states/ --recursive\n    evidence = run_cli('aws', args='s3 ls s3://mks-states/ --recursive')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Do not introduce or leave behind residual elements that could negatively affect confidentiality, integrity, or availability of federal customer data during operations.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Do not introd...\")\n    \n    # Check: IaC Usage\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: IaC Usage...\")\n    \n    # Check: IaC Management\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: IaC Management...\")\n    \n    # Check: IaC Controls\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: IaC Controls...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_SVC_09": {
    "title": "Persistently validate the authenticity and integrity of communications between machine-based information resources using automation.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Persistently validate the authenticity and integrity of communications between machine-based information resources using automation.\n\nEvidence analyzed:\n\u2022 Certificate Health\n\u2022 TLS Enforcement\n\u2022 Internal Security\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "6 commands (6 successful): aws acm list-certificates --output json",
      "aws elbv2 describe-ssl-policies --output json (+4 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-SVC-09/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_SVC_09(evidence_bundle):\n    \"\"\"\n    Persistently validate the authenticity and integrity of communications between machine-based information resources using automation.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws acm list-certificates --output json\n    evidence = run_cli('aws', args='acm list-certificates --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Persistently validate the authenticity and integrity of communications between machine-based information resources using automation.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Persistently ...\")\n    \n    # Check: Certificate Health\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Certificate Health...\")\n    \n    # Check: TLS Enforcement\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: TLS Enforcement...\")\n    \n    # Check: Internal Security\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Internal Security...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_SVC_10": {
    "title": "Remove unwanted federal customer data promptly when requested by an agency in alignment with customer agreements, including from backups if appropriate.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Remove unwanted federal customer data promptly when requested by an agency in alignment with customer agreements, including from backups if appropriate.\n\nEvidence analyzed:\n\u2022 Backup Retention\n\u2022 Log Retention\n",
    "passing_criteria": "Requires successful execution of all verification commands and positive assertion of evidence.",
    "cli_commands": [
      "5 commands (5 successful): aws backup list-backup-plans --output json",
      "aws backup list-backup-plans --output json | jq -r '.BackupPlansList[].BackupPlanId' | xargs -I {} aws backup get-backup-plan --backup-plan-id {} --output json | jq -s '.' || echo '[]' (+3 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-SVC-10/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_SVC_10(evidence_bundle):\n    \"\"\"\n    Remove unwanted federal customer data promptly when requested by an agency in alignment with customer agreements, including from backups if appropriate.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws backup list-backup-plans --output json\n    evidence = run_cli('aws', args='backup list-backup-plans --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Remove unwanted federal customer data promptly when requested by an agency in alignment with customer agreements, including from backups if appropriate.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Remove unwant...\")\n    \n    # Check: Backup Retention\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Backup Retention...\")\n    \n    # Check: Log Retention\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Log Retention...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_TPR_03": {
    "title": "Identify and prioritize mitigation of potential supply chain risks.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Identify and prioritize mitigation of potential supply chain risks.\n\nEvidence analyzed:\n\u2022 Policy\n\u2022 Approval\n\u2022 Audit Trail\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "3 commands (3 successful): aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md",
      "aws codecommit list-approval-rule-templates --output json",
      "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json"
    ],
    "evidence_files": [
      "evidence_v2/KSI-TPR-03/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_TPR_03(evidence_bundle):\n    \"\"\"\n    Identify and prioritize mitigation of potential supply chain risks.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md\n    evidence = run_cli('aws', args='codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Identify and prioritize mitigation of potential supply chain risks.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Identify and ...\")\n    \n    # Check: Policy\n    if validate_condition(evidence, rule_id=\"2\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Policy...\")\n    \n    # Check: Approval\n    if validate_condition(evidence, rule_id=\"3\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Approval...\")\n    \n    # Check: Audit Trail\n    if validate_condition(evidence, rule_id=\"4\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Audit Trail...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  },
  "KSI_TPR_04": {
    "title": "Automatically monitor third party software information resources for upstream vulnerabilities using mechanisms that may include contractual notification requirements or active monitoring services.",
    "evidence_type": "Automated validation-engine-sync Validation",
    "logic": "Validates compliance with: Automatically monitor third party software information resources for upstream vulnerabilities using mechanisms that may include contractual notification requirements or active monitoring services.\n\nEvidence analyzed:\n\u2022 Verified via automated assertion: \u2705 Excellent 11/11 (100%): \u2705 Inspector EC2 vulnerability scanning successfully enabled.; \u2705 Inspector OS vulnerability scanning is active (0 findings found).; \u2705 Inspector Application vulnerability scanning is active (0 findings found).; \u2705 EC2 Inspector coverage verified: 9 instances covered (6 actively scanning).; \u2705 Package inventory capability: 6/6 instances online via SSM for dependency tracking.; \u2705 Active vulnerability monitoring: Inspector is tracking 100 ACTIVE findings.; \ud83d\udcca Monitoring Maturity: 5/5 capabilities detected (100% coverage).\n",
    "passing_criteria": "Excellent Pass (100%): All automated checks passed.",
    "cli_commands": [
      "6 commands (6 successful): aws inspector2 get-configuration --output json",
      "aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"OPERATING_SYSTEM\"}]}' --max-results 50 --output json (+4 more)"
    ],
    "evidence_files": [
      "evidence_v2/KSI-TPR-04/cli_output.json"
    ],
    "source_code": "def evaluate_KSI_TPR_04(evidence_bundle):\n    \"\"\"\n    Automatically monitor third party software information resources for upstream vulnerabilities using mechanisms that may include contractual notification requirements or active monitoring services.\n    \"\"\"\n    # 1. Initialize Context\n    score = 0\n    max_score = 10\n    findings = []\n\n    # 2. Execute Evidence Collection\n    # Command: aws inspector2 get-configuration --output json\n    evidence = run_cli('aws', args='inspector2 get-configuration --output json')\n\n    # 3. Evaluate Logic\n    \n    # Check: Validates compliance with: Automatically monitor third party software information resources for upstream vulnerabilities using mechanisms that may include contractual notification requirements or active monitoring services.\n    if validate_condition(evidence, rule_id=\"1\"):\n        score += 2\n    else:\n        findings.append(\"Criteria failed: Validates compliance with: Automatically...\")\n\n    # 4. Determine Status\n    rate = (score / max_score) * 100\n    return {\n        \"score\": score,\n        \"max_score\": max_score,\n        \"rate\": rate,\n        \"status\": \"PASS\" if rate >= 80 else \"FAIL\",\n        \"findings\": findings\n    }"
  }
}
