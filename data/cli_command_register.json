{
  "KSI-AFR-01": {
    "description": "Apply the FedRAMP Minimum Assessment Standard (MAS) to identify and document the scope of the cloud service offering to be assessed for FedRAMP authorization and persistently address all related requirements and recommendations.",
    "justification": "Validates scope via existence of the scoped assessment declaration document.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/minimum_assessment_scope.html",
        "note": "Check for Minimum Assessment Scope document."
      }
    ]
  },
  "KSI-AFR-02": {
    "description": "Set security goals for the cloud service offering based on FedRAMP 20x Phase Two Key Security Indicators (KSIs - you are here), develop automated validation of status and progress to the greatest extent possible, and persistently address all related requirements and recommendations.",
    "justification": "Validates the existence of the Phase 2 KSI Compliance Tracker.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html",
        "note": "Check for KSI Compliance Tracker."
      }
    ]
  },
  "KSI-AFR-03": {
    "description": "Determine how authorization data will be shared with all necessary parties in alignment with the FedRAMP Authorization Data Sharing (ADS) standard and persistently address all related requirements and recommendations.",
    "justification": "Uses the KSI Compliance Tracker as the reference for data sharing procedures.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html",
        "note": "Check for KSI Compliance Tracker (Reference for ADS)."
      }
    ]
  },
  "KSI-AFR-04": {
    "description": "Document the vulnerability detection and vulnerability response methodology used within the cloud service offering in alignment with the FedRAMP Vulnerability Detection and Response (VDR) standard and persistently address all related requirements and recommendations.",
    "justification": "Hybrid check: Validates active Inspector scanning (Technical) AND the existence of the compliance tracker (Governance).",
    "cli_commands": [
      {
        "command": "aws inspector2 get-configuration --output json",
        "note": "Check Inspector configuration."
      },
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html",
        "note": "Check for Compliance Tracker."
      }
    ]
  },
  "KSI-AFR-05": {
  "description": "Verify SCN procedures are documented and active change tracking is visible via GitHub Issues.",
  "justification": "Hybrid check: Validates SCN procedures documentation AND the existence of SCN tracking issues in GitHub.",
  "cli_commands": [
    {
      "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/scn_procedures.md --output json",
      "note": "Governance: Validates SCN procedures documentation exists."
    },
    {
      "command": "gh issue list --repo Meridian-Knowledge-Solutions/fedramp-20x-submission-final --state all --limit 30 --json number,title,state,labels,createdAt --jq '.' 2>/dev/null || echo '[]'",
      "note": "Observability: Fetches recent open/closed issues to check for SCN tracking activity (Adaptive/Transformative)."
    }
    ]
  },
  "KSI-AFR-06": {
    "description": "Maintain a plan and process for providing Ongoing Authorization Reports and Quarterly Reviews for all necessary parties in alignment with the FedRAMP Collaborative Continuous Monitoring (CCM) standard and persistently address all related requirements and recommendations.",
    "justification": "Validates the existence of the compliance tracker as evidence of the monitoring process.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/phase_2_ksi_compliance_tracker.html",
        "note": "Check for Compliance Tracker."
      }
    ]
  },
  "KSI-AFR-07": {
    "description": "Document the secure configuration baseline for the cloud service offering.",
    "justification": "Validates the existence of the FedRAMP-specific Secure Configuration Guide in CodeCommit.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path fedramp-20x-secure-configuration.md --output json",
        "note": "Governance: Retrieve the Secure Configuration Guide."
      }
    ]
  },
  "KSI-AFR-08": {
  "description": "Operate a secure inbox to receive critical communication from FedRAMP and other government entities in alignment with FedRAMP Security Inbox (FSI) requirements and persistently address all related requirements and recommendations.",
  "justification": "Technical validation: Verifies DNS MX records exist, email domain has proper authentication (SPF/DMARC), and procedures are documented.",
  "cli_commands": [
    {
      "command": "nslookup -type=MX meridianks.com | grep 'mail exchanger' || echo 'No MX records found'",
      "note": "DNS Check: Validates MX records exist for the domain to receive email."
    },
    {
      "command": "nslookup -type=TXT meridianks.com | grep -i 'v=spf1' || echo 'No SPF record found'",
      "note": "SPF Record: Validates Sender Policy Framework is configured for email authentication."
    },
    {
      "command": "nslookup -type=TXT _dmarc.meridianks.com | grep -i 'v=dmarc1' || echo 'No DMARC record found'",
      "note": "DMARC Record: Validates Domain-based Message Authentication policy exists."
    },
    {
      "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/security-inbox-procedures.md --output json",
      "note": "Governance: Validates documented procedures exist for security inbox operations."
    }
  ]
  },
  "KSI-AFR-09": {
  "description": "Persistently validate security posture using automated pipelines.",
  "justification": "Hybrid check: Validates the architecture diagram AND the execution status of the Master Validator pipeline.",
  "cli_commands": [
    {
      "command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/fedramp-phase2-validation-architecture.mmd --output json",
      "note": "Check for Validation Architecture Diagram in the correct folder."
    },
    {
      "command": "gh run list --workflow \"FedRAMP 20x CLI Validation Pipeline + Phase 2 Master Validator\" --limit 1 --json name,status,conclusion,databaseId,updatedAt",
      "note": "Check for the latest successful run of the Master Validator pipeline."
    }
    ]
  },
  "KSI-AFR-10": {
    "description": "Integrate FedRAMP's Incident Communications Procedures (ICP) into incident response procedures and infrastructure.",
    "justification": "Validates ICP Playbook AND Incident Response Plan documents exist (Governance), PLUS validates supporting notification infrastructure (SNS topics and subscriptions) is active (Technical).",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/icp_playbook.md --output json",
        "note": "Governance: Validates ICP Playbook documentation exists."
      },
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json",
        "note": "Governance: Validates Incident Response Plan documentation exists."
      },
      {
        "command": "aws sns list-topics --output json",
        "note": "Infrastructure: Validates SNS topics exist for incident notifications."
      },
      {
        "command": "aws sns list-subscriptions --output json",
        "note": "Infrastructure: Validates SNS subscriptions are active/confirmed."
      }
    ]
  },
  "KSI-AFR-11": {
  "description": "Ensure that cryptographic modules used to protect potentially sensitive federal customer data are selected and used in alignment with the FedRAMP 20x Using Cryptographic Modules (UCM) policy and persistently address all related requirements and recommendations.",
  "justification": "Validates cryptographic module usage through aggregate KMS configuration, encryption-at-rest status, TLS policies, and UCM governance documentation.",
  "cli_commands": [
    {
      "command": "aws kms list-aliases --output json",
      "note": "Inventory: Lists all KMS key aliases. Validates cryptographic key management is active."
    },
    {
      "command": "aws kms list-keys --output json",
      "note": "Configuration: Counts total KMS keys. Validates key management infrastructure exists."
    },
    {
      "command": "aws s3api list-buckets --output json",
      "note": "S3 Inventory: Lists all S3 buckets for encryption validation."
    },
    {
      "command": "aws s3api get-bucket-encryption --bucket meridian-fedramp-evidence --output json",
      "note": "At-Rest Encryption: Validates primary evidence bucket uses AES256 or aws:kms encryption."
    },
    {
      "command": "aws rds describe-db-instances --output json --query 'DBInstances[*].[DBInstanceIdentifier,StorageEncrypted,KmsKeyId]'",
      "note": "Database Encryption: Validates all RDS instances have StorageEncrypted=true with KMS keys."
    },
    {
      "command": "aws elbv2 describe-ssl-policies --output json",
      "note": "Transit Encryption: Validates FIPS-compliant TLS policies are configured (TLS 1.2+)."
    },
    {
      "command": "aws elbv2 describe-load-balancers --output json --query 'LoadBalancers[*].[LoadBalancerName,Type]'",
      "note": "Load Balancer Inventory: Lists ALB/NLB for SSL policy validation."
    },
    {
      "command": "aws codecommit get-file --repository-name security-governance --file-path cryptography/UCM.md --output json",
      "note": "Governance: Validates UCM policy document exists and is maintained."
    }
  ]
  },
  "KSI-CED-01": {
    "description": "Require and monitor the effectiveness of training given to all employees on policies, procedures, and security-related topics.",
    "justification": "Validates role-based security training from basic awareness to enterprise-grade continuous education and compliance tracking",
    "cli_commands": [
      {
        "command": "evidence_check",
        "note": "Manual review of training records, completion certificates, and role-based security education documentation"
      }
    ]
  },
  "KSI-CED-02": {
    "description": "Require and monitor the effectiveness of role-specific training for high risk roles, including at least roles with privileged access.",
    "justification": "Validates specialized security training from basic privileged user awareness to enterprise-grade advanced threat training and certification tracking",
    "cli_commands": [
      {
        "command": "evidence_check",
        "note": "Manual review of privileged user training records, advanced security certifications, and specialized training documentation"
      }
    ]
  },
  "KSI-CED-03": {
    "description": "Require and monitor the effectiveness of role-specific training provided to development and engineering staff that covers best practices for delivering secure software.",
    "justification": "Validates security awareness training from basic phishing tests to enterprise-grade continuous awareness programs and behavior analytics",
    "cli_commands": [
      {
        "command": "aws lambda list-functions --output json",
        "note": "Check for security awareness automation functions"
      },
      {
        "command": "aws events list-rules --output json",
        "note": "Check for automated training delivery triggers"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Check for enterprise training governance policies"
      }
    ]
  },
  "KSI-CED-04": {
    "description": "Require and monitor the effectiveness of role-specific training to staff involved with incident response or disaster recovery.",
    "justification": "Manual evidence check for specialized IR/DR training records.",
    "cli_commands": [
      {
        "command": "evidence_check",
        "note": "Manual review of training records for IR/DR staff."
      }
    ]
  },
 "KSI-CMT-01": {
    "description": "Log and monitor modifications to the cloud service offering.",
    "justification": "Validates comprehensive change management documentation from basic policies to enterprise-grade automated change workflows and compliance tracking",
    "cli_commands": [
      {
        "command": "aws cloudtrail describe-trails --output json",
        "note": "List ALL CloudTrail trails in the account/region for change audit logging"
      },
      {
        "command": "aws cloudtrail describe-trails --output json | jq -r '.trailList[].TrailARN' | xargs -I {} aws cloudtrail get-trail-status --name {} --output json | jq -s '.' || echo '[]'",
        "note": "Get status for ALL CloudTrail trails (multi-trail validation) - validates logging is active across all trails"
      },
      {
        "command": "aws logs describe-log-groups --output json",
        "note": "Validate CloudWatch Logs for change management event tracking"
      },
      {
        "command": "aws events list-rules --output json",
        "note": "Check EventBridge rules for automated change workflows"
      },
      {
        "command": "aws cloudwatch describe-alarms --output json",
        "note": "Validate CloudWatch alarms for change monitoring"
      },
      {
        "command": "aws sns list-topics --output json",
        "note": "Check SNS topics for change notification workflows"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Validate Lambda functions for automated change management"
      },
      {
        "command": "aws ssm describe-instance-information --output json",
        "note": "Check SSM for configuration management and change tracking"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Validate organization-wide change management policies"
      }
    ]
  },
  "KSI-CMT-02": {
    "description": "Execute changes though redeployment of version controlled immutable resources rather than direct modification wherever possible",
    "justification": "Validates comprehensive self-service provisioning from basic AMIs to enterprise-grade service catalogs and automated deployment templates",
    "cli_commands": [
      {
        "command": "aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE --output json",
        "note": "Check CloudFormation stacks for infrastructure templates"
      },
      {
        "command": "aws ec2 describe-instances --query 'Reservations[*].Instances[*].[InstanceId,ImageId,LaunchTime]' --output json",
        "note": "Validate EC2 instances using standardized AMIs"
      },
      {
        "command": "aws ec2 describe-launch-templates --output json",
        "note": "Check launch templates for self-service provisioning"
      },
      {
        "command": "aws autoscaling describe-auto-scaling-groups --output json",
        "note": "Validate auto-scaling using standardized templates"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Check Lambda functions for serverless self-service deployment"
      },
      {
        "command": "aws deploy list-applications --output json",
        "note": "Validate CodeDeploy applications for automated deployment"
      },
      {
        "command": "aws ecr describe-repositories --output json",
        "note": "Check ECR repositories for container image templates"
      },
      {
        "command": "aws servicecatalog search-products --output json",
        "note": "Validate Service Catalog for self-service product templates"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Check organization-wide standardized provisioning policies"
      }
    ]
  },
  "KSI-CMT-03": {
    "description": "Automate persistent testing and validation of changes throughout deployment.",
    "justification": "Validates a hybrid compliance strategy: 1) Live, persistent validation via AWS Config rules. 2) Pre-deployment, automated testing via IaC scan artifacts (Checkov, SARIF, etc.).",
    "cli_commands": [
      {
        "command": "aws configservice describe-config-rules --output json",
        "note": "Measures the breadth of persistent, live security validation."
      }
    ],
    "artifact_evidence_paths": [
      "evidence_v2/KSI-CMT-03/checkov_scan_summary.json",
      "evidence_v2/KSI-CMT-03/automated_testing_proof.json",
      "evidence_v2/KSI-CMT-03/sarif_metadata.json"
    ]
  },
  "KSI-CMT-04": {
    "description": "Always follow a documented change management procedure.",
    "justification": "Verifies that a change management procedure is documented and that the process is being followed by checking for stored Terraform plan files in S3.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/change-management-procedure.md",
        "note": "Check for the existence of the change management procedure document."
      },
      {
        "command": "aws s3 ls s3://mks-states/plans/ --recursive",
        "note": "Check S3 for stored Terraform plans as evidence that the change process is followed."
      }
    ]
  },
  "KSI-CMT-05": {
    "description": "Evaluate risk and potential impact of any change (Superseded by KSI-AFR-05)",
    "justification": "Performs a hybrid check: 1) A live call to AWS CodeCommit to verify the risk assessment document exists. 2) A live call to S3 to verify Terraform plans are being stored as evidence of impact analysis.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --commit-specifier main --file-path procedures/change-risk-assessment.md",
        "note": "Live check for the risk assessment procedure in CodeCommit."
      },
      {
        "command": "aws s3 ls s3://mks-states/plans/ --recursive",
        "note": "Check S3 for stored Terraform plans as evidence of impact assessment."
      }
    ]
  },
  "KSI-CNA-01": {
    "description": "Configure all machine-based information resources to limit inbound and outbound network traffic.",
    "justification": "Validates comprehensive DDoS protection and network security from basic security groups to enterprise-grade WAF, CloudFront, and defense-in-depth architecture",
    "cli_commands": [
      {
        "command": "aws ec2 describe-security-groups --output json",
        "note": "Check security group configurations for defense-in-depth network controls"
      },
      {
        "command": "aws ec2 describe-network-acls --output json",
        "note": "Validate network ACLs for additional layer of network security"
      },
      {
        "command": "aws ec2 describe-route-tables --output json",
        "note": "Check routing configurations for network segmentation and isolation"
      },
      {
        "command": "aws ec2 describe-nat-gateways --output json",
        "note": "Validate NAT gateway configurations for secure outbound connectivity"
      },
      {
        "command": "aws ec2 describe-vpc-endpoints --output json",
        "note": "Check VPC endpoints for private AWS service connectivity"
      },
      {
        "command": "aws wafv2 list-web-acls --scope REGIONAL --output json",
        "note": "Validate WAF configurations for application-layer DDoS protection"
      },
      {
        "command": "aws elbv2 describe-load-balancers --output json",
        "note": "Check load balancer configurations for traffic distribution and DDoS resilience"
      },
      {
        "command": "aws logs describe-log-groups --log-group-name-prefix '/aws/vpc/' --output json",
        "note": "Validate VPC Flow Logs for network traffic monitoring and DDoS detection"
      }
    ]
  },
  "KSI-CNA-02": {
    "description": "Design systems to minimize the attack surface and minimize lateral movement if compromised.",
    "justification": "Validates comprehensive network segmentation from basic VPC subnets to enterprise-grade multi-tier architecture with strict isolation",
    "cli_commands": [
      {
        "command": "aws ec2 describe-subnets --output json",
        "note": "Check subnet configurations for network segmentation and security zones"
      },
      {
        "command": "aws ec2 describe-security-groups --output json",
        "note": "Validate security group rules for zone-based access control"
      },
      {
        "command": "aws ec2 describe-instances --output json",
        "note": "Check EC2 instance placements across security zones"
      },
      {
        "command": "aws ec2 describe-network-acls --output json",
        "note": "Validate network ACLs for zone-level traffic control"
      },
      {
        "command": "aws elbv2 describe-load-balancers --output json",
        "note": "Check load balancer configurations for zone-aware traffic distribution"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Validate Lambda function network configurations and VPC integration"
      },
      {
        "command": "aws rds describe-db-instances --output json",
        "note": "Check RDS instance placements in private subnets and security zones"
      }
    ]
  },
  "KSI-CNA-03": {
    "description": "Use logical networking and related capabilities to enforce traffic flow controls.",
    "justification": "Validates strict public access control from basic public subnet restrictions to enterprise-grade private connectivity with minimal internet exposure",
    "cli_commands": [
      {
        "command": "aws ec2 describe-route-tables --output json",
        "note": "Check routing tables for public internet gateway associations"
      },
      {
        "command": "aws ec2 describe-network-acls --output json",
        "note": "Validate network ACLs for public access restrictions"
      },
      {
        "command": "aws ec2 describe-vpc-endpoints --output json",
        "note": "Check VPC endpoints for private AWS service connectivity without internet"
      },
      {
        "command": "aws ec2 describe-transit-gateways --output json",
        "note": "Validate transit gateway configurations for private inter-VPC connectivity"
      },
      {
        "command": "aws elbv2 describe-load-balancers --output json",
        "note": "Check load balancer schemes (internal vs internet-facing) as managed access points"
      },
      {
        "command": "aws ec2 describe-nat-gateways --output json",
        "note": "Validate NAT gateways as controlled egress points for private resources"
      },
      {
        "command": "aws logs describe-log-groups --log-group-name-prefix '/aws/vpc/' --output json",
        "note": "Check VPC Flow Logs for monitoring public access patterns"
      }
    ]
  },
  "KSI-CNA-04": {
    "description": "Use immutable infrastructure with strictly defined functionality and privileges by default.",
    "justification": "Validates a hybrid infrastructure model by checking for: 1) Serverless adoption (Lambda). 2) IaC workflow (S3 state/plans). 3) Automated controls (CMT-03 artifacts). 4) Least privilege (IAM). 5) Network security (SGs).",
    "cli_commands": [
      {
        "command": "aws s3 ls s3://mks-states/ --recursive",
        "note": "Check S3 for Terraform state and plan files as evidence of an immutable IaC workflow."
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Validate adoption of inherently immutable serverless functions."
      },
      {
        "command": "aws ec2 describe-security-groups --output json",
        "note": "Provide full security group data to check for exposed sensitive ports."
      },
      {
        "command": "aws iam list-entities-for-policy --policy-arn arn:aws:iam::aws:policy/AdministratorAccess --output json",
        "note": "CRITICAL: Check for any users or non-standard roles with AdministratorAccess."
      },
      {
        "command": "aws iam list-roles --output json",
        "note": "Provide full role details (Path, Description) to validate if admin roles are AWS-managed."
      }
    ],
    "artifact_evidence_paths": [
      "evidence_v2/KSI-CMT-03/checkov_scan_summary.json",
      "evidence_v2/KSI-CMT-03/automated_testing_proof.json"
    ]
  },
  "KSI-CNA-05": {
    "description": "Deploy effective spam, spoofing, and denial-of-service countermeasures.",
    "justification": "Validates multi-layered DDoS protection (WAF, CloudFront, ALB, Auto Scaling) and DNS resilience. Email spam protection validated only when email services are detected (SES, MX records)",
    "cli_commands": [
      {
        "command": "aws wafv2 list-web-acls --scope REGIONAL --output json",
        "note": "Check Regional WAF for Layer 7 DDoS protection"
      },
      {
        "command": "aws wafv2 list-web-acls --scope CLOUDFRONT --region us-east-1 --output json",
        "note": "Validate CloudFront WAF for edge DDoS protection"
      },
      {
        "command": "aws cloudfront list-distributions --output json",
        "note": "Check CloudFront distributions for global DDoS mitigation"
      },
      {
        "command": "aws elbv2 describe-load-balancers --output json",
        "note": "Validate Multi-AZ load balancers for service resilience"
      },
      {
        "command": "aws autoscaling describe-auto-scaling-groups --output json",
        "note": "Check auto-scaling for capacity-based DDoS mitigation"
      },
      {
        "command": "aws route53 list-hosted-zones --output json",
        "note": "List ALL Route53 hosted zones for DNS DDoS protection analysis"
      },
      {
        "command": "aws cloudwatch describe-alarms --output json",
        "note": "Check CloudWatch alarms for DDoS detection and alerting"
      },
      {
        "command": "aws route53 list-hosted-zones --output json | jq -r '.HostedZones[].Id' | xargs -I {} aws route53 list-resource-record-sets --hosted-zone-id {} --max-items 100 --output json | jq -s '.' || echo '[]'",
        "note": "Get DNS records for ALL hosted zones - validates SPF/DMARC/DKIM email authentication across all domains"
      },
      {
        "command": "aws sesv2 list-email-identities --output json || echo '{\"EmailIdentities\": []}'",
        "note": "Detect email services to determine spam protection applicability"
      }
    ]
  },
  "KSI-CNA-06": {
    "description": "Design systems for high availability and rapid recovery.",
    "justification": "Validates comprehensive high availability from basic multi-AZ to enterprise-grade disaster recovery and global resilience",
    "cli_commands": [
      {
        "command": "aws ec2 describe-subnets --output json",
        "note": "Check subnet distribution across multiple availability zones"
      },
      {
        "command": "aws ec2 describe-availability-zones --output json",
        "note": "Validate availability zone utilization for redundancy"
      },
      {
        "command": "aws rds describe-db-instances --output json",
        "note": "Check RDS Multi-AZ deployments and read replicas for database HA"
      },
      {
        "command": "aws elbv2 describe-load-balancers --output json",
        "note": "Validate load balancer configurations across multiple AZs"
      },
      {
        "command": "aws autoscaling describe-auto-scaling-groups --output json",
        "note": "Check auto-scaling configurations for multi-AZ distribution"
      },
      {
        "command": "aws backup list-backup-plans --output json",
        "note": "Validate AWS Backup plans for automated HA recovery"
      },
      {
        "command": "aws ec2 describe-snapshots --owner-ids self --output json",
        "note": "Check EBS snapshot policies for data resilience"
      },
      {
        "command": "aws s3api list-buckets --output json",
        "note": "Validate S3 configurations for cross-region replication"
      },
      {
        "command": "aws route53 list-hosted-zones --output json",
        "note": "Check Route53 health checks and DNS failover for service HA"
      }
    ]
  },
  "KSI-CNA-07": {
    "description": "Maximize use of managed services and cloud resources",
    "justification": "Validates comprehensive cloud-native architecture from basic managed services to enterprise-grade serverless and fully managed infrastructure",
    "cli_commands": [
      {
        "command": "aws configservice describe-config-rules --output json",
        "note": "Check AWS Config rules for managed service compliance monitoring"
      },
      {
        "command": "aws cloudtrail describe-trails --output json",
        "note": "Validate CloudTrail managed service for audit logging"
      },
      {
        "command": "aws cloudtrail get-trail-status --name $(aws cloudtrail describe-trails --query 'trailList[0].Name' --output text) --output json || echo '{\"IsLogging\": false}'",
        "note": "Check active CloudTrail logging status"
      },
      {
        "command": "aws kms list-keys --output json",
        "note": "Validate AWS KMS managed encryption service usage"
      },
      {
        "command": "aws iam get-account-summary --output json",
        "note": "Check IAM managed identity service utilization"
      },
      {
        "command": "aws ec2 describe-instances --output json",
        "note": "Analyze EC2 usage vs serverless alternatives"
      },
      {
        "command": "aws elbv2 describe-load-balancers --output json",
        "note": "Validate managed load balancing service usage"
      },
      {
        "command": "aws autoscaling describe-auto-scaling-groups --output json",
        "note": "Check managed auto-scaling service configurations"
      },
      {
        "command": "aws s3api list-buckets --output json",
        "note": "Validate S3 managed storage service usage"
      },
      {
        "command": "aws cloudwatch describe-alarms --output json",
        "note": "Check CloudWatch managed monitoring service"
      },
      {
        "command": "aws backup list-backup-plans --output json",
        "note": "Validate AWS Backup managed service for data protection"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Check AWS Organizations managed service for account governance"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Validate serverless Lambda managed compute service usage"
      },
      {
        "command": "aws rds describe-db-instances --output json",
        "note": "Check RDS managed database service usage"
      },
      {
        "command": "aws apigateway get-rest-apis --output json",
        "note": "Validate API Gateway managed API service usage"
      }
    ]
  },
  "KSI-CNA-08": {
    "description": "Use automated services to persistently assess the security posture of all machine-based information resources and automatically enforce their intended operational state.",
    "justification": "Validates a multi-layered automation strategy, including persistent assessment (Security Hub, Config) and automated enforcement (SSM Associations, custom Lambda functions).",
    "cli_commands": [
      {
        "command": "aws securityhub get-enabled-standards --output json",
        "note": "Validates the foundational framework for persistent assessment."
      },
      {
        "command": "aws configservice describe-config-rules --output json",
        "note": "Measures the breadth of persistent security assessment."
      },
      {
        "command": "aws configservice describe-configuration-recorder-status --output json",
        "note": "Verifies that assessment data is actively being recorded."
      },
      {
        "command": "aws securityhub describe-hub --output json",
        "note": "Checks for centralized visibility via Security Hub."
      },
      {
        "command": "aws configservice describe-configuration-aggregators --output json",
        "note": "Checks for enterprise-wide visibility via Config aggregators."
      },
      {
        "command": "aws ssm list-associations --output json || echo '{\"Associations\": []}'",
        "note": "Validates automated enforcement via SSM State Manager associations."
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Identifies custom, event-driven enforcement capabilities via Lambda."
      }
    ]
  },
  "KSI-IAM-01": {
    "description": "Enforce multi-factor authentication (MFA) using methods that are difficult to intercept or impersonate (phishing-resistant MFA) for all user authentication.",
    "justification": "Validates MFA via Identity Center and federation, while accurately identifying human IAM users by checking for console passwords before verifying their MFA status.",
    "cli_commands": [
      {
        "command": "aws iam list-users --output json",
        "note": "Get all traditional IAM users to analyze."
      },
      {
        "command": "aws sso-admin list-instances --output json",
        "note": "Verify that AWS Identity Center is the primary identity platform."
      },
      {
        "command": "aws identitystore list-users --identity-store-id d-9067ccc0ff --output json",
        "note": "Get Identity Center users to confirm federation."
      },
      {
        "command": "for user in $(aws iam list-users --query 'Users[].UserName' --output text); do aws iam get-login-profile --user-name \"$user\" --output json; done",
        "note": "Loop through each IAM user to check for a console password."
      },
      {
        "command": "for user in $(aws iam list-users --query 'Users[].UserName' --output text); do echo \"User: $user\"; aws iam list-mfa-devices --user-name \"$user\" --output json; done",
        "note": "Loop through each IAM user to check for attached MFA devices."
      }
    ]
  },
  "KSI-IAM-02": {
    "description": "Use secure passwordless methods for user authentication and authorization when feasible, otherwise enforce strong passwords with MFA.",
    "justification": "Validates comprehensive identity federation from basic SAML to enterprise-grade SSO and centralized identity management",
    "cli_commands": [
      {
        "command": "aws iam list-saml-providers --output json",
        "note": "Check SAML identity providers for federated authentication"
      },
      {
        "command": "aws iam list-virtual-mfa-devices --output json",
        "note": "Validate virtual MFA devices in federated authentication"
      },
      {
        "command": "aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": \"NotConfigured\"}'",
        "note": "Check password policy for federated identity fallback requirements"
      },
      {
        "command": "aws sts get-caller-identity --output json",
        "note": "Validate federated identity assumption and role-based access"
      }
    ]
  },
  "KSI-IAM-03": {
    "description": "Enforce appropriately secure authentication methods for non-user accounts and services.",
    "justification": "Fails immediately if any IAM user exists without a console password, as this indicates a service account using insecure, long-lived credentials. It then scores the account based on its adoption of IAM roles.",
    "cli_commands": [
      {
        "command": "aws iam list-roles --output json",
        "note": "Check for a strong foundation of IAM roles for service authentication."
      },
      {
        "command": "aws iam list-users --output json",
        "note": "Identify all traditional IAM users for analysis."
      },
      {
        "command": "aws ec2 describe-instances --output json",
        "note": "Verify that all running EC2 instances are using IAM roles (Provides full instance data)."
      },
      {
        "command": "for user in $(aws iam list-users --query 'Users[].UserName' --output text 2>/dev/null || echo ''); do aws iam get-login-profile --user-name \"$user\" --output json 2>/dev/null || true; done",
        "note": "CRITICAL: Check for console passwords. A failure here for a user implies they *lack* a password (service user anti-pattern)."
      }
    ]
  },
  "KSI-IAM-04": {
    "description": "Require a centralized identity management system.",
    "justification": "Validates centralized identity management via SSO instances, role inference, and caller identity.",
    "cli_commands": [
      {
        "command": "aws sso-admin list-instances --output json",
        "note": "List ALL SSO instances."
      },
      {
        "command": "aws sso-admin list-instances --output json | jq -r '.Instances[].InstanceArn' | xargs -I {} aws sso-admin list-permission-sets --instance-arn {} --output json | jq -s '.' || echo '[]'",
        "note": "Get permission sets (May fail if permissions restricted)."
      },
      {
        "command": "aws iam list-users --output json",
        "note": "Check for local IAM users."
      },
      {
        "command": "aws iam get-account-summary --output json",
        "note": "Validate account-wide IAM posture."
      },
      {
        "command": "aws organizations list-accounts --output json",
        "note": "Check organization accounts."
      },
      {
        "command": "aws iam list-roles --output json",
        "note": "REQUIRED: List roles to infer SSO usage if API access is blocked."
      },
      {
        "command": "aws sts get-caller-identity --output json",
        "note": "REQUIRED: Validate current session is temporary (JIT)."
      }
    ]
  },
  "KSI-IAM-05": {
    "description": "Require phishing-resistant MFA for all user authentication to the cloud service offering and all customer information resources.",
    "justification": "Validates phishing-resistant MFA (hardware tokens, FIDO2) from basic IAM MFA to enterprise-grade SSO integration with hardware token enforcement",
    "cli_commands": [
      {
        "command": "aws iam list-users --output json",
        "note": "List all IAM users to check MFA assignment"
      },
      {
        "command": "aws sso-admin list-instances --output json",
        "note": "List ALL SSO instances for MFA policy validation"
      },
      {
        "command": "aws sso-admin list-instances --output json | jq -r '.Instances[].IdentityStoreId' | xargs -I {} aws identitystore list-users --identity-store-id {} --output json | jq -s '.' || echo '[]'",
        "note": "Get users for ALL SSO/Identity Store instances - validates MFA enforcement across all identity sources"
      },
      {
        "command": "aws iam list-virtual-mfa-devices --output json",
        "note": "Check virtual MFA devices (should flag if only virtual MFA, not phishing-resistant)"
      },
      {
        "command": "aws cloudtrail describe-trails --output json",
        "note": "List ALL CloudTrail trails for MFA authentication logging"
      },
      {
        "command": "aws cloudtrail describe-trails --output json | jq -r '.trailList[].TrailARN' | xargs -I {} aws cloudtrail get-trail-status --name {} --output json | jq -s '.' || echo '[]'",
        "note": "Get status for ALL CloudTrail trails - validates logging of all authentication events"
      },
      {
        "command": "aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": null}'",
        "note": "Validate password policy as defense-in-depth alongside MFA"
      },
      {
        "command": "aws ec2 describe-security-groups --output json",
        "note": "Validate micro-segmentation (Assume Breach)"
      },
      {
       "command": "aws ec2 describe-vpc-endpoints --output json",
       "note": "Validate secure communications"
     },
     {
      "command": "aws sts get-caller-identity --output json",
      "note": "Validate session credentials"
     }
    ]
  },
  "KSI-IAM-06": {
    "description": "Automatically disable or otherwise secure accounts with privileged access in response to suspicious activity",
    "justification": "Validates a multi-layered automated response system, including threat detection (GuardDuty, Security Hub), event triggering (EventBridge), and automated actions (Lambda, Alarms).",
    "cli_commands": [
      {
        "command": "aws guardduty list-detectors --output json",
        "note": "Validates the presence of an automated threat detection service."
      },
      {
        "command": "aws securityhub describe-hub --output json",
        "note": "Checks for a centralized hub for managing security events."
      },
      {
        "command": "aws events list-rules --output json",
        "note": "Checks for EventBridge rules that trigger actions on security events."
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Identifies custom Lambda functions designed for automated security responses."
      },
      {
        "command": "aws cloudwatch describe-alarms --output json",
        "note": "Checks for CloudWatch alarms that monitor for and notify on security events."
      }
    ]
  },
  "KSI-IAM-07": {
    "description": "Securely manage the lifecycle and privileges of all accounts, roles, and groups, using automation.",
    "justification": "Validates comprehensive identity lifecycle management, including role usage, policy activity, and centralized management via AWS Identity Center.",
    "cli_commands": [
      {
        "command": "aws iam list-roles --output json",
        "note": "Check IAM roles for consistent identity management."
      },
      {
        "command": "aws iam list-users --output json",
        "note": "Validate IAM users and lifecycle management."
      },
      {
        "command": "aws iam list-policies --scope Local --output json",
        "note": "Check custom IAM policies for consistent identity governance and activity."
      },
      {
        "command": "aws sso-admin list-instances --output json",
        "note": "Check for AWS Identity Center (SSO) usage for central management."
      }
    ]
  },
  "KSI-INR-01": {
    "description": "Always follow a documented incident response procedure.",
    "justification": "Validates incident response procedures in version-controlled repository with FedRAMP-compliant notification timelines and AWS-specific containment actions.",
    "cli_commands": [
      {
        "command": "aws codecommit get-repository --repository-name security-governance --output json",
        "note": "Verify security-governance repository exists"
      },
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json",
        "note": "Retrieve incident response plan document"
      },
      {
        "command": "aws codecommit get-folder --repository-name security-governance --folder-path procedures/ --output json",
        "note": "List incident response procedures"
      },
      {
        "command": "aws securityhub get-findings --max-results 50 --output json",
        "note": "Verify Security Hub findings tracking"
      },
      {
        "command": "aws guardduty list-detectors --output json",
        "note": "Verify GuardDuty threat detection enabled"
      },
      {
        "command": "aws cloudtrail describe-trails --output json",
        "note": "Validate CloudTrail managed service for audit logging"
      },
      {
        "command": "aws cloudtrail get-trail-status --name $(aws cloudtrail describe-trails --query 'trailList[0].Name' --output text) --output json || echo '{\"IsLogging\": false}'",
        "note": "Check active CloudTrail logging status"
      },
      {
        "command": "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
        "note": "Check incident response plan maintenance"
      }
    ]
  },
  "KSI-INR-02": {
    "description": "Maintain a log of incidents and periodically review past incidents for patterns or vulnerabilities.",
    "justification": "Validates insider threat detection from basic access monitoring to enterprise-grade behavioral analytics and automated threat detection",
    "cli_commands": [
      {
        "command": "aws events list-rules --output json",
        "note": "Check EventBridge rules for insider threat detection automation"
      },
      {
        "command": "aws logs describe-log-groups --output json",
        "note": "Validate CloudWatch Logs for insider threat monitoring"
      },
      {
        "command": "aws guardduty list-detectors --output json",
        "note": "Check GuardDuty for insider threat detection capabilities"
      },
      {
        "command": "aws securityhub get-findings --max-results 5 --output json",
        "note": "Validate Security Hub findings for insider threat alerts"
      },
      {
        "command": "evidence_check",
        "note": "Manual review of insider threat program documentation, detection rules, and response procedures"
      }
    ]
  },
  "KSI-INR-03": {
    "description": "Generate after action reports and regularly incorporate lessons learned into operations.",
    "justification": "Validates automated incident response from basic CloudWatch alarms to enterprise-grade SOAR platforms and intelligent threat response",
    "cli_commands": [
      {
        "command": "aws securityhub get-findings --max-results 50 --output json",
        "note": "Check Security Hub for incident detection and automated response triggers"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Validate Lambda functions for automated incident response actions"
      },
      {
        "command": "aws securityhub describe-standards --output json",
        "note": "Check Security Hub standards for automated compliance monitoring"
      },
      {
        "command": "aws securityhub get-enabled-standards --output json",
        "note": "Validate enabled Security Hub standards for continuous monitoring"
      }
    ]
  },
 "KSI-MLA-01": {
    "description": "Log all activity on all information resources supporting the cloud service offering to a protected audit log in at least one location.",
    "justification": "Validates comprehensive audit logging from basic CloudTrail to enterprise-grade multi-region, organization-wide logging with S3/CloudWatch integration and log file validation",
    "cli_commands": [
      {
        "command": "aws cloudtrail describe-trails --output json",
        "note": "List ALL CloudTrail trails to ensure comprehensive audit coverage"
      },
      {
        "command": "aws cloudtrail describe-trails --output json | jq -r '.trailList[].TrailARN' | xargs -I {} aws cloudtrail get-trail-status --name {} --output json | jq -s '.' || echo '[]'",
        "note": "Get status for ALL CloudTrail trails - validates logging is active and audit logs are being collected"
      },
      {
        "command": "aws s3api list-buckets --output json",
        "note": "Check S3 buckets for audit log storage"
      },
      {
        "command": "aws logs describe-log-groups --output json",
        "note": "Validate CloudWatch Logs for centralized audit log aggregation"
      },
      {
        "command": "aws kms list-aliases --output json",
        "note": "Check KMS keys for audit log encryption"
      },
      {
        "command": "aws guardduty list-detectors --output json",
        "note": "Validate GuardDuty for threat detection on audit logs"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Check organization-wide audit logging policies"
      }
    ]
  },
  "KSI-MLA-02": {
    "description": "Regularly review and audit logs.",
    "justification": "Validates comprehensive log review from basic notification-driven processes to enterprise-grade automated analysis and compliance governance",
    "cli_commands": [
      {
        "command": "aws cloudwatch describe-alarms --output json",
        "note": "Check CloudWatch alarms for automated log review"
      },
      {
        "command": "aws logs describe-metric-filters --output json",
        "note": "Validate metric filters for log pattern analysis"
      },
      {
        "command": "aws sns list-topics --output json",
        "note": "Check SNS topics for log review notifications"
      },
      {
        "command": "aws logs describe-log-groups --output json",
        "note": "Analyze log retention policies and compliance"
      },
      {
        "command": "aws cloudtrail lookup-events --max-items 10 --output json",
        "note": "Check recent audit events for review validation"
      },
      {
        "command": "aws securityhub get-insights --output json",
        "note": "Validate advanced log correlation and security analytics"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Check custom log processing and automated review functions"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Validate enterprise-wide centralized log review capabilities"
      }
    ]
  },
  "KSI-MLA-03": {
    "description": "Rapidly detect and remediate or mitigate vulnerabilities (Superseded by KSI-AFR-04)",
    "justification": "Validates comprehensive vulnerability detection, including Config rules, Inspector scanning, active findings, patch management, automated response, and enterprise governance.",
    "cli_commands": [
      {
        "command": "aws securityhub get-enabled-standards --region us-east-1 --output json",
        "note": "Check Security Hub enabled standards for vulnerability detection"
      },
      {
        "command": "aws inspector2 get-configuration --output json",
        "note": "Validate Inspector for continuous vulnerability scanning"
      },
      {
        "command": "aws securityhub get-findings --filters '{\"RecordState\":[{\"Value\":\"ACTIVE\",\"Comparison\":\"EQUALS\"}],\"WorkflowStatus\":[{\"Value\":\"NEW\",\"Comparison\":\"EQUALS\"}]}' --max-results 50 --output json",
        "note": "Check active Security Hub findings for rapid detection"
      },
      {
        "command": "aws ssm describe-patch-baselines --output json",
        "note": "Validate patch baselines for automated vulnerability remediation"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Check Lambda functions for automated remediation workflows"
      },
      {
        "command": "aws cloudwatch describe-alarms --output json",
        "note": "Validate CloudWatch alarms for vulnerability detection alerts"
      },
      {
        "command": "aws configservice describe-config-rules --output json",
        "note": "Check Config Rules for configuration vulnerability detection."
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Check organization-wide vulnerability management policies"
      }
    ]
  },
  "KSI-MLA-05": {
    "description": "Perform Infrastructure as Code and configuration evaluation and testing.",
    "justification": "Validates comprehensive change tracking from basic CloudTrail and Config rules to enterprise-grade automated governance and compliance reporting",
    "cli_commands": [
      {
        "command": "aws configservice describe-config-rules --output json",
        "note": "Check Config Rules for compliance evaluation during change management"
      },
      {
        "command": "aws ssm describe-parameters --max-results 50 --output json",
        "note": "Check SSM parameters for configuration change management"
      },
      {
        "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=ResourceType,AttributeValue=AWS::CloudFormation::Stack --max-items 20 --output json",
        "note": "Validate CloudTrail audit logs for configuration changes"
      },
      {
        "command": "aws resourcegroupstaggingapi get-resources --resource-type-filters cloudformation --output json",
        "note": "Check resource tagging for change management governance"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Validate organization-wide change management policies"
      }
    ]
  },
  "KSI-MLA-07": {
    "description": "Maintain a list of information resources and event types that will be monitored, logged, and audited, then do so.",
    "justification": "Validates comprehensive log aggregation from basic CloudWatch to enterprise-grade centralized SIEM and cross-account log collection",
    "cli_commands": [
      {
        "command": "aws logs describe-log-groups --output json",
        "note": "Check CloudWatch Log Groups for centralized log aggregation"
      },
      {
        "command": "aws cloudtrail describe-trails --output json",
        "note": "Validate CloudTrail for organization-wide audit log aggregation"
      },
      {
        "command": "aws cloudwatch describe-alarms --output json",
        "note": "Check CloudWatch alarms for aggregated log monitoring"
      }
    ]
  },
  "KSI-MLA-08": {
    "description": "Use a least-privileged, role and attribute-based, and just-in-time access authorization model for access to log data based on organizationally defined data sensitivity.",
    "justification": "Validates a multi-layered log protection strategy, including log integrity (CloudTrail), long-term retention and encryption (CloudWatch, KMS), and restricted access (IAM RBAC).",
    "cli_commands": [
      {
        "command": "aws cloudtrail describe-trails --output json",
        "note": "Validate the integrity and encryption of the primary audit log source (CloudTrail)."
      },
      {
        "command": "aws logs describe-log-groups --output json",
        "note": "Check CloudWatch Logs for evidence of long-term, compliance-grade retention."
      },
      {
        "command": "aws iam list-roles --output json",
        "note": "Check for specialized IAM roles that enforce least privilege for log access."
      },
      {
        "command": "aws KMS list-keys --output json",
        "note": "Verify that KMS keys are available for encrypting logs at rest."
      }
    ]
  },
  "KSI-PIY-01": {
    "description": "Use authoritative sources to automatically maintain real-time inventories of all information resources.",
    "justification": "Validates comprehensive user inventory from basic IAM list to enterprise-grade identity lifecycle management and automated discovery",
    "cli_commands": [
      {
        "command": "aws ec2 describe-instances --output json",
        "note": "Check EC2 instances for system resource inventory"
      },
      {
        "command": "aws rds describe-db-instances --output json",
        "note": "Validate RDS database inventory"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Check Lambda functions inventory"
      },
      {
        "command": "aws s3api list-buckets --output json",
        "note": "Validate S3 bucket inventory"
      },
      {
        "command": "aws elbv2 describe-load-balancers --output json",
        "note": "Check load balancer inventory"
      },
      {
        "command": "aws route53 list-hosted-zones --output json",
        "note": "Validate Route53 DNS inventory"
      },
      {
        "command": "aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE --output json",
        "note": "Check CloudFormation stack inventory"
      },
      {
        "command": "aws s3 ls s3://mksfr-sftp-bucket/inventory/ || echo 'No inventory files'",
        "note": "Validate automated inventory collection in S3"
      },
      {
        "command": "aws lambda get-function --function-name aws_inventory --output json || echo '{\"Configuration\": null}'",
        "note": "Check automated inventory Lambda function"
      }
    ]
  },
  "KSI-PIY-02": {
    "description": "Document the security objectives and requirements for each information resource or set of information resources.",
    "justification": "RFC-0014 Phase Two: Validates per-component security documentation in version-controlled CodeCommit. 'Each resource' means system components (frontend, API, database), NOT per-AWS-service-type.",
    "cli_commands": [
      {
        "command": "aws codecommit get-repository --repository-name security-governance --output json",
        "note": "Verify security-governance repository exists"
      },
      {
        "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/security-objectives/ --output json",
        "note": "List per-component security documentation (expected: 3-5 system components)"
      },
      {
        "command": "aws codecommit list-approval-rule-templates --output json",
        "note": "Validate PR approval workflow configured"
      },
      {
        "command": "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
        "note": "Check recent documentation updates"
      },
      {
        "command": "aws codecommit get-branch --repository-name security-governance --branch-name main --output json",
        "note": "Validate main branch configuration"
      }
    ]
  },
  "KSI-PIY-03": {
    "description": "Maintain a vulnerability disclosure program.",
    "justification": "Validates vulnerability disclosure program through CodeCommit policy repository with submission process, response procedures, and maintenance tracking",
    "cli_commands": [
      {
        "command": "aws codecommit list-repositories --output json",
        "note": "Verify security-governance repository exists"
      },
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-disclosure-policy.md --output json",
        "note": "Retrieve vulnerability disclosure policy from CodeCommit"
      },
      {
        "command": "aws codecommit get-differences --repository-name security-governance --after-commit-specifier HEAD --output json",
        "note": "Check VDP maintenance activity through commit history"
      },
      {
        "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies --output json",
        "note": "List all policy documents for supporting VDP documentation"
      }
    ]
  },
  "KSI-PIY-04": {
    "description": "Monitor the effectiveness of building security and privacy considerations into the Software Development Lifecycle and aligning with CISA Secure By Design principles.",
    "justification": "Validates comprehensive authorized software management from basic allow-lists to enterprise-grade application control and compliance tracking",
    "cli_commands": [
      {
        "command": "aws codebuild list-projects --output json",
        "note": "Check CodeBuild for authorized software deployment pipelines"
      },
      {
        "command": "aws codepipeline list-pipelines --output json",
        "note": "Validate CodePipeline for authorized software deployment"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Check Lambda functions for authorized serverless software"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Validate organization-wide authorized software policies"
      }
    ]
  },
  "KSI-PIY-05": {
    "description": "Document methods used to evaluate information resource implementations.",
    "justification": "Validates the evaluation methodology document, including assessment procedures and references to automated tools.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path policies/evaluation-methodology.md --output json",
        "note": "Retrieve the correct evaluation methodology document from the 'policies' directory."
      },
      {
        "command": "aws codecommit get-folder --repository-name security-governance --folder-path procedures/ --output json",
        "note": "List any supporting evaluation and assessment procedures."
      },
      {
        "command": "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
        "note": "Check for recent updates to the methodology."
      }
    ]
  },
  "KSI-PIY-06": {
    "description": "Monitor the effectiveness of the organization's investments in achieving security objectives.",
    "justification": "Validates organizational commitment to security through active engagement, tooling investment, and deployed monitoring capabilities.",
    "cli_commands": [
      {
        "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=ConsoleLogin --start-time $(date -u -d '30 days ago' '+%Y-%m-%dT%H:%M:%S') --max-items 50 --output json",
        "note": "Measure active security team engagement via console logins."
      },
      {
        "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=PutConfigRule --start-time $(date -u -d '90 days ago' '+%Y-%m-%dT%H:%M:%S') --max-items 50 --output json",
        "note": "Measure security engineering activity via Config rule deployments."
      },
      {
        "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=PutMetricAlarm --start-time $(date -u -d '90 days ago' '+%Y-%m-%dT%H:%M:%S') --max-items 50 --output json",
        "note": "Measure security engineering activity via CloudWatch alarm deployments."
      },
      {
        "command": "aws configservice describe-config-rules --output json",
        "note": "Count the total number of deployed Config rules."
      },
      {
        "command": "aws cloudwatch describe-alarms --output json",
        "note": "Get all CloudWatch alarms for security analysis."
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Get all Lambda functions for security analysis."
      }
    ]
  },
  "KSI-PIY-07": {
    "description": "Document risk management decisions for software supply chain security.",
    "justification": "Validates the supply chain risk policy's content, its maintenance history, and the existence of a formal approval workflow.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md --output json",
        "note": "Retrieve the supply chain risk management policy to analyze its content."
      },
      {
        "command": "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
        "note": "Check the commit history for an audit trail of policy updates."
      },
      {
        "command": "aws codecommit list-approval-rule-templates --output json",
        "note": "Verify that a formal approval process is configured for the repository."
      }
    ]
  },
  "KSI-PIY-08": {
    "description": "Measure executive support via active budgetary controls and financial commitment.",
    "justification": "Validates executive engagement by confirming: 1. Active AWS Budgets (Financial Governance). 2. Actual financial spend (Resource Commitment). 3. Anomaly Detection (Proactive Oversight).",
    "cli_commands": [
      {
        "command": "aws sts get-caller-identity --query Account --output text | xargs -I {} aws budgets describe-budgets --account-id {} --output json",
        "note": "Governance: Retrieves all budgets, including spending limits (Plan) and current actual spend (Reality)."
      },
      {
        "command": "aws ce get-anomaly-monitors --output json",
        "note": "Oversight: Checks for active Cost Anomaly Detection monitors."
      }
    ]
  },
  "KSI-RPL-01": {
    "description": "Define Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).",
    "justification": "Validates RTO/RPO definition from basic backup schedules to enterprise-grade disaster recovery planning and business continuity governance",
    "cli_commands": [
      {
        "command": "aws rds describe-db-instances --output json",
        "note": "Check RDS backup configurations for RPO compliance"
      },
      {
        "command": "aws backup list-backup-plans --output json",
        "note": "Validate AWS Backup plans for RTO/RPO objectives"
      },
      {
        "command": "aws ssm get-parameter --name '/backup/rto-objectives' --query 'Parameter.Value' --output text || echo 'Not configured'",
        "note": "Check SSM Parameter Store for documented RTO objectives"
      },
      {
        "command": "aws ssm get-parameter --name '/backup/rpo-objectives' --query 'Parameter.Value' --output text || echo 'Not configured'",
        "note": "Validate SSM Parameter Store for documented RPO objectives"
      },
      {
        "command": "aws backup describe-backup-vault --backup-vault-name default --output json || echo '{\"BackupVault\": null}'",
        "note": "Check backup vault configuration for recovery capabilities"
      },
      {
        "command": "PLAN_ID=$(aws backup list-backup-plans --query 'BackupPlansList[0].BackupPlanId' --output text 2>/dev/null || echo 'none'); if [ \"$PLAN_ID\" != \"none\" ]; then aws backup list-backup-selections --backup-plan-id \"$PLAN_ID\" --output json; else echo '{\"BackupSelectionsList\": []}'; fi",
        "note": "Validate backup plan resource selections for comprehensive coverage"
      }
    ]
  },
  "KSI-RPL-02": {
    "description": "Develop and maintain a recovery plan that aligns with the defined recovery objectives.",
    "justification": "Validates that a recovery plan is implemented and maintained as code via AWS Backup plans, vaults, and evidence of recent execution.",
    "cli_commands": [
      {
        "command": "aws backup list-backup-plans --output json",
        "note": "Validates that recovery plans are defined and have been recently executed."
      },
      {
        "command": "aws backup list-backup-vaults --output json",
        "note": "Checks for secure, encrypted backup vaults to store recovery points."
      },
      {
        "command": "aws ec2 describe-snapshots --owner-ids self --max-results 100 --output json",
        "note": "Verifies the existence of recovery points (EBS snapshots)."
      }
    ]
  },
  "KSI-RPL-03": {
    "description": "Regularly test the recovery planning capability by performing disaster recovery tests at least annually.",
    "justification": "Validates disaster recovery testing infrastructure via backup plans, job history, and resource snapshots.",
    "cli_commands": [
      {
        "command": "aws backup list-backup-plans --output json",
        "note": "List ALL backup plans."
      },
      {
        "command": "aws backup list-backup-plans --output json | jq -r '.BackupPlansList[].BackupPlanId' | xargs -I {} aws backup get-backup-plan --backup-plan-id {} --output json | jq -s '.' || echo '[]'",
        "note": "Get details for ALL backup plans."
      },
      {
        "command": "aws backup list-backup-jobs --by-state COMPLETED --max-results 10 --output json",
        "note": "REQUIRED: Validate successful backup execution history."
      },
      {
        "command": "aws ec2 describe-snapshots --owner-ids self --max-results 10 --output json",
        "note": "REQUIRED: Validate existence of EBS snapshots."
      },
      {
        "command": "aws rds describe-db-instances --output json",
        "note": "REQUIRED: Validate RDS automated backup settings."
      },
      {
        "command": "aws lambda list-functions --query 'Functions[?contains(FunctionName, `backup`) || contains(FunctionName, `recovery`)]' --output json",
        "note": "Validate Lambda functions for automated DR testing."
      }
    ]
  },
  "KSI-RPL-04": {
    "description": "Regularly test the capability to recover from incidents and contingencies.",
    "justification": "Validates recovery testing by checking for recent, successful backup jobs, RDS point-in-time recovery (PITR) capability, and by parsing CloudWatch logs from the 'fedramp-backup-restore' Lambda to confirm successful automated test execution.",
    "cli_commands": [
      {
        "command": "aws backup list-backup-jobs --by-state COMPLETED --by-created-after $(date -u -d '30 days ago' +%Y-%m-%dT%H:%M:%SZ 2>/dev/null || date -u -v-30d +%Y-%m-%dT%H:%M:%SZ) --max-results 50 --output json",
        "note": "Validate recent backup jobs for recovery readiness"
      },
      {
        "command": "aws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier,LatestRestorableTime]' --output json",
        "note": "Check RDS latest restorable time for point-in-time recovery testing"
      },
      {
        "command": "aws lambda get-function --function-name fedramp-backup-restore --output json || echo '{\"Configuration\": null}'",
        "note": "Verify the automated recovery testing Lambda function exists."
      },
      {
        "command": "aws logs filter-log-events --log-group-name /aws/lambda/fedramp-backup-restore --filter-pattern '?\"Validation Summary:\" ?\"restore job(s) failed!\"' --start-time $(date -u -d '7 days ago' +%s000 2>/dev/null || date -u -v-7d +%s000) --output json",
        "note": "Get recent recovery test summary and failure logs from the Lambda."
      }
    ]
  },
  "KSI-SVC-01": {
    "description": "Implement improvements based on persistent evaluation of information resources for opportunities to improve security.",
    "justification": "Validates comprehensive system hardening from basic security groups to enterprise-grade patch management and automated configuration enforcement",
    "cli_commands": [
      {
        "command": "aws ec2 describe-security-groups --output json",
        "note": "Check security group configurations for system hardening"
      },
      {
        "command": "aws ec2 describe-instances --output json",
        "note": "Validate EC2 instances using hardened AMIs and configurations"
      },
      {
        "command": "aws ssm describe-instance-information --output json",
        "note": "Check SSM agent deployment for configuration management"
      },
      {
        "command": "aws ssm describe-patch-baselines --output json",
        "note": "Validate patch baselines for automated security updates"
      },
      {
        "command": "aws configservice describe-config-rules --output json",
        "note": "Check Config rules for continuous hardening compliance"
      },
      {
        "command": "aws ec2 describe-network-acls --output json",
        "note": "Validate network ACLs for defense-in-depth hardening"
      },
      {
        "command": "aws guardduty list-detectors --output json",
        "note": "Check GuardDuty for threat detection on hardened systems"
      },
      {
        "command": "aws wafv2 list-web-acls --scope REGIONAL --output json",
        "note": "Validate WAF rules for application-layer hardening"
      },
      {
        "command": "aws inspector2 get-configuration --output json",
        "note": "Check Inspector for vulnerability scanning of system images"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Validate organization-wide hardening policies and SCPs"
      },
      {
        "command": "aws ec2 describe-vpc-endpoints --output json",
        "note": "Check VPC endpoints for private connectivity and reduced attack surface"
      }
    ]
  },
  "KSI-SVC-02": {
    "description": "Encrypt or otherwise secure network traffic.",
    "justification": "Validates comprehensive encryption in transit from basic TLS to enterprise-grade certificate management and cryptographic compliance",
    "cli_commands": [
      {
        "command": "aws elbv2 describe-load-balancers --output json",
        "note": "Get Load Balancer ARNs needed for listener checks."
      },
      {
        "command": "for arn in $(aws elbv2 describe-load-balancers --query 'LoadBalancers[].LoadBalancerArn' --output text 2>/dev/null || echo ''); do aws elbv2 describe-listeners --load-balancer-arn $arn --output json; done",
        "note": "Check load balancer listeners for TLS 1.2+ enforcement (collects all listeners)."
      },
      {
        "command": "aws ec2 describe-vpc-endpoints --output json",
        "note": "Validate VPC endpoints using encrypted connections."
      },
      {
        "command": "aws cloudfront list-distributions --output json",
        "note": "Check CloudFront distributions for TLS 1.2+ minimum protocol."
      },
      {
        "command": "aws apigateway get-rest-apis --output json",
        "note": "Validate API Gateway TLS configurations (HTTPS is default)."
      },
      {
        "command": "aws rds describe-db-instances --output json",
        "note": "Check RDS instances for SSL/TLS enforcement parameters (indirect check)."
      },
      {
        "command": "aws elasticache describe-cache-clusters --output json",
        "note": "Validate ElastiCache encryption in transit."
      },
      {
        "command": "aws acm list-certificates --output json",
        "note": "Check ACM certificates for TLS 1.2+ support and validity."
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Validate organization-wide encryption in transit policies."
      }
    ]
  },
  "KSI-SVC-03": {
    "description": "Encrypt data at rest",
    "justification": "Validates comprehensive data at rest encryption from basic S3 encryption to enterprise-grade KMS key management and compliance",
    "cli_commands": [
      {
        "command": "aws s3api list-buckets --output json",
        "note": "Check S3 buckets for default encryption configurations"
      },
      {
        "command": "aws ec2 describe-volumes --output json",
        "note": "Validate EBS volume encryption at rest"
      },
      {
        "command": "aws rds describe-db-instances --output json",
        "note": "Check RDS database encryption at rest"
      },
      {
        "command": "aws rds describe-db-snapshots --output json",
        "note": "Validate RDS snapshot encryption"
      },
      {
        "command": "aws dynamodb list-tables --output json",
        "note": "Check DynamoDB tables for encryption at rest"
      },
      {
        "command": "aws elasticache describe-cache-clusters --output json",
        "note": "Validate ElastiCache encryption at rest"
      },
      {
        "command": "aws redshift describe-clusters --output json",
        "note": "Check Redshift cluster encryption"
      },
      {
        "command": "aws backup list-backup-vaults --output json",
        "note": "Validate AWS Backup vault encryption"
      },
      {
        "command": "aws kms list-keys --output json",
        "note": "Check KMS key usage for data encryption"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Validate organization-wide encryption at rest policies"
      }
    ]
  },
  "KSI-SVC-04": {
    "description": "Manage configuration of machine-based information resources using automation.",
    "justification": "Validates comprehensive configuration management from basic CloudFormation to enterprise-grade GitOps, policy enforcement, and automated compliance",
    "cli_commands": [
      {
        "command": "aws ssm describe-parameters --output json",
        "note": "Check SSM Parameter Store for centralized configuration management"
      },
      {
        "command": "aws configservice describe-configuration-recorders --output json",
        "note": "Validate AWS Config for configuration tracking and compliance"
      },
      {
        "command": "aws ssm list-documents --document-filter-list key=DocumentType,value=Automation --output json",
        "note": "Check SSM automation documents for configuration as code"
      },
      {
        "command": "aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE --output json",
        "note": "Validate CloudFormation stacks for infrastructure as code"
      },
      {
        "command": "aws secretsmanager list-secrets --output json",
        "note": "Check Secrets Manager for secure configuration storage"
      },
      {
        "command": "aws ssm describe-patch-baselines --output json",
        "note": "Validate patch baselines for configuration standardization"
      },
      {
        "command": "aws configservice describe-config-rules --output json",
        "note": "Check Config rules for automated configuration compliance"
      },
      {
        "command": "aws ssm describe-instance-information --output json",
        "note": "Validate SSM agent deployment for configuration management"
      },
      {
        "command": "aws servicecatalog search-products --output json",
        "note": "Check Service Catalog for standardized service configurations"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Validate organization-wide configuration management policies"
      }
    ]
  },
  "KSI-SVC-05": {
    "description": "Use cryptographic methods to validate the integrity of machine-based information resources.",
    "justification": "Validates comprehensive configuration monitoring from basic CloudTrail to enterprise-grade automated detection and response",
    "cli_commands": [
      {
        "command": "aws cloudtrail describe-trails --output json",
        "note": "Check CloudTrail for configuration change audit logging"
      },
      {
        "command": "aws kms list-keys --output json",
        "note": "Validate KMS encryption for secure log storage"
      },
      {
        "command": "aws kms list-aliases --output json",
        "note": "Check KMS key aliases for log encryption management"
      },
      {
        "command": "aws s3api list-buckets --output json",
        "note": "Validate S3 buckets for CloudTrail log storage"
      },
      {
        "command": "aws rds describe-db-instances --output json",
        "note": "Check RDS configuration change logging"
      },
      {
        "command": "aws configservice describe-configuration-recorders --output json",
        "note": "Validate Config recorders for continuous configuration monitoring"
      },
      {
        "command": "aws cloudwatch describe-alarms --output json",
        "note": "Check CloudWatch alarms for configuration change alerts"
      },
      {
        "command": "aws sns list-topics --output json",
        "note": "Validate SNS topics for configuration change notifications"
      },
      {
        "command": "aws backup list-backup-vaults --output json",
        "note": "Check backup configurations for disaster recovery"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Validate organization-wide configuration monitoring policies"
      }
    ]
  },
  "KSI-SVC-06": {
    "description": "Automate management, protection, and regular rotation of digital keys, certificates, and other secrets.",
    "justification": "Validates comprehensive key management from basic KMS to enterprise-grade certificate lifecycle, rotation, and cryptographic compliance",
    "cli_commands": [
      {
        "command": "aws kms list-keys --output json",
        "note": "Check KMS keys for centralized encryption key management"
      },
      {
        "command": "aws acm list-certificates --output json",
        "note": "Validate ACM certificates for centralized certificate management"
      },
      {
        "command": "aws kms list-aliases --output json",
        "note": "Check KMS key aliases for key organization and management"
      },
      {
        "command": "aws ssm describe-parameters --parameter-filters Key=Type,Values=SecureString --output json",
        "note": "Validate SSM SecureString parameters using KMS encryption"
      },
      {
        "command": "aws secretsmanager list-secrets --output json",
        "note": "Check Secrets Manager for KMS-encrypted secret storage"
      },
      {
        "command": "aws iam list-server-certificates --output json",
        "note": "Validate IAM server certificates and migration to ACM"
      },
      {
        "command": "aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE --output json",
        "note": "Check CloudFormation for infrastructure as code key management"
      },
      {
        "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=ResourceType,AttributeValue=AWS::KMS::Key --max-items 20 --output json",
        "note": "Validate CloudTrail audit logs for key usage and management"
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Check organization-wide centralized key management policies"
      }
    ]
  },
  "KSI-SVC-07": {
    "description": "Use a consistent, risk-informed approach for applying security patches.",
    "justification": "Validates comprehensive vulnerability management from basic patch baselines to enterprise-grade automated scanning, remediation, compliance monitoring, and governance.",
    "cli_commands": [
      {
        "command": "aws ssm describe-patch-baselines --output json",
        "note": "Check SSM patch baselines for vulnerability management."
      },
      {
        "command": "aws ssm describe-instance-information --output json",
        "note": "Validate SSM managed instances for patch compliance."
      },
      {
        "command": "aws ssm describe-patch-groups --output json",
        "note": "Check patch groups for organized vulnerability remediation."
      },
      {
        "command": "aws ssm list-documents --document-filter-list key=DocumentType,value=Automation --output json",
        "note": "Validate SSM automation for scheduled patch deployment."
      },
      {
        "command": "aws ssm describe-maintenance-windows --output json",
        "note": "Check maintenance windows for scheduled patching operations."
      },
      {
        "command": "aws inspector2 get-configuration --output json",
        "note": "Validate Inspector for continuous vulnerability scanning."
      },
      {
        "command": "aws ecr describe-repositories --output json",
        "note": "Check ECR repositories for container image vulnerability scanning."
      },
      {
        "command": "aws lambda list-layers --output json",
        "note": "Validate Lambda layers for serverless vulnerability management."
      },
      {
        "command": "aws configservice describe-config-rules --output json",
        "note": "Check Config Rules for patch compliance monitoring."
      },
      {
        "command": "aws organizations describe-organization --output json",
        "note": "Check organization-wide vulnerability management policies."
      }
    ]
  },
  "KSI-SVC-08": {
    "description": "Do not introduce or leave behind residual elements that could negatively affect confidentiality, integrity, or availability of federal customer data during operations.",
    "justification": "Validates a comprehensive IaC strategy by checking for: 1) Live IaC usage/management (Terraform .tfstate/.tfplan files in S3). 2) Automated security controls (Checkov/SARIF/automation artifacts).",
    "cli_commands": [
      {
        "command": "aws s3 ls s3://mks-states/ --recursive",
        "note": "Check S3 bucket for Terraform state files (.tfstate) as proof of IaC usage and plan files (.tfplan) as proof of a managed workflow."
      }
    ],
    "artifact_evidence_paths": [
      "evidence_v2/KSI-CMT-03/checkov_scan_summary.json",
      "evidence_v2/KSI-CMT-03/automated_testing_proof.json",
      "evidence_v2/KSI-CMT-03/sarif_metadata.json"
    ]
  },
  "KSI-SVC-09": {
    "description": "Persistently validate the authenticity and integrity of communications between machine-based information resources using automation.",
    "justification": "Validates the end-to-end use of modern, secure communication protocols (TLS 1.2+) across the infrastructure.",
    "cli_commands": [
      {
        "command": "aws acm list-certificates --output json",
        "note": "Check for valid, in-use ACM certificates."
      },
      {
        "command": "aws elbv2 describe-ssl-policies --output json",
        "note": "Get all available SSL policies for reference."
      },
      {
        "command": "for arn in $(aws elbv2 describe-load-balancers --query 'LoadBalancers[].LoadBalancerArn' --output text); do aws elbv2 describe-listeners --load-balancer-arn $arn --output json; done",
        "note": "CRITICAL: Check the SSL policies actively used by load balancer listeners."
      },
      {
        "command": "aws ec2 describe-vpc-endpoints --output json",
        "note": "Verify that internal traffic uses secure, private endpoints."
      },
      {
        "command": "aws cloudwatch describe-alarms --query 'MetricAlarms[?contains(AlarmDescription, `Certificate`) || contains(AlarmName, `SSL`)]' --output json",
        "note": "Check for specific alarms that monitor certificate expiry or TLS issues."
      },
      {
        "command": "aws lambda list-functions --query 'Functions[?contains(FunctionName, `cert`) || contains(FunctionName, `ssl`)]' --output json",
        "note": "Look for Lambda functions related to certificate rotation or lifecycle management."
      }
    ]
  },
  "KSI-SVC-10": {
    "description": "Remove unwanted federal customer data promptly when requested by an agency in alignment with customer agreements, including from backups if appropriate.",
    "justification": "Validates that automated data lifecycle and retention policies are in place across AWS Backup, S3, and CloudWatch Logs.",
    "cli_commands": [
      {
        "command": "aws backup list-backup-plans --output json",
        "note": "List ALL backup plans to validate data retention policies across all plans"
      },
      {
        "command": "aws backup list-backup-plans --output json | jq -r '.BackupPlansList[].BackupPlanId' | xargs -I {} aws backup get-backup-plan --backup-plan-id {} --output json | jq -s '.' || echo '[]'",
        "note": "Get details for ALL backup plans - validates deletion lifecycles and retention policies"
      },
      {
        "command": "for b in $(aws s3api list-buckets --query 'Buckets[].Name' --output text); do echo \"Bucket: $b\"; aws s3api get-bucket-lifecycle-configuration --bucket \"$b\" --output json 2>/dev/null || echo 'No lifecycle'; done",
        "note": "Check all S3 buckets for active lifecycle policies for data retention"
      },
      {
        "command": "aws logs describe-log-groups --output json",
        "note": "Verify that CloudWatch Log groups have retention policies configured"
      },
      {
        "command": "aws lambda list-functions --output json",
        "note": "Identify any custom Lambda functions used for automated data cleanup"
      }
    ]
  },
  "KSI-TPR-01": {
    "description": "Document the cloud service provider (CSP) in the system security policy",
    "justification": "Validates CSP documentation from basic AWS account details to enterprise-grade shared responsibility model and service integration policies",
    "cli_commands": [
      {
        "command": "aws lambda list-functions --query 'Functions[?contains(FunctionName, `policy`) || contains(FunctionName, `compliance`)]' --output json",
        "note": "Check for policy management Lambda functions"
      },
      {
        "command": "aws logs describe-log-groups --log-group-name-prefix '/aws/lambda/lms-policy' --output json",
        "note": "Validate policy service logging for documentation tracking"
      },
      {
        "command": "aws ssm get-parameter --name '/lms-compliance/policies' --output json || echo '{\"Parameter\": null}'",
        "note": "Check SSM Parameter Store for centralized policy storage"
      }
    ]
  },
  "KSI-TPR-03": {
    "description": "Identify and prioritize mitigation of potential supply chain risks.",
    "justification": "Validates the supply chain risk management policy's existence, its maintenance history, and the existence of a formal approval workflow.",
    "cli_commands": [
      {
        "command": "aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md",
        "note": "Retrieve the supply chain risk management policy from CodeCommit to verify its existence and size."
      },
      {
        "command": "aws codecommit list-approval-rule-templates --output json",
        "note": "Validate that a formal approval rule process is configured for the repository."
      },
      {
        "command": "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
        "note": "Check the commit history for an audit trail of recent policy updates."
      }
    ]
  },
  "KSI-TPR-04": {
    "description": "Automatically monitor third party software information resources for upstream vulnerabilities using mechanisms that may include contractual notification requirements or active monitoring services.",
    "justification": "Validates comprehensive vulnerability scanning from basic Inspector to enterprise-grade continuous scanning and automated remediation",
    "cli_commands": [
      {
        "command": "aws inspector2 get-configuration --output json",
        "note": "Check Inspector configuration for vulnerability scanning"
      },
      {
        "command": "aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"OPERATING_SYSTEM\"}]}' --max-results 50 --output json",
        "note": "Validate OS vulnerability findings from Inspector"
      },
      {
        "command": "aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"APPLICATION\"}]}' --max-results 50 --output json",
        "note": "Check application vulnerability findings from Inspector"
      },
      {
        "command": "aws inspector2 list-findings --filter-criteria '{\"findingStatus\":[{\"comparison\":\"EQUALS\",\"value\":\"ACTIVE\"}]}' --max-results 100 --output json",
        "note": "Validate active vulnerability findings requiring remediation"
      },
      {
        "command": "aws inspector2 list-coverage --filter-criteria '{\"resourceType\":[{\"comparison\":\"EQUALS\",\"value\":\"AWS_EC2_INSTANCE\"}]}' --max-results 100 --output json",
        "note": "Check Inspector coverage for EC2 instances"
      },
      {
        "command": "aws ssm describe-instance-information --output json",
        "note": "Validate SSM agent deployment for vulnerability management"
      }
    ]
  }
}




