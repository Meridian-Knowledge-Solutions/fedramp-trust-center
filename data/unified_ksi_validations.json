{
  "metadata": {
    "generated_at": "2025-12-29T08:22:43.908088Z",
    "total_ksis": 65,
    "passed": 54,
    "failed": 11,
    "pass_rate": "83.1%",
    "category_summary": {
      "KSI-AFR": {
        "total": 11,
        "passed": 10,
        "failed": 1,
        "long_name": "Authorization by FedRAMP"
      },
      "KSI-CED": {
        "total": 4,
        "passed": 4,
        "failed": 0,
        "long_name": "Cybersecurity Education"
      },
      "KSI-CMT": {
        "total": 4,
        "passed": 4,
        "failed": 0,
        "long_name": "Change Management"
      },
      "KSI-CNA": {
        "total": 8,
        "passed": 4,
        "failed": 4,
        "long_name": "Cloud Native Architecture"
      },
      "KSI-IAM": {
        "total": 7,
        "passed": 7,
        "failed": 0,
        "long_name": "Identity and Access Management"
      },
      "KSI-INR": {
        "total": 3,
        "passed": 3,
        "failed": 0,
        "long_name": "Incident Response"
      },
      "KSI-MLA": {
        "total": 5,
        "passed": 3,
        "failed": 2,
        "long_name": "Monitoring, Logging, and Auditing"
      },
      "KSI-PIY": {
        "total": 8,
        "passed": 8,
        "failed": 0,
        "long_name": "Policy and Inventory"
      },
      "KSI-RPL": {
        "total": 4,
        "passed": 0,
        "failed": 4,
        "long_name": "Recovery Planning"
      },
      "KSI-SVC": {
        "total": 9,
        "passed": 9,
        "failed": 0,
        "long_name": "Service Configuration Management"
      },
      "KSI-TPR": {
        "total": 2,
        "passed": 2,
        "failed": 0,
        "long_name": "Third-Party Information Resources"
      }
    }
  },
  "validations": [
    {
      "ksi_id": "KSI-AFR-01",
      "validation_id": "KSI-AFR-01",
      "assertion": true,
      "assertion_reason": "\u2705 Good (84%): 19 items: 16 verified, 3 failed",
      "recommended_action": "\u2705 Good compliance. Consider remediating 3 non-compliant resources to reach excellent status (\u226590%).",
      "requirement": "Validates the complete FedRAMP Minimum Assessment Scope (MAS). This rule enforces Structural Boundaries (VPC ID) for compute assets AND validates that all peripheral assets (S3, RDS, ALB) are accounted for in the inventory.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws ec2 describe-vpcs --filters Name=isDefault,Values=false --output json; aws ec2 describe-instances --filters Name=instance-state-name,Values=running --output json; aws rds describe-db-instances --query \"DBInstances[*].{ID:DBInstanceIdentifier, Engine:Engine, VPC:DBSubnetGroup.VpcId}\" --output json; aws s3api list-buckets --output json; aws elbv2 describe-load-balancers --query \"LoadBalancers[*].{ARN:LoadBalancerArn, DNS:DNSName, VPC:VpcId}\" --output json",
      "timestamp": "2025-12-29T08:22:43.907347Z",
      "score": 84,
      "evidence_path": "evidence_v2/KSI-AFR-01/ec2_081951_7386.json",
      "total_category_controls": 1,
      "resources_scanned": 19,
      "resources_passed": 16,
      "resources_failed": 3,
      "command_executions": [
        {
          "index": 0,
          "description": "BOUNDARY: Validate the dedicated Production VPC (The Structural Boundary of the MAS).",
          "command": "aws ec2 describe-vpcs --filters Name=isDefault,Values=false --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.07s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "COMPUTE: Validate that all active EC2 instances reside within the defined VPC Boundary.",
          "command": "aws ec2 describe-instances --filters Name=instance-state-name,Values=running --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.30s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "DATABASE: Validate RDS instances to ensure federal data is contained within the boundary.",
          "command": "aws rds describe-db-instances --query \"DBInstances[*].{ID:DBInstanceIdentifier, Engine:Engine, VPC:DBSubnetGroup.VpcId}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.98s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "STORAGE: Validate S3 buckets (Peripheral Assets) that fall within the assessment scope.",
          "command": "aws s3api list-buckets --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 4,
          "description": "NETWORK: Validate Load Balancers (The Ingress/Egress points of the boundary).",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[*].{ARN:LoadBalancerArn, DNS:DNSName, VPC:VpcId}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 5,
      "successful_commands": 5
    },
    {
      "ksi_id": "KSI-AFR-02",
      "validation_id": "KSI-AFR-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Set security goals and develop automated validation of status and progress.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/unified_ksi_validations.json --output json; aws securityhub describe-hub --output json",
      "timestamp": "2025-12-29T08:22:43.907374Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-02/s3api_081951_6282.json",
      "total_category_controls": 2,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "TRACKER: Validate existence and freshness of the Master Compliance Scorecard (unified_ksi_validations.json).",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/unified_ksi_validations.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "SOURCE: Validate Security Hub is enabled (The raw data source feeding the tracker).",
          "command": "aws securityhub describe-hub --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.89s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-03",
      "validation_id": "KSI-AFR-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Determine how authorization data will be shared in alignment with the ADS standard.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/meridian-authorization-package-LATEST.zip --output json; curl -s -o /dev/null -w \"%{http_code}\" https://7d7pdwb9t3.execute-api.us-east-1.amazonaws.com/prod/status || echo \"000\"",
      "timestamp": "2025-12-29T08:22:43.907387Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-03/s3api_081951_6384.json",
      "total_category_controls": 3,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "DELIVERABLE: Validate the existence of the downloadable Authorization Package ZIP file.",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/meridian-authorization-package-LATEST.zip --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "INTERFACE: Ping the Trust Center API to ensure the delivery mechanism is live.",
          "command": "curl -s -o /dev/null -w \"%{http_code}\" https://7d7pdwb9t3.execute-api.us-east-1.amazonaws.com/prod/status || echo \"000\"",
          "status": "success",
          "exit_code": 0,
          "execution_time": null,
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-04",
      "validation_id": "KSI-AFR-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Document the vulnerability detection and response methodology.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/assessed_vulnerabilities_integrated.json --output json; aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/vdr_vulnerability_status.json --output json; aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.907398Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-04/s3api_081951_9177.json",
      "total_category_controls": 4,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "DETECTION: Validate the Integrated Vulnerability Report artifact.",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/assessed_vulnerabilities_integrated.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "STATUS: Validate the VDR Status artifact (Proof of remediation tracking).",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/vdr_vulnerability_status.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "METHODOLOGY: Validate the Governance Policy defining the VDR process.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.96s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-AFR-05",
      "validation_id": "KSI-AFR-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Verify SCN procedures are documented and active change tracking is maintained.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')]\" --output json; aws s3api list-objects-v2 --bucket $(aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')].Name\" --output text | head -n 1) --prefix scn-flow-validation.html --output json; aws s3api list-objects-v2 --bucket $(aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')].Name\" --output text | head -n 1) --prefix audit_trail --output json",
      "timestamp": "2025-12-29T08:22:43.907407Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-05/s3api_081951_5836.json",
      "total_category_controls": 5,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "DROP BOX: Validate existence of the Compliance Evidence bucket.",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "PROCEDURE: Check for the 'scn-flow-validation.html' file.",
          "command": "aws s3api list-objects-v2 --bucket $(aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')].Name\" --output text | head -n 1) --prefix scn-flow-validation.html --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.67s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "LOGS: Check for the SCN Audit Trail file.",
          "command": "aws s3api list-objects-v2 --bucket $(aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')].Name\" --output text | head -n 1) --prefix audit_trail --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.65s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-AFR-06",
      "validation_id": "KSI-AFR-06",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Maintain a plan and process for providing Ongoing Authorization Reports and Quarterly Reviews.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/3pao_audit_report.json --output json; curl -s -o /dev/null -w \"%{http_code}\" https://meridian-knowledge-solutions.github.io/fedramp-trust-center/ || echo \"000\"",
      "timestamp": "2025-12-29T08:22:43.907418Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-06/s3api_081951_6092.json",
      "total_category_controls": 6,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "INDEPENDENT REVIEW: Validate the 3PAO Audit Report artifact.",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/3pao_audit_report.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "AVAILABILITY: Ping the Trust Center Portal (The delivery vehicle for these reports).",
          "command": "curl -s -o /dev/null -w \"%{http_code}\" https://meridian-knowledge-solutions.github.io/fedramp-trust-center/ || echo \"000\"",
          "status": "success",
          "exit_code": 0,
          "execution_time": null,
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-07",
      "validation_id": "KSI-AFR-07",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (0%): No resources found matching validation criteria",
      "recommended_action": "ACTION: Deploy required resources in infrastructure. This is an infrastructure gap, not an automation failure. Review FedRAMP requirements and provision necessary resources.",
      "requirement": "Document the secure configuration baseline for the cloud service offering.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "curl -s https://7d7pdwb9t3.execute-api.us-east-1.amazonaws.com/prod/config | head -n 20",
      "timestamp": "2025-12-29T08:22:43.907425Z",
      "score": 0,
      "evidence_path": "",
      "total_category_controls": 7,
      "resources_scanned": 0,
      "resources_passed": 0,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "DYNAMIC RETRIEVAL: Fetch the first 20 lines of the Security Baseline from the live API. This proves the configuration standards are documented and programmatically accessible.",
          "command": "curl -s https://7d7pdwb9t3.execute-api.us-east-1.amazonaws.com/prod/config | head -n 20",
          "status": "success",
          "exit_code": 0,
          "execution_time": null,
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-AFR-08",
      "validation_id": "KSI-AFR-08",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Operate a secure inbox to receive critical communication from FedRAMP and other government entities.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path procedures/security-inbox-procedures.md --output json; aws sns list-topics --query \"Topics[?contains(TopicArn, 'security') || contains(TopicArn, 'alert') || contains(TopicArn, 'admin')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907463Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-08/codecommit_081951_1930.json",
      "total_category_controls": 8,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the existence of the Security Inbox Procedures document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/security-inbox-procedures.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.12s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "INFRASTRUCTURE: Validate existence of an SNS Topic used to forward AWS alerts to the security inbox.",
          "command": "aws sns list-topics --query \"Topics[?contains(TopicArn, 'security') || contains(TopicArn, 'alert') || contains(TopicArn, 'admin')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-09",
      "validation_id": "KSI-AFR-09",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently validate security posture using automated pipelines.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/fedramp-phase2-validation-architecture.mmd --output json; aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/unified_ksi_validations.json --output json",
      "timestamp": "2025-12-29T08:22:43.907477Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-09/codecommit_081951_7944.json",
      "total_category_controls": 9,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "ARCHITECTURE: Validate the existence of the Validation Architecture Diagram.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/fedramp-phase2-validation-architecture.mmd --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.93s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "EXECUTION: Validate existence (and freshness) of the Master Validation artifact in the production compliance bucket.",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/unified_ksi_validations.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-10",
      "validation_id": "KSI-AFR-10",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 6 items: 6 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Integrate FedRAMP's Incident Communications Procedures (ICP) into incident response procedures and infrastructure.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path procedures/icp_playbook.md --output json; aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json; aws sns list-topics --query \"Topics[?contains(TopicArn, 'security') || contains(TopicArn, 'incident') || contains(TopicArn, 'alert')]\" --output json; aws sns list-subscriptions --query \"Subscriptions[?contains(TopicArn, 'security') || contains(TopicArn, 'incident') || contains(TopicArn, 'alert')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907489Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-10/codecommit_081951_4343.json",
      "total_category_controls": 10,
      "resources_scanned": 6,
      "resources_passed": 6,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the FedRAMP Incident Communications Procedure (ICP) Playbook.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/icp_playbook.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.93s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "GOVERNANCE: Validate the master Incident Response Plan.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.00s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "INFRASTRUCTURE: Validate existence of dedicated SNS topics for Security Incidents.",
          "command": "aws sns list-topics --query \"Topics[?contains(TopicArn, 'security') || contains(TopicArn, 'incident') || contains(TopicArn, 'alert')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "REACHABILITY: Validate that the security topics have active subscriptions (email/SMS/Lambda) to ensure alerts are actually delivered.",
          "command": "aws sns list-subscriptions --query \"Subscriptions[?contains(TopicArn, 'security') || contains(TopicArn, 'incident') || contains(TopicArn, 'alert')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.95s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-AFR-11",
      "validation_id": "KSI-AFR-11",
      "assertion": true,
      "assertion_reason": "\u2705 Good (88%): 9 items: 8 verified, 1 failed",
      "recommended_action": "\u2705 Good compliance. Consider remediating 1 non-compliant resource to reach excellent status (\u226590%).",
      "requirement": "Ensure that cryptographic modules are selected and used in alignment with the FedRAMP 20x Using Cryptographic Modules (UCM) policy.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws kms list-keys --limit 5 --output json; aws s3api get-bucket-encryption --bucket fedramp-compliance-893894210484 --output json; aws rds describe-db-instances --query \"DBInstances[*].{ID:DBInstanceIdentifier, Encrypted:StorageEncrypted}\" --output json; aws elbv2 describe-listeners --load-balancer-arn $(aws elbv2 describe-load-balancers --query \"LoadBalancers[0].LoadBalancerArn\" --output text) --output json || echo \"[]\"; aws codecommit get-file --repository-name security-governance --file-path policies/cryptographic-modules-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.907503Z",
      "score": 88,
      "evidence_path": "evidence_v2/KSI-AFR-11/kms_081951_3991.json",
      "total_category_controls": 11,
      "resources_scanned": 9,
      "resources_passed": 8,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "KEY MANAGEMENT: Validate that KMS keys exist and are available for cryptographic operations.",
          "command": "aws kms list-keys --limit 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "DATA AT REST (STORAGE): Validate that the Compliance Artifact Bucket enforces server-side encryption (SSE-S3 or SSE-KMS).",
          "command": "aws s3api get-bucket-encryption --bucket fedramp-compliance-893894210484 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "DATA AT REST (DATABASE): Validate that all RDS instances have 'StorageEncrypted' set to true.",
          "command": "aws rds describe-db-instances --query \"DBInstances[*].{ID:DBInstanceIdentifier, Encrypted:StorageEncrypted}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.99s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "DATA IN TRANSIT: Validate that Load Balancer Listeners are configured with secure SSL Policies (TLS 1.2+).",
          "command": "aws elbv2 describe-listeners --load-balancer-arn $(aws elbv2 describe-load-balancers --query \"LoadBalancers[0].LoadBalancerArn\" --output text) --output json || echo \"[]\"",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.76s",
          "error_message": null
        },
        {
          "index": 4,
          "description": "GOVERNANCE: Validate the existence of the Cryptographic Modules (UCM) Policy.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/cryptographic-modules-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        }
      ],
      "commands_executed": 5,
      "successful_commands": 5
    },
    {
      "ksi_id": "KSI-CED-01",
      "validation_id": "KSI-CED-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Require and monitor the effectiveness of training given to all employees on policies, procedures, and security-related topics.",
      "long_name": "Cybersecurity Education",
      "category_prefix": "KSI-CED",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path training/register.json --output json; aws codecommit get-file --repository-name security-governance --file-path training/security-refresh.md --output json",
      "timestamp": "2025-12-29T08:22:43.907513Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CED-01/codecommit_081951_558.json",
      "total_category_controls": 1,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVIDENCE: Validate the Training Register. The file must contain user commits with the correct decoded flag, proving active engagement.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/register.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.07s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CURRICULUM: Validate the existence of the Training Challenge Instructions (The 'Lesson Plan').",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/security-refresh.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.05s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CED-02",
      "validation_id": "KSI-CED-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Require and monitor the effectiveness of role-specific training for high risk roles, including at least roles with privileged access.",
      "long_name": "Cybersecurity Education",
      "category_prefix": "KSI-CED",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path training/privileged_register.json --output json; aws codecommit get-file --repository-name security-governance --file-path training/privileged-access-guide.md --output json",
      "timestamp": "2025-12-29T08:22:43.907522Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CED-02/codecommit_081951_659.json",
      "total_category_controls": 2,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVIDENCE: Validate the Privileged User Training Register. Entries here confirm acknowledgement of high-risk responsibilities and completion of the IAM Deep Dive.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/privileged_register.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.02s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CURRICULUM: Validate the existence of the Privileged Access Guide containing the link to the mandatory AWS Skill Builder IAM course.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/privileged-access-guide.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.01s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CED-03",
      "validation_id": "KSI-CED-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Require and monitor the effectiveness of role-specific training provided to development and engineering staff that covers best practices for delivering secure software.",
      "long_name": "Cybersecurity Education",
      "category_prefix": "KSI-CED",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path training/developer_register.json --output json; aws codecommit get-file --repository-name security-governance --file-path policies/secure-software-development.md --output json",
      "timestamp": "2025-12-29T08:22:43.907530Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CED-03/codecommit_081951_4154.json",
      "total_category_controls": 3,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVIDENCE: Validate the Developer Training Register. Entries here confirm engineering staff have acknowledged the secure software development policy.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/developer_register.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CURRICULUM: Validate the existence of the Secure Software Development policy.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/secure-software-development.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.95s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CED-04",
      "validation_id": "KSI-CED-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Require and monitor the effectiveness of role-specific training to staff involved with incident response or disaster recovery.",
      "long_name": "Cybersecurity Education",
      "category_prefix": "KSI-CED",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path training/ir_dr_register.json --output json; aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json",
      "timestamp": "2025-12-29T08:22:43.907538Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CED-04/codecommit_081951_1945.json",
      "total_category_controls": 4,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVIDENCE: Validate the IR/DR Training Register. Entries here confirm the IR team has reviewed the active response procedures.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/ir_dr_register.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CURRICULUM: Validate the existence of the Incident Response Plan (The core training material).",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.94s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CMT-01",
      "validation_id": "KSI-CMT-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Log and monitor modifications to the cloud service offering.",
      "long_name": "Change Management",
      "category_prefix": "KSI-CMT",
      "cli_command": "aws cloudtrail describe-trails --output json; aws cloudtrail get-event-selectors --trail-name $(aws cloudtrail describe-trails --query 'trailList[0].TrailARN' --output text) --output json; aws configservice describe-configuration-recorder-status --output json; aws codecommit get-file --repository-name security-governance --file-path policies/change-management-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.907548Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CMT-01/cloudtrail_081951_6885.json",
      "total_category_controls": 1,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "AUDIT: Validate existence of CloudTrail trails (The primary change logger).",
          "command": "aws cloudtrail describe-trails --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "SCOPE: Validate that the trail is recording 'Management Events' (Read/Write API calls).",
          "command": "aws cloudtrail get-event-selectors --trail-name $(aws cloudtrail describe-trails --query 'trailList[0].TrailARN' --output text) --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.74s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "TRACKING: Validate that AWS Config is actively recording resource changes (Recording: true).",
          "command": "aws configservice describe-configuration-recorder-status --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.89s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "GOVERNANCE: Validate the Change Management Policy document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/change-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.95s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-CMT-02",
      "validation_id": "KSI-CMT-02",
      "assertion": true,
      "assertion_reason": "\u2705 Good (85%): 7 items: 6 verified, 1 failed",
      "recommended_action": "\u2705 Good compliance. Consider remediating 1 non-compliant resource to reach excellent status (\u226590%).",
      "requirement": "Execute changes though redeployment of version controlled immutable resources rather than direct modification wherever possible",
      "long_name": "Change Management",
      "category_prefix": "KSI-CMT",
      "cli_command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'terraform') || contains(Name, 'state') || contains(Name, 'tfstate')]\" --output json; aws dynamodb list-tables --query \"TableNames[?contains(@, 'terraform') || contains(@, 'lock') || contains(@, 'state')]\" --output json; aws ec2 describe-instances --filters Name=instance-state-name,Values=running --output json; aws codecommit get-file --repository-name security-governance --file-path policies/configuration-management-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.907558Z",
      "score": 85,
      "evidence_path": "evidence_v2/KSI-CMT-02/ec2_081951_6522.json",
      "total_category_controls": 2,
      "resources_scanned": 7,
      "resources_passed": 6,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "VERSION CONTROL: Validate existence of the Terraform State bucket (Proof that infrastructure is defined as code).",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'terraform') || contains(Name, 'state') || contains(Name, 'tfstate')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "MANAGEMENT: Validate existence of the Terraform Lock Table (Proof of active, safe IaC workflows).",
          "command": "aws dynamodb list-tables --query \"TableNames[?contains(@, 'terraform') || contains(@, 'lock') || contains(@, 'state')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "INVENTORY: List the active EC2 instances managed by this Terraform state.",
          "command": "aws ec2 describe-instances --filters Name=instance-state-name,Values=running --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.25s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "GOVERNANCE: Validate the policy that mandates Terraform usage for all production changes.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/configuration-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.02s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-CMT-03",
      "validation_id": "KSI-CMT-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Automate persistent testing and validation of changes throughout deployment.",
      "long_name": "Change Management",
      "category_prefix": "KSI-CMT",
      "cli_command": "aws configservice describe-configuration-recorder-status --output json; aws configservice describe-config-rules --query \"ConfigRules[?RuleState=='ACTIVE']\" --max-items 5 --output json; aws codecommit get-file --repository-name security-governance --file-path policies/sdlc-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.907567Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CMT-03/configservice_081951_2530.json",
      "total_category_controls": 3,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "MONITOR: Validate that the Configuration Recorder is recording (The engine for persistent validation).",
          "command": "aws configservice describe-configuration-recorder-status --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.94s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "VALIDATION: Validate existence of active Config Rules that enforce security policies on live resources.",
          "command": "aws configservice describe-config-rules --query \"ConfigRules[?RuleState=='ACTIVE']\" --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "GOVERNANCE: Validate the SDLC Policy which mandates 'Automated Testing' (Checkov) before deployment.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/sdlc-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.97s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CMT-04",
      "validation_id": "KSI-CMT-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Always follow a documented change management procedure.",
      "long_name": "Change Management",
      "category_prefix": "KSI-CMT",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path procedures/change-management-procedure.md --output json; aws s3api list-object-versions --bucket mks-states --prefix terraform.tfstate --max-items 5 --output json",
      "timestamp": "2025-12-29T08:22:43.907576Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CMT-04/codecommit_081951_3900.json",
      "total_category_controls": 4,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the existence of the Change Management Procedure document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/change-management-procedure.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.97s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "EVIDENCE: List versions of the Terraform State file. This provides an audit trail of every successful 'terraform apply' operation, proving changes are tracked.",
          "command": "aws s3api list-object-versions --bucket mks-states --prefix terraform.tfstate --max-items 5 --output json",
          "status": "failed",
          "exit_code": 254,
          "execution_time": "0.82s",
          "error_message": "\nAn error occurred (AccessDenied) when calling the ListObjectVersions operation: User: arn:aws:sts::893894210484:assumed-role/githubactions_role/Github_to_AWS_Federated is not authorized to perform: s"
        }
      ],
      "commands_executed": 2,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-CNA-01",
      "validation_id": "KSI-CNA-01",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (71%): 7 items: 5 verified, 2 failed",
      "recommended_action": "ACTION: Remediate 2 non-compliant resources. Review resource configurations against FedRAMP requirements. Current compliance: 71% (Target: \u226580%)",
      "requirement": "Configure all machine-based information resources to limit inbound and outbound network traffic.",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws ec2 describe-security-groups --filters Name=group-name,Values=default --output json; aws ec2 describe-security-groups --filters Name=ip-permission.protocol,Values=tcp --max-items 5 --output json; aws ec2 describe-network-acls --max-items 5 --output json",
      "timestamp": "2025-12-29T08:22:43.907588Z",
      "score": 71,
      "evidence_path": "evidence_v2/KSI-CNA-01/ec2_081951_7897.json",
      "total_category_controls": 1,
      "resources_scanned": 7,
      "resources_passed": 5,
      "resources_failed": 2,
      "command_executions": [
        {
          "index": 0,
          "description": "BASELINE: Validate that the 'default' VPC Security Group restricts all traffic (Best practice is to leave this empty/unused).",
          "command": "aws ec2 describe-security-groups --filters Name=group-name,Values=default --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.15s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "ACTIVE CONTROLS: Validate a sample of active Security Groups to verify specific port restrictions (Limit Inbound).",
          "command": "aws ec2 describe-security-groups --filters Name=ip-permission.protocol,Values=tcp --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.17s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "BOUNDARY: Validate Network ACLs which provide a stateless traffic filter at the subnet level.",
          "command": "aws ec2 describe-network-acls --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.08s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-02",
      "validation_id": "KSI-CNA-02",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (59%): 22 items: 13 verified, 9 failed",
      "recommended_action": "ACTION: Remediate 9 non-compliant resources. Review resource configurations against FedRAMP requirements. Current compliance: 59% (Target: \u226580%)",
      "requirement": "Design systems to minimize the attack surface and minimize lateral movement if compromised.",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws ec2 describe-subnets --filters \"Name=map-public-ip-on-launch,Values=false\" --query \"Subnets[].{ID:SubnetId, CIDR:CidrBlock, Zone:AvailabilityZone}\" --max-items 5 --output json; aws ec2 describe-security-groups --max-items 20 --output json; aws rds describe-db-instances --query \"DBInstances[].{ID:DBInstanceIdentifier, Public:PubliclyAccessible, Subnets:DBSubnetGroup.Subnets[].SubnetIdentifier}\" --output json",
      "timestamp": "2025-12-29T08:22:43.907601Z",
      "score": 59,
      "evidence_path": "evidence_v2/KSI-CNA-02/ec2_081951_5646.json",
      "total_category_controls": 2,
      "resources_scanned": 22,
      "resources_passed": 13,
      "resources_failed": 9,
      "command_executions": [
        {
          "index": 0,
          "description": "ATTACK SURFACE: Validate the existence of Private Subnets (where Public IP mapping is disabled).",
          "command": "aws ec2 describe-subnets --filters \"Name=map-public-ip-on-launch,Values=false\" --query \"Subnets[].{ID:SubnetId, CIDR:CidrBlock, Zone:AvailabilityZone}\" --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.13s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "LATERAL MOVEMENT: Validate Security Groups that allow access ONLY from other specific Security Groups (Tiered Security), rather than broad IP ranges.",
          "command": "aws ec2 describe-security-groups --max-items 20 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.17s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "ISOLATION: Validate that RDS Databases are configured as 'PubliclyAccessible: false' and reside in defined subnets.",
          "command": "aws rds describe-db-instances --query \"DBInstances[].{ID:DBInstanceIdentifier, Public:PubliclyAccessible, Subnets:DBSubnetGroup.Subnets[].SubnetIdentifier}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.99s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-03",
      "validation_id": "KSI-CNA-03",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (11%): 9 items: 1 verified, 8 failed",
      "recommended_action": "ACTION: Remediate 8 non-compliant resources. Review resource configurations against FedRAMP requirements. Current compliance: 11% (Target: \u226580%)",
      "requirement": "Use logical networking and related capabilities to enforce traffic flow controls.",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws ec2 describe-vpc-endpoints --query \"VpcEndpoints[].{ID:VpcEndpointId, Service:ServiceName, Type:VpcEndpointType, State:State}\" --output json; aws ec2 describe-nat-gateways --filter Name=state,Values=available --output json; aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, Scheme:Scheme, DNS:DNSName}\" --output json",
      "timestamp": "2025-12-29T08:22:43.907614Z",
      "score": 11,
      "evidence_path": "evidence_v2/KSI-CNA-03/ec2_081951_6576.json",
      "total_category_controls": 3,
      "resources_scanned": 9,
      "resources_passed": 1,
      "resources_failed": 8,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIVATE FLOW: Validate existence of VPC Endpoints, ensuring traffic to services like S3/DynamoDB bypasses the public internet.",
          "command": "aws ec2 describe-vpc-endpoints --query \"VpcEndpoints[].{ID:VpcEndpointId, Service:ServiceName, Type:VpcEndpointType, State:State}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.11s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "EGRESS CONTROL: Validate active NAT Gateways. This proves instances in private subnets route outbound traffic centrally, rather than having individual Public IPs.",
          "command": "aws ec2 describe-nat-gateways --filter Name=state,Values=available --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.03s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "INGRESS CONTROL: Validate Load Balancers. The 'Scheme' (internet-facing vs internal) proves that ingress traffic is logically separated and managed.",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, Scheme:Scheme, DNS:DNSName}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-04",
      "validation_id": "KSI-CNA-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 71 items: 71 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use immutable infrastructure with strictly defined functionality and privileges by default.",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws s3api list-object-versions --bucket mks-states --prefix terraform.tfstate --max-items 5 --output json; aws ec2 describe-security-groups --filters Name=ip-permission.protocol,Values=-1 --output json; aws iam list-roles --query \"Roles[?!(contains(RoleName, 'AWSServiceRole') || contains(Path, '/aws-service-role/'))]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907632Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CNA-04/ec2_081951_1826.json",
      "total_category_controls": 4,
      "resources_scanned": 71,
      "resources_passed": 71,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "IMMUTABILITY: List Terraform State versions. Frequent state updates prove that infrastructure is managed/replaced via code, not manual changes.",
          "command": "aws s3api list-object-versions --bucket mks-states --prefix terraform.tfstate --max-items 5 --output json",
          "status": "failed",
          "exit_code": 254,
          "execution_time": "0.89s",
          "error_message": "\nAn error occurred (AccessDenied) when calling the ListObjectVersions operation: User: arn:aws:sts::893894210484:assumed-role/githubactions_role/Github_to_AWS_Federated is not authorized to perform: s"
        },
        {
          "index": 1,
          "description": "FUNCTIONALITY: Check for Security Groups allowing 'All Traffic' (-1). Absence of these proves strictly defined network functionality.",
          "command": "aws ec2 describe-security-groups --filters Name=ip-permission.protocol,Values=-1 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.08s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "PRIVILEGE: Audit Custom IAM Roles. This focuses the scan on roles you created, verifying they follow least-privilege principles.",
          "command": "aws iam list-roles --query \"Roles[?!(contains(RoleName, 'AWSServiceRole') || contains(Path, '/aws-service-role/'))]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.04s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CNA-05",
      "validation_id": "KSI-CNA-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Deploy effective spam, spoofing, and denial-of-service countermeasures.",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws wafv2 list-web-acls --scope REGIONAL --output json; aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, DNS:DNSName, Shield: 'Enabled (Standard)'}\" --output json; aws route53 list-hosted-zones --max-items 5 --output json; aws ses list-identities --max-items 5 --output json",
      "timestamp": "2025-12-29T08:22:43.907641Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CNA-05/wafv2_081951_6552.json",
      "total_category_controls": 5,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "DDOS LAYER 7: Validate existence of Web Application Firewalls (WAF) to block malicious requests.",
          "command": "aws wafv2 list-web-acls --scope REGIONAL --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "DDOS LAYER 3/4: Validate Load Balancers. All ALBs act as the perimeter and automatically benefit from AWS Shield Standard.",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, DNS:DNSName, Shield: 'Enabled (Standard)'}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "DNS RESILIENCE: Validate Route53 usage (AWS AnyCast network provides DNS flood protection).",
          "command": "aws route53 list-hosted-zones --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.94s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "SPOOFING: Validate SES Identities. If email is sent, this checks for authorized identities (DKIM/SPF managed).",
          "command": "aws ses list-identities --max-items 5 --output json",
          "status": "failed",
          "exit_code": 254,
          "execution_time": "0.83s",
          "error_message": "\nAn error occurred (AccessDenied) when calling the ListIdentities operation: User: arn:aws:sts::893894210484:assumed-role/githubactions_role/Github_to_AWS_Federated is not authorized to perform: ses:L"
        }
      ],
      "commands_executed": 4,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-06",
      "validation_id": "KSI-CNA-06",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (0%): 4 items: 4 failed",
      "recommended_action": "ACTION: Remediate 4 non-compliant resources. Review resource configurations against FedRAMP requirements. Current compliance: 0% (Target: \u226580%)",
      "requirement": "Design systems for high availability and rapid recovery.",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, AZs:AvailabilityZones[].ZoneName}\" --output json; aws rds describe-db-instances --query \"DBInstances[].{ID:DBInstanceIdentifier, MultiAZ:MultiAZ, SecondaryZone:SecondaryAvailabilityZone}\" --output json; aws backup list-backup-plans --output json",
      "timestamp": "2025-12-29T08:22:43.907652Z",
      "score": 0,
      "evidence_path": "evidence_v2/KSI-CNA-06/elbv2_081951_4192.json",
      "total_category_controls": 6,
      "resources_scanned": 4,
      "resources_passed": 0,
      "resources_failed": 4,
      "command_executions": [
        {
          "index": 0,
          "description": "NETWORK HA: Validate that Load Balancers are configured across multiple Availability Zones.",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, AZs:AvailabilityZones[].ZoneName}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "DATABASE HA: Validate that critical RDS instances have Multi-AZ enabled for automatic failover.",
          "command": "aws rds describe-db-instances --query \"DBInstances[].{ID:DBInstanceIdentifier, MultiAZ:MultiAZ, SecondaryZone:SecondaryAvailabilityZone}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.99s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "RECOVERY: Validate existence of Backup Plans to support rapid data recovery.",
          "command": "aws backup list-backup-plans --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-07",
      "validation_id": "KSI-CNA-07",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (97%): 34 items: 33 verified, 1 failed",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Maximize use of managed services and cloud resources",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws ec2 describe-instances --output json; aws lambda list-functions --output json; aws rds describe-db-instances --output json; aws apigateway get-rest-apis --output json; aws elbv2 describe-load-balancers --output json; aws autoscaling describe-auto-scaling-groups --output json",
      "timestamp": "2025-12-29T08:22:43.907667Z",
      "score": 97,
      "evidence_path": "evidence_v2/KSI-CNA-07/ec2_081951_7057.json",
      "total_category_controls": 7,
      "resources_scanned": 34,
      "resources_passed": 33,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "BASELINE: Measure legacy compute footprint (Denominator) to compare against managed service adoption.",
          "command": "aws ec2 describe-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.41s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "ACCELERATOR: Validate adoption of serverless compute (High Impact).",
          "command": "aws lambda list-functions --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.16s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "ACCELERATOR: Validate use of fully managed databases vs self-hosted DBs.",
          "command": "aws rds describe-db-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.05s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "ACCELERATOR: Validate use of managed API hosting infrastructure.",
          "command": "aws apigateway get-rest-apis --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.94s",
          "error_message": null
        },
        {
          "index": 4,
          "description": "ACCELERATOR: Validate use of managed application networking.",
          "command": "aws elbv2 describe-load-balancers --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 5,
          "description": "ACCELERATOR: Validate use of dynamic scaling/statelessness vs static servers.",
          "command": "aws autoscaling describe-auto-scaling-groups --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        }
      ],
      "commands_executed": 6,
      "successful_commands": 6
    },
    {
      "ksi_id": "KSI-CNA-08",
      "validation_id": "KSI-CNA-08",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 33 items: 33 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use automated services to persistently assess the security posture of all machine-based information resources and automatically enforce their intended operational state.",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws securityhub get-enabled-standards --output json; aws guardduty list-detectors --output json; aws configservice describe-configuration-recorders --output json; aws inspector2 list-coverage --output json",
      "timestamp": "2025-12-29T08:22:43.907681Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CNA-08/securityhub_081951_9559.json",
      "total_category_controls": 8,
      "resources_scanned": 33,
      "resources_passed": 33,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate that Security Hub is active and enforcing specific compliance standards (CIS, PCI, etc).",
          "command": "aws securityhub get-enabled-standards --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.12s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate that GuardDuty is enabled (Detector ID exists) for automated threat detection.",
          "command": "aws guardduty list-detectors --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Validate that AWS Config is actively recording resource changes for persistent assessment.",
          "command": "aws configservice describe-configuration-recorders --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "Validate that Amazon Inspector is actively scanning resources (EC2/ECR/Lambda).",
          "command": "aws inspector2 list-coverage --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.17s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-IAM-01",
      "validation_id": "KSI-IAM-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Enforce multi-factor authentication (MFA) using methods that are difficult to intercept or impersonate (phishing-resistant MFA) for all user authentication.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws iam list-users --query \"Users[?PasswordLastUsed!=null]\" --output json; aws sso-admin list-instances --output json; aws iam list-virtual-mfa-devices --output json",
      "timestamp": "2025-12-29T08:22:43.907691Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-01/ssoadmin_081951_4134.json",
      "total_category_controls": 1,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "FILTERED: Retrieve only IAM Users who have active password usage (Humans).",
          "command": "aws iam list-users --query \"Users[?PasswordLastUsed!=null]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Verify that AWS Identity Center is the primary identity platform.",
          "command": "aws sso-admin list-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Get list of all Virtual MFA devices to validate protection (replaces list-mfa-devices which requires user).",
          "command": "aws iam list-virtual-mfa-devices --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-IAM-02",
      "validation_id": "KSI-IAM-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use secure passwordless methods for user authentication and authorization when feasible, otherwise enforce strong passwords with MFA.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws sso-admin list-instances --output json; aws iam list-saml-providers --output json; aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": null}'",
      "timestamp": "2025-12-29T08:22:43.907700Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-02/ssoadmin_081951_4134.json",
      "total_category_controls": 2,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "MODERN: Validate presence of AWS Identity Center (Single Sign-On).",
          "command": "aws sso-admin list-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "LEGACY/FEDERATED: Validate presence of external Identity Providers (Okta, Azure AD).",
          "command": "aws iam list-saml-providers --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "FALLBACK: Validate that if passwords ARE used, the policy enforces complexity and rotation.",
          "command": "aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": null}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-IAM-03",
      "validation_id": "KSI-IAM-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 71 items: 71 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Enforce appropriately secure authentication methods for non-user accounts and services.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws iam list-roles --query \"Roles[?!(contains(RoleName, 'AWSServiceRole') || contains(Path, '/aws-service-role/'))]\" --output json; aws iam list-users --query \"Users[?PasswordLastUsed==null]\" --output json; aws iam get-credential-report --output text > /dev/null && aws iam get-credential-report --output json || echo '{\"Content\": \"Permission Denied\"}'",
      "timestamp": "2025-12-29T08:22:43.907720Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-03/iam_081951_2135.json",
      "total_category_controls": 3,
      "resources_scanned": 71,
      "resources_passed": 71,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate Trust Policies for CUSTOMER managed roles only.",
          "command": "aws iam list-roles --query \"Roles[?!(contains(RoleName, 'AWSServiceRole') || contains(Path, '/aws-service-role/'))]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.08s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate Service Accounts (Bots) that do not have console access (should rely on keys/roles).",
          "command": "aws iam list-users --query \"Users[?PasswordLastUsed==null]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.89s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Deep inspection of access key rotation status for service accounts.",
          "command": "aws iam get-credential-report --output text > /dev/null && aws iam get-credential-report --output json || echo '{\"Content\": \"Permission Denied\"}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.87s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-IAM-04",
      "validation_id": "KSI-IAM-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Require a centralized identity management system.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws sso-admin list-instances --output json; aws iam list-users --query \"Users[?PasswordLastUsed!=null]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907728Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-04/ssoadmin_081951_4134.json",
      "total_category_controls": 4,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate that AWS Identity Center (SSO) is configured and running.",
          "command": "aws sso-admin list-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "AUDIT: List human users who are bypassing the Centralized System (should be empty or minimal).",
          "command": "aws iam list-users --query \"Users[?PasswordLastUsed!=null]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-IAM-05",
      "validation_id": "KSI-IAM-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Require phishing-resistant MFA (FIDO2/WebAuthn) for all user authentication.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws sso-admin list-instances --output json; aws iam list-virtual-mfa-devices --output json; aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": null}'",
      "timestamp": "2025-12-29T08:22:43.907737Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-05/ssoadmin_081951_4134.json",
      "total_category_controls": 5,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate Identity Center configuration for WebAuthn/FIDO2 enforcement.",
          "command": "aws sso-admin list-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "AUDIT: Inventory MFA devices to identify non-FIDO compliant virtual tokens.",
          "command": "aws iam list-virtual-mfa-devices --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Validate that hard-fail measures are in place if MFA is missing.",
          "command": "aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": null}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-IAM-06",
      "validation_id": "KSI-IAM-06",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Automatically disable or otherwise secure accounts with privileged access in response to suspicious activity",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws guardduty list-detectors --output json; aws events list-rules --name-prefix GuardDuty --output json",
      "timestamp": "2025-12-29T08:22:43.907745Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-06/guardduty_081951_7432.json",
      "total_category_controls": 6,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "SENSOR: Validate that the Threat Detection sensor is active.",
          "command": "aws guardduty list-detectors --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "BRAIN: Validate existence of EventBridge rules that listen for GuardDuty signals (evidence of automated response logic).",
          "command": "aws events list-rules --name-prefix GuardDuty --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-IAM-07",
      "validation_id": "KSI-IAM-07",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Securely manage the lifecycle and privileges of all accounts, roles, and groups, using automation.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws iam generate-credential-report > /dev/null && aws iam get-credential-report --output text | base64 --decode || echo 'Permission Denied'; aws iam list-roles --query \"Roles[?CreateDate<='2024-01-01']\" --output json",
      "timestamp": "2025-12-29T08:22:43.907754Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-07/iam_081951_7606.json",
      "total_category_controls": 7,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Retrieve the full Credential Report to analyze password and key rotation ages.",
          "command": "aws iam generate-credential-report > /dev/null && aws iam get-credential-report --output text | base64 --decode || echo 'Permission Denied'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.83s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "AUDIT: Identify potential 'Zombie Roles' that are older than a specific threshold (adjust date as needed).",
          "command": "aws iam list-roles --query \"Roles[?CreateDate<='2024-01-01']\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.03s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-INR-01",
      "validation_id": "KSI-INR-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Always follow a documented incident response procedure.",
      "long_name": "Incident Response",
      "category_prefix": "KSI-INR",
      "cli_command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'policy') || contains(repositoryName, 'compliance') || contains(repositoryName, 'playbook') || contains(repositoryName, 'security') || contains(repositoryName, 'procedures') || contains(repositoryName, 'runbook')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907764Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-INR-01/codecommit_081951_80.json",
      "total_category_controls": 1,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate existence of the designated Policy/Runbook repository (filters out application code).",
          "command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'policy') || contains(repositoryName, 'compliance') || contains(repositoryName, 'playbook') || contains(repositoryName, 'security') || contains(repositoryName, 'procedures') || contains(repositoryName, 'runbook')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-INR-02",
      "validation_id": "KSI-INR-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 12 items: 12 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Maintain a log of incidents and periodically review past incidents for patterns or vulnerabilities.",
      "long_name": "Incident Response",
      "category_prefix": "KSI-INR",
      "cli_command": "aws logs describe-log-groups --query \"logGroups[?contains(logGroupName, 'security') || contains(logGroupName, 'cloudtrail') || contains(logGroupName, 'audit') || contains(logGroupName, 'incident')]\" --output json; aws s3api list-buckets --query \"Buckets[?contains(Name, 'log') || contains(Name, 'audit') || contains(Name, 'security')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907775Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-INR-02/logs_081951_3669.json",
      "total_category_controls": 2,
      "resources_scanned": 12,
      "resources_passed": 12,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate existence of centralized CloudWatch Log Groups for security events.",
          "command": "aws logs describe-log-groups --query \"logGroups[?contains(logGroupName, 'security') || contains(logGroupName, 'cloudtrail') || contains(logGroupName, 'audit') || contains(logGroupName, 'incident')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.94s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate existence of immutable S3 storage for long-term incident retention.",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'log') || contains(Name, 'audit') || contains(Name, 'security')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-INR-03",
      "validation_id": "KSI-INR-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Generate after action reports and regularly incorporate lessons learned into operations.",
      "long_name": "Incident Response",
      "category_prefix": "KSI-INR",
      "cli_command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'post-mortem') || contains(repositoryName, 'aar') || contains(repositoryName, 'lessons-learned') || contains(repositoryName, 'incident-reports') || contains(repositoryName, 'reports')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907783Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-INR-03/codecommit_081951_8199.json",
      "total_category_controls": 3,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate existence of the designated Post-Mortem/AAR repository.",
          "command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'post-mortem') || contains(repositoryName, 'aar') || contains(repositoryName, 'lessons-learned') || contains(repositoryName, 'incident-reports') || contains(repositoryName, 'reports')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-MLA-01",
      "validation_id": "KSI-MLA-01",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (50%): 2 items: 1 verified, 1 failed",
      "recommended_action": "ACTION: Remediate 1 non-compliant resource. Review resource configurations against FedRAMP requirements. Current compliance: 50% (Target: \u226580%)",
      "requirement": "Log all activity on all information resources supporting the cloud service offering to a protected audit log.",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws cloudtrail describe-trails --output json; aws cloudtrail get-trail-status --name $(aws cloudtrail describe-trails --query 'trailList[0].TrailARN' --output text) --output json; aws s3api list-buckets --query \"Buckets[?contains(Name, 'cloudtrail') || contains(Name, 'audit') || contains(Name, 'logs')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907793Z",
      "score": 50,
      "evidence_path": "evidence_v2/KSI-MLA-01/cloudtrail_081951_6885.json",
      "total_category_controls": 1,
      "resources_scanned": 2,
      "resources_passed": 1,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate existence and configuration of the CloudTrail trail.",
          "command": "aws cloudtrail describe-trails --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "STATUS: Confirm CloudTrail is actually 'IsLogging': true. Uses TrailARN to avoid naming conflicts.",
          "command": "aws cloudtrail get-trail-status --name $(aws cloudtrail describe-trails --query 'trailList[0].TrailARN' --output text) --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.79s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "STORAGE: Validate the specific S3 bucket used for audit log retention.",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'cloudtrail') || contains(Name, 'audit') || contains(Name, 'logs')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-MLA-02",
      "validation_id": "KSI-MLA-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 6 items: 6 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Regularly review and audit logs.",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws logs describe-metric-filters --output json; aws securityhub get-insights --output json; aws cloudwatch describe-alarms --query \"MetricAlarms[?contains(AlarmName, 'Log') || contains(AlarmName, 'Security') || contains(AlarmName, 'Filter')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907803Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-MLA-02/securityhub_081951_8040.json",
      "total_category_controls": 2,
      "resources_scanned": 6,
      "resources_passed": 6,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate existence of automated log scanning patterns (e.g., 'RootLogin', 'Unauthorized').",
          "command": "aws logs describe-metric-filters --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.89s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "SECONDARY: Validate usage of Security Hub for aggregated security trend analysis.",
          "command": "aws securityhub get-insights --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "ALERTING: Validate alarms specifically tied to log metric filters.",
          "command": "aws cloudwatch describe-alarms --query \"MetricAlarms[?contains(AlarmName, 'Log') || contains(AlarmName, 'Security') || contains(AlarmName, 'Filter')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-MLA-05",
      "validation_id": "KSI-MLA-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 12 items: 12 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Perform Infrastructure as Code and configuration evaluation and testing.",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws s3 ls s3://mks-states/ --recursive | grep -E '\\.tfstate|\\.tfplan' || echo 'No State Files Found'; aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'infra') || contains(repositoryName, 'terraform')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907813Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-MLA-05/s3_081951_4967.json",
      "total_category_controls": 3,
      "resources_scanned": 12,
      "resources_passed": 12,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Scan the Terraform State bucket. Presence of '.tfplan' proves pre-deployment evaluation; '.tfstate' proves active configuration management.",
          "command": "aws s3 ls s3://mks-states/ --recursive | grep -E '\\.tfstate|\\.tfplan' || echo 'No State Files Found'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "SOURCE: Validate existence of the Infrastructure-as-Code repository.",
          "command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'infra') || contains(repositoryName, 'terraform')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-MLA-07",
      "validation_id": "KSI-MLA-07",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 11 items: 11 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Maintain a list of information resources and event types that will be monitored, logged, and audited.",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws configservice describe-configuration-recorders --output json; aws cloudtrail describe-trails --output json; aws logs describe-log-groups --query \"logGroups[?contains(logGroupName, 'security') || contains(logGroupName, 'cloudtrail') || contains(logGroupName, 'audit') || contains(logGroupName, 'flow')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907824Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-MLA-07/configservice_081951_6055.json",
      "total_category_controls": 4,
      "resources_scanned": 11,
      "resources_passed": 11,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "INVENTORY: Validate that AWS Config is recording the 'List of Information Resources'.",
          "command": "aws configservice describe-configuration-recorders --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "EVENTS: Validate that CloudTrail is defining the 'Event Types' to be logged.",
          "command": "aws cloudtrail describe-trails --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "EXECUTION: Validate that the specific Security/Audit logs are actually being captured.",
          "command": "aws logs describe-log-groups --query \"logGroups[?contains(logGroupName, 'security') || contains(logGroupName, 'cloudtrail') || contains(logGroupName, 'audit') || contains(logGroupName, 'flow')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-MLA-08",
      "validation_id": "KSI-MLA-08",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (0%): No resources found matching validation criteria",
      "recommended_action": "ACTION: Deploy required resources in infrastructure. This is an infrastructure gap, not an automation failure. Review FedRAMP requirements and provision necessary resources.",
      "requirement": "Use a least-privileged, role and attribute-based, and just-in-time access authorization model for access to log data.",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'audit') || contains(Name, 'logs') || contains(Name, 'trail')]\" --output json; aws kms list-aliases --query \"Aliases[?contains(AliasName, 'cloudtrail') || contains(AliasName, 'log') || contains(AliasName, 'audit')]\" --output json; aws iam list-policies --scope Local --query \"Policies[?contains(PolicyName, 'Log') || contains(PolicyName, 'Audit') || contains(PolicyName, 'ViewOnly')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907833Z",
      "score": 0,
      "evidence_path": "",
      "total_category_controls": 5,
      "resources_scanned": 0,
      "resources_passed": 0,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "VAULT: Validate existence of the designated Audit Log bucket.",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'audit') || contains(Name, 'logs') || contains(Name, 'trail')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "LOCK: Validate existence of a dedicated KMS key for encrypting log data.",
          "command": "aws kms list-aliases --query \"Aliases[?contains(AliasName, 'cloudtrail') || contains(AliasName, 'log') || contains(AliasName, 'audit')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "PERMIT: Validate existence of specific IAM Policies (RBAC) that define who can read logs.",
          "command": "aws iam list-policies --scope Local --query \"Policies[?contains(PolicyName, 'Log') || contains(PolicyName, 'Audit') || contains(PolicyName, 'ViewOnly')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-PIY-01",
      "validation_id": "KSI-PIY-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use authoritative sources to automatically maintain real-time inventories of all information resources.",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws configservice describe-configuration-recorders --output json; aws configservice describe-delivery-channels --output json; aws ssm list-inventory-entries --instance-id $(aws ec2 describe-instances --query 'Reservations[0].Instances[0].InstanceId' --output text) --type-name AWS:Application --output json || echo '{\"Entries\": []}'",
      "timestamp": "2025-12-29T08:22:43.907844Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-01/configservice_081951_6055.json",
      "total_category_controls": 1,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate that the Configuration Recorder is active (The 'Authoritative Source').",
          "command": "aws configservice describe-configuration-recorders --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "STORAGE: Validate that the inventory data is being delivered to a central S3 bucket.",
          "command": "aws configservice describe-delivery-channels --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "os-LEVEL: Sample check for SSM Inventory data (software list) on a live instance.",
          "command": "aws ssm list-inventory-entries --instance-id $(aws ec2 describe-instances --query 'Reservations[0].Instances[0].InstanceId' --output text) --type-name AWS:Application --output json || echo '{\"Entries\": []}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "2.22s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-PIY-02",
      "validation_id": "KSI-PIY-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Document the security objectives and requirements for each information resource.",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/security-objectives/ --output json",
      "timestamp": "2025-12-29T08:22:43.907852Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-02/codecommit_081951_9321.json",
      "total_category_controls": 2,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "ARTIFACTS: List the Markdown files defining security objectives. (Matches: api-gateway.md, rds-instances.md, etc.)",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/security-objectives/ --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.11s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-PIY-03",
      "validation_id": "KSI-PIY-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Maintain a vulnerability disclosure program.",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --output json",
      "timestamp": "2025-12-29T08:22:43.907861Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-03/codecommit_081951_373.json",
      "total_category_controls": 3,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "ARTIFACT: Scan the policies folder for the Disclosure Policy (filters for 'disclosure', 'vdp', or 'security' in filenames).",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.97s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-PIY-04",
      "validation_id": "KSI-PIY-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Monitor the effectiveness of building security and privacy considerations into the Software Development Lifecycle and aligning with CISA Secure By Design principles.",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/secure-software-development.md --output json; aws codebuild list-projects --query \"projects[?contains(@, 'security') || contains(@, 'scan') || contains(@, 'test') || contains(@, 'lint') || contains(@, 'check') || contains(@, 'compliance')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907871Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-04/codecommit_081951_3426.json",
      "total_category_controls": 4,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate existence of the specific Secure SDLC policy document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/secure-software-development.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.04s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "MECHANISM: List only build projects dedicated to security scanning or testing (The Quality Control gates).",
          "command": "aws codebuild list-projects --query \"projects[?contains(@, 'security') || contains(@, 'scan') || contains(@, 'test') || contains(@, 'lint') || contains(@, 'check') || contains(@, 'compliance')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-PIY-05",
      "validation_id": "KSI-PIY-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Document methods used to evaluate information resource implementations.",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/evaluation-methodology.md --output json",
      "timestamp": "2025-12-29T08:22:43.907879Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-05/codecommit_081951_3101.json",
      "total_category_controls": 5,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Retrieve the specific Evaluation Methodology document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/evaluation-methodology.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.02s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-PIY-06",
      "validation_id": "KSI-PIY-06",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Monitor the effectiveness of the organization's investments in achieving security objectives.",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/security-objectives/security-monitoring-and-alerting-plan.md --output json; aws securityhub get-enabled-standards --output json",
      "timestamp": "2025-12-29T08:22:43.907889Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-06/codecommit_081951_6725.json",
      "total_category_controls": 6,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the existence of the specific Security Monitoring Plan document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/security-objectives/security-monitoring-and-alerting-plan.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.05s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "INVESTMENT: Validate that Security Hub Standards (CIS, PCI, FedRAMP) are enabled (The automated mechanism for monitoring effectiveness).",
          "command": "aws securityhub get-enabled-standards --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.22s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-PIY-07",
      "validation_id": "KSI-PIY-07",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Document risk management decisions for software supply chain security.",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'supply') || contains(absolutePath, 'chain') || contains(absolutePath, 'vendor') || contains(absolutePath, 'dependency') || contains(absolutePath, 'scrm')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907898Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-07/codecommit_081951_868.json",
      "total_category_controls": 7,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "POLICY: Locate the Supply Chain Risk Management document.",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'supply') || contains(absolutePath, 'chain') || contains(absolutePath, 'vendor') || contains(absolutePath, 'dependency') || contains(absolutePath, 'scrm')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.93s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-PIY-08",
      "validation_id": "KSI-PIY-08",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Measure executive support via active budgetary controls and financial commitment.",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws guardduty list-detectors --output json; aws securityhub get-enabled-standards --output json; aws budgets describe-budgets --account-id $(aws sts get-caller-identity --query Account --output text) --output json",
      "timestamp": "2025-12-29T08:22:43.907907Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-08/guardduty_081951_7432.json",
      "total_category_controls": 8,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "INVESTMENT: Validate that GuardDuty is enabled (Paid Threat Detection Service).",
          "command": "aws guardduty list-detectors --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "INVESTMENT: Validate that Security Hub is enabled (Paid Compliance Aggregation Service).",
          "command": "aws securityhub get-enabled-standards --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.10s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "CONTROL: Validate that a Budget exists to track this security spending.",
          "command": "aws budgets describe-budgets --account-id $(aws sts get-caller-identity --query Account --output text) --output json",
          "status": "failed",
          "exit_code": 254,
          "execution_time": "1.70s",
          "error_message": "\nAn error occurred (AccessDeniedException) when calling the DescribeBudgets operation: User: arn:aws:sts::893894210484:assumed-role/githubactions_role/Github_to_AWS_Federated is not authorized to perf"
        }
      ],
      "commands_executed": 3,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-RPL-01",
      "validation_id": "KSI-RPL-01",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (33%): 3 items: 1 verified, 2 failed",
      "recommended_action": "ACTION: Remediate 2 non-compliant resources. Review resource configurations against FedRAMP requirements. Current compliance: 33% (Target: \u226580%)",
      "requirement": "Define Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).",
      "long_name": "Recovery Planning",
      "category_prefix": "KSI-RPL",
      "cli_command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'recovery') || contains(absolutePath, 'disaster') || contains(absolutePath, 'continuity') || contains(absolutePath, 'bcp')]\" --output json; aws backup list-backup-plans --output json",
      "timestamp": "2025-12-29T08:22:43.907918Z",
      "score": 33,
      "evidence_path": "evidence_v2/KSI-RPL-01/codecommit_081951_1997.json",
      "total_category_controls": 1,
      "resources_scanned": 3,
      "resources_passed": 1,
      "resources_failed": 2,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate existence of the Disaster Recovery / Business Continuity Plan.",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'recovery') || contains(absolutePath, 'disaster') || contains(absolutePath, 'continuity') || contains(absolutePath, 'bcp')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.97s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "TECHNICAL: Validate existence of AWS Backup Plans (proof that RPO is being enforced via automated schedules).",
          "command": "aws backup list-backup-plans --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-RPL-02",
      "validation_id": "KSI-RPL-02",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (16%): 6 items: 1 verified, 5 failed",
      "recommended_action": "ACTION: Remediate 5 non-compliant resources. Review resource configurations against FedRAMP requirements. Current compliance: 16% (Target: \u226580%)",
      "requirement": "Develop and maintain a recovery plan that aligns with the defined recovery objectives.",
      "long_name": "Recovery Planning",
      "category_prefix": "KSI-RPL",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/disaster-recovery-plan.md --output json; aws backup list-backup-jobs --by-state COMPLETED --max-results 5 --output json",
      "timestamp": "2025-12-29T08:22:43.907929Z",
      "score": 16,
      "evidence_path": "evidence_v2/KSI-RPL-02/codecommit_081951_9359.json",
      "total_category_controls": 2,
      "resources_scanned": 6,
      "resources_passed": 1,
      "resources_failed": 5,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate existence of the defined Recovery Plan.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/disaster-recovery-plan.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.93s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "EXECUTION: Validate that backup jobs are successfully completing (Proof of Maintenance).",
          "command": "aws backup list-backup-jobs --by-state COMPLETED --max-results 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-RPL-03",
      "validation_id": "KSI-RPL-03",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (25%): 4 items: 1 verified, 3 failed",
      "recommended_action": "ACTION: Remediate 3 non-compliant resources. Review resource configurations against FedRAMP requirements. Current compliance: 25% (Target: \u226580%)",
      "requirement": "Regularly test the recovery planning capability by performing disaster recovery tests at least annually.",
      "long_name": "Recovery Planning",
      "category_prefix": "KSI-RPL",
      "cli_command": "aws backup list-restore-jobs --by-status COMPLETED --max-results 5 --output json; aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'dr-test') || contains(absolutePath, 'restore-report') || contains(absolutePath, 'after-action')]\" --output json",
      "timestamp": "2025-12-29T08:22:43.907939Z",
      "score": 25,
      "evidence_path": "evidence_v2/KSI-RPL-03/backup_081951_1388.json",
      "total_category_controls": 3,
      "resources_scanned": 4,
      "resources_passed": 1,
      "resources_failed": 3,
      "command_executions": [
        {
          "index": 0,
          "description": "TECHNICAL: Validate that Restore Jobs have been successfully executed (Proof of Testing).",
          "command": "aws backup list-restore-jobs --by-status COMPLETED --max-results 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "GOVERNANCE: Validate existence of the Disaster Recovery Test Report.",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'dr-test') || contains(absolutePath, 'restore-report') || contains(absolutePath, 'after-action')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.96s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-RPL-04",
      "validation_id": "KSI-RPL-04",
      "assertion": false,
      "assertion_reason": "\u274c Insufficient (25%): 4 items: 1 verified, 3 failed",
      "recommended_action": "ACTION: Remediate 3 non-compliant resources. Review resource configurations against FedRAMP requirements. Current compliance: 25% (Target: \u226580%)",
      "requirement": "Regularly test the capability to recover from incidents and contingencies.",
      "long_name": "Recovery Planning",
      "category_prefix": "KSI-RPL",
      "cli_command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'incident-response-test') || contains(absolutePath, 'contingency-test') || contains(absolutePath, 'ir-test')]\" --output json; aws backup list-restore-jobs --by-status COMPLETED --max-results 5 --output json",
      "timestamp": "2025-12-29T08:22:43.907950Z",
      "score": 25,
      "evidence_path": "evidence_v2/KSI-RPL-04/codecommit_081951_1699.json",
      "total_category_controls": 4,
      "resources_scanned": 4,
      "resources_passed": 1,
      "resources_failed": 3,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate existence of the Incident Response / Contingency Test Report.",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'incident-response-test') || contains(absolutePath, 'contingency-test') || contains(absolutePath, 'ir-test')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.06s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "TECHNICAL: Validate that Restore Jobs have been executed (Proof of recovery capability).",
          "command": "aws backup list-restore-jobs --by-status COMPLETED --max-results 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-SVC-01",
      "validation_id": "KSI-SVC-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 31 items: 31 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Implement improvements based on persistent evaluation of information resources for opportunities to improve security.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws inspector2 list-coverage --output json; aws ssm describe-patch-baselines --filters \"Key=OWNER,Values=[Self]\" --output json; aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.907964Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-01/inspector2_081951_2144.json",
      "total_category_controls": 1,
      "resources_scanned": 31,
      "resources_passed": 31,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVALUATION: Validate that Inspector is actively scanning resources (The 'Persistent Evaluation').",
          "command": "aws inspector2 list-coverage --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.13s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "IMPROVEMENT: Validate existence of custom Patch Baselines (The mechanism for 'Implementing Improvements').",
          "command": "aws ssm describe-patch-baselines --filters \"Key=OWNER,Values=[Self]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "GOVERNANCE: Validate the policy defining the evaluation and improvement cycle.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-02",
      "validation_id": "KSI-SVC-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Encrypt or otherwise secure network traffic.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws acm list-certificates --certificate-statuses ISSUED --output json; aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, DNS:DNSName, Scheme:Scheme}\" --output json; aws cloudfront list-distributions --query \"DistributionList.Items[].{Id:Id, Domain:DomainName, Certificate:ViewerCertificate.Certificate}\" --output json; aws codecommit get-file --repository-name security-governance --file-path policies/encryption-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.907974Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-02/acm_081951_4839.json",
      "total_category_controls": 2,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "KEYS: Validate existence of active, issued TLS certificates.",
          "command": "aws acm list-certificates --certificate-statuses ISSUED --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "GATEKEEPERS: List Load Balancers handling traffic.",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, DNS:DNSName, Scheme:Scheme}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "EDGE: Validate CloudFront distributions (CDN) are configured with certificates.",
          "command": "aws cloudfront list-distributions --query \"DistributionList.Items[].{Id:Id, Domain:DomainName, Certificate:ViewerCertificate.Certificate}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "GOVERNANCE: Validate the Encryption Policy document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/encryption-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.10s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-SVC-04",
      "validation_id": "KSI-SVC-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Manage configuration of machine-based information resources using automation.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'terraform') || contains(Name, 'state') || contains(Name, 'tfstate')]\" --output json; aws dynamodb list-tables --query \"TableNames[?contains(@, 'terraform') || contains(@, 'lock') || contains(@, 'state')]\" --output json; aws codecommit get-file --repository-name security-governance --file-path policies/configuration-management-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.907984Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-04/codecommit_081951_2905.json",
      "total_category_controls": 3,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "IAC STATE: Validate existence of the Terraform State S3 bucket (The Proof of Automation).",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'terraform') || contains(Name, 'state') || contains(Name, 'tfstate')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CONCURRENCY: Validate existence of the Terraform State Lock table.",
          "command": "aws dynamodb list-tables --query \"TableNames[?contains(@, 'terraform') || contains(@, 'lock') || contains(@, 'state')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "GOVERNANCE: Validate the Configuration Management Policy document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/configuration-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.98s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-05",
      "validation_id": "KSI-SVC-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 6 items: 6 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use cryptographic methods to validate the integrity of machine-based information resources.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws cloudtrail describe-trails --query \"trailList[?LogFileValidationEnabled==true]\" --output json; aws s3api get-bucket-versioning --bucket $(aws cloudtrail describe-trails --query 'trailList[0].S3BucketName' --output text) --output json; aws ssm describe-instance-information --query \"InstanceInformationList[].{ID:InstanceId, PingStatus:PingStatus, AgentVersion:AgentVersion}\" --output json",
      "timestamp": "2025-12-29T08:22:43.907994Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-05/ssm_081951_9613.json",
      "total_category_controls": 4,
      "resources_scanned": 6,
      "resources_passed": 6,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "LOGS: Validate that CloudTrail Log File Validation is enabled (Cryptographic hashing of audit trails).",
          "command": "aws cloudtrail describe-trails --query \"trailList[?LogFileValidationEnabled==true]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "STORAGE: Validate that the Audit/Artifact bucket has Versioning enabled (Prevents overwrite tampering).",
          "command": "aws s3api get-bucket-versioning --bucket $(aws cloudtrail describe-trails --query 'trailList[0].S3BucketName' --output text) --output json",
          "status": "failed",
          "exit_code": 254,
          "execution_time": "1.72s",
          "error_message": "\nAn error occurred (AccessDenied) when calling the GetBucketVersioning operation: User: arn:aws:sts::893894210484:assumed-role/githubactions_role/Github_to_AWS_Federated is not authorized to perform: "
        },
        {
          "index": 2,
          "description": "SESSIONS: Validate active SSM Agents, which enforce TLS-encrypted, IAM-signed channels for session integrity (Replacing insecure SSH).",
          "command": "aws ssm describe-instance-information --query \"InstanceInformationList[].{ID:InstanceId, PingStatus:PingStatus, AgentVersion:AgentVersion}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.96s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-SVC-06",
      "validation_id": "KSI-SVC-06",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 14 items: 14 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Automate management, protection, and regular rotation of digital keys, certificates, and other secrets.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws kms list-keys --limit 10 --output json; aws secretsmanager list-secrets --max-results 5 --output json; aws acm list-certificates --certificate-statuses ISSUED --max-items 10 --output json",
      "timestamp": "2025-12-29T08:22:43.908006Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-06/kms_081951_3875.json",
      "total_category_controls": 5,
      "resources_scanned": 14,
      "resources_passed": 14,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "KEYS: Validate existence of KMS Customer Managed Keys (CMKs) for centralized management.",
          "command": "aws kms list-keys --limit 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.78s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "ROTATION: Validate Secrets Manager entries (Look for 'RotationEnabled': true in the output).",
          "command": "aws secretsmanager list-secrets --max-results 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "CERTIFICATES: Validate active ACM Certificates (Proof of managed renewal).",
          "command": "aws acm list-certificates --certificate-statuses ISSUED --max-items 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-07",
      "validation_id": "KSI-SVC-07",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use a consistent, risk-informed approach for applying security patches.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws inspector2 list-coverage --max-results 5 --output json; aws ssm describe-patch-baselines --filters \"Key=OWNER,Values=[Self]\" --output json; aws ssm describe-maintenance-windows --max-results 10 --output json; aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.908015Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-07/inspector2_081951_6786.json",
      "total_category_controls": 6,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "RISK: Validate that Inspector is tracking vulnerability coverage for instances (Risk-Informed Data).",
          "command": "aws inspector2 list-coverage --max-results 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CONSISTENCY: Validate custom Patch Baselines that define which patches are approved.",
          "command": "aws ssm describe-patch-baselines --filters \"Key=OWNER,Values=[Self]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "APPROACH: Validate Maintenance Windows which enforce the consistent schedule for applying patches. (Fixed: max-results min 10)",
          "command": "aws ssm describe-maintenance-windows --max-results 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "GOVERNANCE: Validate the Vulnerability Management Policy (Created in SVC-01).",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.07s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-SVC-08",
      "validation_id": "KSI-SVC-08",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 12 items: 12 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Do not introduce or leave behind residual elements that could negatively affect confidentiality, integrity, or availability of federal customer data during operations.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws s3api get-bucket-lifecycle-configuration --bucket $(aws s3api list-buckets --query 'Buckets[0].Name' --output text) --output json || echo '{\"Rules\": []}'; aws kms list-keys --limit 10 --output json; aws codecommit get-file --repository-name security-governance --file-path policies/data-sanitization-policy.md --output json",
      "timestamp": "2025-12-29T08:22:43.908025Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-08/s3api_081951_5325.json",
      "total_category_controls": 7,
      "resources_scanned": 12,
      "resources_passed": 12,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "AUTOMATION: Validate S3 Lifecycle Rules that automatically expire/delete temporary or residual data.",
          "command": "aws s3api get-bucket-lifecycle-configuration --bucket $(aws s3api list-buckets --query 'Buckets[0].Name' --output text) --output json || echo '{\"Rules\": []}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.71s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CAPABILITY: Validate existence of KMS keys. Deleting a key is the industry-standard method for 'Crypto-Shredding' data from immutable backups.",
          "command": "aws kms list-keys --limit 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.78s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "GOVERNANCE: Validate the Data Sanitization Policy which defines the procedure for destroying customer data.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/data-sanitization-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.96s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-09",
      "validation_id": "KSI-SVC-09",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently validate the authenticity and integrity of communications between machine-based information resources using automation.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, Scheme:Scheme}\" --output json; for arn in $(aws elbv2 describe-load-balancers --query 'LoadBalancers[].LoadBalancerArn' --output text 2>/dev/null || echo ''); do aws elbv2 describe-listeners --load-balancer-arn \"$arn\" --query \"Listeners[?Protocol=='HTTPS' || Protocol=='TLS'].{Port:Port, SslPolicy:SslPolicy, Certificates:Certificates}\" --output json; done; aws acm list-certificates --certificate-statuses ISSUED --max-items 10 --output json",
      "timestamp": "2025-12-29T08:22:43.908034Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-09/elbv2_081951_6096.json",
      "total_category_controls": 8,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "ENFORCERS: Identify active Load Balancers handling traffic.",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, Scheme:Scheme}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.89s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "VALIDATION: Verify that listeners are enforcing HTTPS/TLS with specific SSL Policies (authenticity/integrity checks).",
          "command": "for arn in $(aws elbv2 describe-load-balancers --query 'LoadBalancers[].LoadBalancerArn' --output text 2>/dev/null || echo ''); do aws elbv2 describe-listeners --load-balancer-arn \"$arn\" --query \"Listeners[?Protocol=='HTTPS' || Protocol=='TLS'].{Port:Port, SslPolicy:SslPolicy, Certificates:Certificates}\" --output json; done",
          "status": "success",
          "exit_code": 0,
          "execution_time": null,
          "error_message": null
        },
        {
          "index": 2,
          "description": "IDENTITY: Validate existence of issued ACM certificates used to prove authenticity.",
          "command": "aws acm list-certificates --certificate-statuses ISSUED --max-items 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-10",
      "validation_id": "KSI-SVC-10",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 13 items: 13 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Remove unwanted federal customer data promptly when requested by an agency in alignment with customer agreements, including from backups if appropriate.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/data-sanitization-policy.md --output json; aws backup list-backup-plans --output json; aws kms list-keys --limit 10 --output json",
      "timestamp": "2025-12-29T08:22:43.908045Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-10/codecommit_081951_5332.json",
      "total_category_controls": 9,
      "resources_scanned": 13,
      "resources_passed": 13,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the Data Sanitization Policy (defines the 'Promptly' SLA and procedure).",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/data-sanitization-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.12s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "RETENTION: Validate Backup Plans to ensure automated expiration rules are in place (Data doesn't live forever).",
          "command": "aws backup list-backup-plans --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "DESTRUCTION: Validate KMS Keys (The mechanism for 'Crypto-Shredding' data from immutable backups).",
          "command": "aws kms list-keys --limit 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.79s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-TPR-03",
      "validation_id": "KSI-TPR-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 48 items: 48 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Identify and prioritize mitigation of potential supply chain risks.",
      "long_name": "Third-Party Information Resources",
      "category_prefix": "KSI-TPR",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md; aws codecommit list-approval-rule-templates --output json; aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
      "timestamp": "2025-12-29T08:22:43.908061Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-TPR-03/codecommit_081951_2627.json",
      "total_category_controls": 1,
      "resources_scanned": 48,
      "resources_passed": 48,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Retrieve the supply chain risk management policy from CodeCommit to verify its existence and size.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.93s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate that a formal approval rule process is configured for the repository.",
          "command": "aws codecommit list-approval-rule-templates --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Check the commit history for an audit trail of recent policy updates.",
          "command": "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-TPR-04",
      "validation_id": "KSI-TPR-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 9 items: 9 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Automatically monitor third party software information resources for upstream vulnerabilities using mechanisms that may include contractual notification requirements or active monitoring services.",
      "long_name": "Third-Party Information Resources",
      "category_prefix": "KSI-TPR",
      "cli_command": "aws inspector2 get-configuration --output json; aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"OPERATING_SYSTEM\"}]}' --max-results 50 --output json; aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"APPLICATION\"}]}' --max-results 50 --output json; aws inspector2 list-findings --filter-criteria '{\"findingStatus\":[{\"comparison\":\"EQUALS\",\"value\":\"ACTIVE\"}]}' --max-results 100 --output json; aws inspector2 list-coverage --filter-criteria '{\"resourceType\":[{\"comparison\":\"EQUALS\",\"value\":\"AWS_EC2_INSTANCE\"}]}' --max-results 100 --output json; aws ssm describe-instance-information --output json",
      "timestamp": "2025-12-29T08:22:43.908073Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-TPR-04/inspector2_081951_718.json",
      "total_category_controls": 2,
      "resources_scanned": 9,
      "resources_passed": 9,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Check Inspector configuration for vulnerability scanning",
          "command": "aws inspector2 get-configuration --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate OS vulnerability findings from Inspector",
          "command": "aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"OPERATING_SYSTEM\"}]}' --max-results 50 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.98s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Check application vulnerability findings from Inspector",
          "command": "aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"APPLICATION\"}]}' --max-results 50 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.96s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "Validate active vulnerability findings requiring remediation",
          "command": "aws inspector2 list-findings --filter-criteria '{\"findingStatus\":[{\"comparison\":\"EQUALS\",\"value\":\"ACTIVE\"}]}' --max-results 100 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.51s",
          "error_message": null
        },
        {
          "index": 4,
          "description": "Check Inspector coverage for EC2 instances",
          "command": "aws inspector2 list-coverage --filter-criteria '{\"resourceType\":[{\"comparison\":\"EQUALS\",\"value\":\"AWS_EC2_INSTANCE\"}]}' --max-results 100 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        },
        {
          "index": 5,
          "description": "Validate SSM agent deployment for vulnerability management",
          "command": "aws ssm describe-instance-information --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.96s",
          "error_message": null
        }
      ],
      "commands_executed": 6,
      "successful_commands": 6
    }
  ]
}