{
  "metadata": {
    "generated_at": "2026-02-19T04:59:59.747968Z",
    "total_ksis": 61,
    "passed": 61,
    "failed": 0,
    "pass_rate": "100.0%",
    "global_status": "OPERATIONAL",
    "circuit_breaker": {
      "state": "CLOSED",
      "global_status": "OPERATIONAL",
      "config": {
        "failure_threshold": 0.3,
        "min_samples": 10,
        "consecutive_failure_limit": 5
      },
      "stats": {
        "total_executed": 61,
        "total_failed": 0,
        "total_passed": 61,
        "consecutive_failures": 0,
        "failure_rate": 0.0,
        "last_failure_time": null,
        "circuit_broken_at": null
      }
    },
    "critical_findings": {
      "summary": {
        "total": 1,
        "by_severity": {
          "CRITICAL": 1
        },
        "by_ksi": {
          "KSI-CNA-02": 1
        },
        "by_resource_type": {
          "security_group/ec2": 1
        },
        "critical_count": 1,
        "high_count": 0
      },
      "findings": [
        {
          "ksi_id": "KSI-CNA-02",
          "resource_id": "sg-0c6e8245d58934a84",
          "resource_type": "security_group/ec2",
          "severity": "CRITICAL",
          "cia_impact": [
            "C",
            "I"
          ],
          "title": "Open ingress (0.0.0.0/0) on EC2",
          "description": "Security group allows unrestricted inbound access from any IP. This is critical on EC2 resources as it exposes compute/data resources to the entire internet.",
          "evidence": {
            "cidr": "0.0.0.0/0",
            "protocol": "tcp",
            "from_port": 443,
            "to_port": 443
          },
          "remediation": "Restrict inbound rules to specific IP ranges or security groups. For EC2, use private subnets behind ALB/NLB.",
          "detected_at": "2026-02-19T04:58:09.353419+00:00"
        }
      ],
      "by_ksi": {
        "KSI-CNA-02": [
          {
            "ksi_id": "KSI-CNA-02",
            "resource_id": "sg-0c6e8245d58934a84",
            "resource_type": "security_group/ec2",
            "severity": "CRITICAL",
            "cia_impact": [
              "C",
              "I"
            ],
            "title": "Open ingress (0.0.0.0/0) on EC2",
            "description": "Security group allows unrestricted inbound access from any IP. This is critical on EC2 resources as it exposes compute/data resources to the entire internet.",
            "evidence": {
              "cidr": "0.0.0.0/0",
              "protocol": "tcp",
              "from_port": 443,
              "to_port": 443
            },
            "remediation": "Restrict inbound rules to specific IP ranges or security groups. For EC2, use private subnets behind ALB/NLB.",
            "detected_at": "2026-02-19T04:58:09.353419+00:00"
          }
        ]
      }
    },
    "ksis_skipped": [],
    "category_summary": {
      "KSI-AFR": {
        "total": 11,
        "passed": 11,
        "failed": 0,
        "long_name": "Authorization by FedRAMP"
      },
      "KSI-CED": {
        "total": 4,
        "passed": 4,
        "failed": 0,
        "long_name": "Cybersecurity Education"
      },
      "KSI-CMT": {
        "total": 4,
        "passed": 4,
        "failed": 0,
        "long_name": "Change Management"
      },
      "KSI-CNA": {
        "total": 8,
        "passed": 8,
        "failed": 0,
        "long_name": "Cloud Native Architecture"
      },
      "KSI-IAM": {
        "total": 7,
        "passed": 7,
        "failed": 0,
        "long_name": "Identity and Access Management"
      },
      "KSI-INR": {
        "total": 3,
        "passed": 3,
        "failed": 0,
        "long_name": "Incident Response"
      },
      "KSI-MLA": {
        "total": 5,
        "passed": 5,
        "failed": 0,
        "long_name": "Monitoring, Logging, and Auditing"
      },
      "KSI-PIY": {
        "total": 5,
        "passed": 5,
        "failed": 0,
        "long_name": "Policy and Inventory"
      },
      "KSI-RPL": {
        "total": 4,
        "passed": 4,
        "failed": 0,
        "long_name": "Recovery Planning"
      },
      "KSI-SVC": {
        "total": 8,
        "passed": 8,
        "failed": 0,
        "long_name": "Service Configuration Management"
      },
      "KSI-TPR": {
        "total": 2,
        "passed": 2,
        "failed": 0,
        "long_name": "Third-Party Information Resources"
      }
    }
  },
  "validations": [
    {
      "ksi_id": "KSI-AFR-01",
      "validation_id": "KSI-AFR-01",
      "assertion": true,
      "assertion_reason": "\u2705 Good (84%): 19 items: 16 verified, 3 failed",
      "recommended_action": "\u2705 Good compliance. Consider remediating 3 non-compliant resources to reach excellent status (\u226590%).",
      "requirement": "Validates the complete FedRAMP Minimum Assessment Scope (MAS). This rule enforces Structural Boundaries (VPC ID) for compute assets AND validates that all peripheral assets (S3, RDS, ALB) are accounted for in the inventory.",
      "implementation_summary": "Meridian maintains a single-VPC architecture with all production resources (5 EC2 instances, 1 RDS database, 11 S3 buckets, 1 ALB) explicitly enumerated and validated daily. Our small footprint enables complete boundary visibility without complex discovery tools.",
      "justification": "Validates the Live FedRAMP Boundary (MAS). Explicitly inventories the four critical asset classes: 1) The Boundary itself (VPC), 2) Compute (EC2), 3) Data (RDS), and 4) Storage (S3), ensuring all are accounted for.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws ec2 describe-vpcs --filters Name=isDefault,Values=false --output json; aws ec2 describe-instances --filters Name=instance-state-name,Values=running --output json; aws rds describe-db-instances --query \"DBInstances[*].{ID:DBInstanceIdentifier, Engine:Engine, VPC:DBSubnetGroup.VpcId}\" --output json; aws s3api list-buckets --output json; aws elbv2 describe-load-balancers --query \"LoadBalancers[*].{ARN:LoadBalancerArn, DNS:DNSName, VPC:VpcId}\" --output json",
      "timestamp": "2026-02-19T04:59:59.747441Z",
      "score": 84,
      "evidence_path": "evidence_v2/KSI-AFR-01/ec2_045715_8143.json",
      "total_category_controls": 1,
      "resources_scanned": 19,
      "resources_passed": 16,
      "resources_failed": 3,
      "command_executions": [
        {
          "index": 0,
          "description": "BOUNDARY: Validate the dedicated Production VPC (The Structural Boundary of the MAS).",
          "command": "aws ec2 describe-vpcs --filters Name=isDefault,Values=false --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.12s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "COMPUTE: Validate that all active EC2 instances reside within the defined VPC Boundary.",
          "command": "aws ec2 describe-instances --filters Name=instance-state-name,Values=running --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.21s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "DATABASE: Validate RDS instances to ensure federal data is contained within the boundary.",
          "command": "aws rds describe-db-instances --query \"DBInstances[*].{ID:DBInstanceIdentifier, Engine:Engine, VPC:DBSubnetGroup.VpcId}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.93s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "STORAGE: Validate S3 buckets (Peripheral Assets) that fall within the assessment scope.",
          "command": "aws s3api list-buckets --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 4,
          "description": "NETWORK: Validate Load Balancers (The Ingress/Egress points of the boundary).",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[*].{ARN:LoadBalancerArn, DNS:DNSName, VPC:VpcId}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        }
      ],
      "commands_executed": 5,
      "successful_commands": 5
    },
    {
      "ksi_id": "KSI-AFR-02",
      "validation_id": "KSI-AFR-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Set security goals and develop automated validation of status and progress.",
      "implementation_summary": "Security goals are tracked via unified_ksi_validations.json, auto-generated by GitHub Actions and published to our Trust Center API. All 61 KSIs are evaluated daily with results publicly accessible.",
      "justification": "Validates the Active Compliance Tracker. Checks for the 'unified_ksi_validations.json' artifact in the S3 compliance bucket. This file represents the aggregated status of all Phase 2 KSIs, proving that security goals are actively tracked and validated.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/unified_ksi_validations.json --output json; aws securityhub describe-hub --output json",
      "timestamp": "2026-02-19T04:59:59.747456Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-02/s3api_045715_3271.json",
      "total_category_controls": 2,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "TRACKER: Validate existence and freshness of the Master Compliance Scorecard (unified_ksi_validations.json).",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/unified_ksi_validations.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "SOURCE: Validate Security Hub is enabled (The raw data source feeding the tracker).",
          "command": "aws securityhub describe-hub --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-03",
      "validation_id": "KSI-AFR-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Determine how authorization data will be shared in alignment with the ADS standard.",
      "implementation_summary": "Authorization data is shared via our public Trust Center (trust.meridianks.com) and API. The authorization package ZIP is auto-compiled from CodeCommit governance artifacts and updated with each pipeline run.",
      "justification": "Validates the ADS Deliverable. Checks specifically for the 'meridian-authorization-package-LATEST.zip' file. This confirms that the automated pipeline has successfully compiled the required documents into a distributable format.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/meridian-authorization-package-LATEST.zip --output json; curl -s -o /dev/null -w \"%{http_code}\" https://7d7pdwb9t3.execute-api.us-east-1.amazonaws.com/prod/status || echo \"000\"",
      "timestamp": "2026-02-19T04:59:59.747464Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-03/s3api_045715_9529.json",
      "total_category_controls": 3,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "DELIVERABLE: Validate the existence of the downloadable Authorization Package ZIP file.",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/meridian-authorization-package-LATEST.zip --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "INTERFACE: Ping the Trust Center API to ensure the delivery mechanism is live.",
          "command": "curl -s -o /dev/null -w \"%{http_code}\" https://7d7pdwb9t3.execute-api.us-east-1.amazonaws.com/prod/status || echo \"000\"",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.51s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-04",
      "validation_id": "KSI-AFR-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Document the vulnerability detection and response methodology.",
      "implementation_summary": "Vulnerability detection uses AWS Inspector and SecurityHub with VDR Release 25.09A compliance. Findings are aggregated into assessed_vulnerabilities_integrated.json with automated remediation tracking. Current posture: 0 CISA KEV matches, 0 internet-reachable criticals.",
      "justification": "Validates VDR Outputs. Instead of just checking if scanners are 'on', this validates the 'assessed_vulnerabilities_integrated.json' and 'vdr_vulnerability_status.json' artifacts. These prove that vulnerability data is being actively collected, integrated, and tracked.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/assessed_vulnerabilities_integrated.json --output json; aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/vdr_vulnerability_status.json --output json; aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
      "timestamp": "2026-02-19T04:59:59.747476Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-04/s3api_045715_5658.json",
      "total_category_controls": 4,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "DETECTION: Validate the Integrated Vulnerability Report artifact.",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/assessed_vulnerabilities_integrated.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "STATUS: Validate the VDR Status artifact (Proof of remediation tracking).",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/vdr_vulnerability_status.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "METHODOLOGY: Validate the Governance Policy defining the VDR process.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-AFR-05",
      "validation_id": "KSI-AFR-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Verify SCN procedures are documented and active change tracking is maintained.",
      "implementation_summary": "Significant Change Notifications are tracked via CodeCommit commit history and Terraform state versioning. All infrastructure changes require PR approval and generate immutable audit trails.",
      "justification": "Validates SCN Evidence in the 'Audit Drop Box' bucket.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')]\" --output json; aws s3api list-objects-v2 --bucket $(aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')].Name\" --output text | head -n 1) --prefix scn-flow-validation.html --output json; aws s3api list-objects-v2 --bucket $(aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')].Name\" --output text | head -n 1) --prefix audit_trail --output json",
      "timestamp": "2026-02-19T04:59:59.747484Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-05/s3api_045715_823.json",
      "total_category_controls": 5,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "DROP BOX: Validate existence of the Compliance Evidence bucket.",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "PROCEDURE: Check for the 'scn-flow-validation.html' file.",
          "command": "aws s3api list-objects-v2 --bucket $(aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')].Name\" --output text | head -n 1) --prefix scn-flow-validation.html --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.67s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "LOGS: Check for the SCN Audit Trail file.",
          "command": "aws s3api list-objects-v2 --bucket $(aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'evidence')].Name\" --output text | head -n 1) --prefix audit_trail --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.63s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-AFR-06",
      "validation_id": "KSI-AFR-06",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Maintain a plan and process for providing Ongoing Authorization Reports and Quarterly Reviews.",
      "implementation_summary": "Ongoing authorization reports are auto-generated and published to our Trust Center. 3PAO audit reports are stored in the compliance bucket with quarterly review cadence built into GitHub Actions workflows.",
      "justification": "Validates CCM Evidence. Checks for the '3pao_audit_report.json' artifact. This validates that the continuous monitoring process includes independent assessment data, supporting the 'Collaborative' aspect of the FedRAMP CCM standard.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/3pao_audit_report.json --output json; curl -s -o /dev/null -w \"%{http_code}\" https://meridian-knowledge-solutions.github.io/fedramp-trust-center/ || echo \"000\"",
      "timestamp": "2026-02-19T04:59:59.747492Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-06/s3api_045715_5292.json",
      "total_category_controls": 6,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "INDEPENDENT REVIEW: Validate the 3PAO Audit Report artifact.",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/3pao_audit_report.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "AVAILABILITY: Ping the Trust Center Portal (The delivery vehicle for these reports).",
          "command": "curl -s -o /dev/null -w \"%{http_code}\" https://meridian-knowledge-solutions.github.io/fedramp-trust-center/ || echo \"000\"",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.04s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-07",
      "validation_id": "KSI-AFR-07",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Document the secure configuration baseline for the cloud service offering.",
      "implementation_summary": "Security configuration baseline is documented in CodeCommit (security-governance repo) and served via our /prod/config API endpoint. Baselines cover EC2 hardening, RDS encryption, S3 policies, and network segmentation.",
      "justification": "Validates the Secure Configuration Baseline via API. Instead of checking a static file, this queries the live '/prod/config' endpoint, proving that the security baseline is actively published and available to consumers.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "curl -s https://7d7pdwb9t3.execute-api.us-east-1.amazonaws.com/prod/config",
      "timestamp": "2026-02-19T04:59:59.747499Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-07/apidocumentation_045715_6615.json",
      "total_category_controls": 7,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "DYNAMIC RETRIEVAL: Fetch the Security Baseline from the live API. This proves the configuration standards are documented and programmatically accessible.",
          "command": "curl -s https://7d7pdwb9t3.execute-api.us-east-1.amazonaws.com/prod/config",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.09s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-AFR-08",
      "validation_id": "KSI-AFR-08",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Operate a secure inbox to receive critical communication from FedRAMP and other government entities.",
      "implementation_summary": "FedRAMP Secure Inbox operates via SNS topics with email forwarding to security@meridianks.com. Alerts from GuardDuty, SecurityHub, and CloudWatch route through dedicated security topics with <1hr SLA.",
      "justification": "Validates FSI Operations. Checks for: 1) The Security Inbox Procedure Document (Governance), and 2) The SNS Topic used to aggregate and forward internal alerts to that inbox (Technical infrastructure).",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path procedures/security-inbox-procedures.md --output json; aws sns list-topics --query \"Topics[?contains(TopicArn, 'security') || contains(TopicArn, 'alert') || contains(TopicArn, 'admin')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747517Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-08/codecommit_045715_7578.json",
      "total_category_controls": 8,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the existence of the Security Inbox Procedures document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/security-inbox-procedures.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.02s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "INFRASTRUCTURE: Validate existence of an SNS Topic used to forward AWS alerts to the security inbox.",
          "command": "aws sns list-topics --query \"Topics[?contains(TopicArn, 'security') || contains(TopicArn, 'alert') || contains(TopicArn, 'admin')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.79s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-09",
      "validation_id": "KSI-AFR-09",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently validate security posture using automated pipelines.",
      "implementation_summary": "Automated validation runs via GitHub Actions (master-validator.yml) with 76% CI success rate. Pipeline validates all 61 KSIs, generates compliance artifacts, and publishes to Trust Center. Execution logs retained 90+ days.",
      "justification": "Validates Automated Pipeline Artifacts. Checks for: 1) The Validation Architecture Diagram (Governance), and 2) The 'unified_ksi_validations.json' artifact in the S3 'data/' folder. This proves the Master Validator pipeline is successfully executing and actively refreshing the compliance data served by the Trust Center.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/fedramp-phase2-validation-architecture.mmd --output json; aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/unified_ksi_validations.json --output json",
      "timestamp": "2026-02-19T04:59:59.747525Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-09/codecommit_045715_6333.json",
      "total_category_controls": 9,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "ARCHITECTURE: Validate the existence of the Validation Architecture Diagram.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path authorization_by_fedramp/fedramp-phase2-validation-architecture.mmd --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "EXECUTION: Validate existence (and freshness) of the Master Validation artifact in the production compliance bucket.",
          "command": "aws s3api head-object --bucket fedramp-compliance-893894210484 --key data/unified_ksi_validations.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-AFR-10",
      "validation_id": "KSI-AFR-10",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 6 items: 6 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Integrate FedRAMP's Incident Communications Procedures (ICP) into incident response procedures and infrastructure.",
      "implementation_summary": "ICP integration uses GitHub Actions for automated FedRAMP/CISA notification within 1 hour of incident detection. Playbooks in CodeCommit define escalation paths for Critical, High, and standard incidents.",
      "justification": "Validates ICP Readiness. Checks for: 1) The ICP Playbook and IR Plan (Governance), and 2) Dedicated Security SNS Topics (Infrastructure). Filtering the SNS topics specifically for 'security', 'incident', or 'alert' proves that a dedicated communication channel exists for high-priority events.",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path procedures/icp_playbook.md --output json; aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json; aws sns list-topics --query \"Topics[?contains(TopicArn, 'security') || contains(TopicArn, 'incident') || contains(TopicArn, 'alert')]\" --output json; aws sns list-subscriptions --query \"Subscriptions[?contains(TopicArn, 'security') || contains(TopicArn, 'incident') || contains(TopicArn, 'alert')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747534Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-AFR-10/codecommit_045715_3330.json",
      "total_category_controls": 10,
      "resources_scanned": 6,
      "resources_passed": 6,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the FedRAMP Incident Communications Procedure (ICP) Playbook.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/icp_playbook.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.01s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "GOVERNANCE: Validate the master Incident Response Plan.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.99s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "INFRASTRUCTURE: Validate existence of dedicated SNS topics for Security Incidents.",
          "command": "aws sns list-topics --query \"Topics[?contains(TopicArn, 'security') || contains(TopicArn, 'incident') || contains(TopicArn, 'alert')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "REACHABILITY: Validate that the security topics have active subscriptions (email/SMS/Lambda) to ensure alerts are actually delivered.",
          "command": "aws sns list-subscriptions --query \"Subscriptions[?contains(TopicArn, 'security') || contains(TopicArn, 'incident') || contains(TopicArn, 'alert')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.80s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-AFR-11",
      "validation_id": "KSI-AFR-11",
      "assertion": true,
      "assertion_reason": "\u2705 Good (88%): 9 items: 8 verified, 1 failed",
      "recommended_action": "\u2705 Good compliance. Consider remediating 1 non-compliant resource to reach excellent status (\u226590%).",
      "requirement": "Ensure that cryptographic modules are selected and used in alignment with the FedRAMP 20x Using Cryptographic Modules (UCM) policy.",
      "implementation_summary": "Cryptography uses AWS KMS with AES-256 for data at rest (S3, RDS, EBS). TLS 1.2+ enforced on ALB listeners. FIPS 140-2 validated modules via AWS GovCloud-compatible services.",
      "justification": "Validates Applied Cryptography. Checks for: 1) Active KMS Keys (Key Management), 2) S3 Encryption on the Compliance Bucket (Data at Rest), 3) RDS Encryption (Data at Rest), and 4) Active Load Balancer Listeners enforcing TLS 1.2+ (Data in Transit/FIPS alignment).",
      "long_name": "Authorization by FedRAMP",
      "category_prefix": "KSI-AFR",
      "cli_command": "aws kms list-keys --limit 5 --output json; aws s3api get-bucket-encryption --bucket fedramp-compliance-893894210484 --output json; aws rds describe-db-instances --output json; aws elbv2 describe-listeners --load-balancer-arn $(aws elbv2 describe-load-balancers --query \"LoadBalancers[0].LoadBalancerArn\" --output text) --output json || echo \"[]\"; aws codecommit get-file --repository-name security-governance --file-path policies/cryptographic-modules-policy.md --output json",
      "timestamp": "2026-02-19T04:59:59.747542Z",
      "score": 88,
      "evidence_path": "evidence_v2/KSI-AFR-11/kms_045715_4845.json",
      "total_category_controls": 11,
      "resources_scanned": 9,
      "resources_passed": 8,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "KEY MANAGEMENT: Validate that KMS keys exist and are available for cryptographic operations.",
          "command": "aws kms list-keys --limit 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.78s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "DATA AT REST (STORAGE): Validate that the Compliance Artifact Bucket enforces server-side encryption (SSE-S3 or SSE-KMS).",
          "command": "aws s3api get-bucket-encryption --bucket fedramp-compliance-893894210484 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "DATA AT REST (DATABASE): Validate that all RDS instances have 'StorageEncrypted' set to true.",
          "command": "aws rds describe-db-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "DATA IN TRANSIT: Validate that Load Balancer Listeners are configured with secure SSL Policies (TLS 1.2+).",
          "command": "aws elbv2 describe-listeners --load-balancer-arn $(aws elbv2 describe-load-balancers --query \"LoadBalancers[0].LoadBalancerArn\" --output text) --output json || echo \"[]\"",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.66s",
          "error_message": null
        },
        {
          "index": 4,
          "description": "GOVERNANCE: Validate the existence of the Cryptographic Modules (UCM) Policy.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/cryptographic-modules-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.05s",
          "error_message": null
        }
      ],
      "commands_executed": 5,
      "successful_commands": 5
    },
    {
      "ksi_id": "KSI-CED-01",
      "validation_id": "KSI-CED-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the effectiveness of training given to all employees on policies, procedures, and security-related topics.",
      "implementation_summary": "Training tracked via GitOps - employees commit signed attestations to training/register.json after completing security awareness modules. CTF-style challenge tokens prove active engagement.",
      "justification": "Validates 'GitOps' Security Training. Instead of passive LMS logs, this validates the 'training/register.json' in the governance repo. This proves staff have actively attested to security training by decoding a challenge token (CTF style) and committing it to the immutable version control history.",
      "long_name": "Cybersecurity Education",
      "category_prefix": "KSI-CED",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path training/register.json --output json; aws codecommit get-file --repository-name security-governance --file-path training/security-refresh.md --output json",
      "timestamp": "2026-02-19T04:59:59.747550Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CED-01/codecommit_045715_3652.json",
      "total_category_controls": 1,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVIDENCE: Validate the Training Register. The file must contain user commits with the correct decoded flag, proving active engagement.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/register.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CURRICULUM: Validate the existence of the Training Challenge Instructions (The 'Lesson Plan').",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/security-refresh.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CED-02",
      "validation_id": "KSI-CED-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the effectiveness of role-specific training given to employees in high risk roles, including at least roles with privileged access.",
      "implementation_summary": "Privileged user training requires completion of AWS Skill Builder IAM Deep Dive course. Attestations stored in training/privileged_register.json with commit signatures.",
      "justification": "Validates 'GitOps' Privileged User Training. Checks the 'training/privileged_register.json' file, which serves as a segregated training record for high-risk roles. Presence of signed commits here proves that privileged users have completed the 'Deep Dive with Security: IAM' module and attested to the responsibilities defined in the Privileged Access Guide.",
      "long_name": "Cybersecurity Education",
      "category_prefix": "KSI-CED",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path training/privileged_register.json --output json; aws codecommit get-file --repository-name security-governance --file-path training/privileged-access-guide.md --output json",
      "timestamp": "2026-02-19T04:59:59.747557Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CED-02/codecommit_045715_8591.json",
      "total_category_controls": 2,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVIDENCE: Validate the Privileged User Training Register. Entries here confirm acknowledgement of high-risk responsibilities and completion of the IAM Deep Dive.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/privileged_register.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.97s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CURRICULUM: Validate the existence of the Privileged Access Guide containing the link to the mandatory AWS Skill Builder IAM course.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/privileged-access-guide.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CED-03",
      "validation_id": "KSI-CED-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the effectiveness of role-specific training given to development and engineering staff that covers best practices for delivering secure software.",
      "implementation_summary": "Developer security training covers OWASP Top 10, secure coding in Python/TypeScript, and Checkov IaC scanning. Attestations in training/developer_register.json.",
      "justification": "Validates 'GitOps' Developer Security Training. Checks the 'training/developer_register.json' file. This proves engineering staff have reviewed the existing 'secure-software-development.md' policy and attested to understanding secure delivery practices via version control.",
      "long_name": "Cybersecurity Education",
      "category_prefix": "KSI-CED",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path training/developer_register.json --output json; aws codecommit get-file --repository-name security-governance --file-path policies/secure-software-development.md --output json",
      "timestamp": "2026-02-19T04:59:59.747564Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CED-03/codecommit_045715_8785.json",
      "total_category_controls": 3,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVIDENCE: Validate the Developer Training Register. Entries here confirm engineering staff have acknowledged the secure software development policy.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/developer_register.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CURRICULUM: Validate the existence of the Secure Software Development policy.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/secure-software-development.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CED-04",
      "validation_id": "KSI-CED-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the effectiveness of role-specific training given to staff involved with incident response or disaster recovery.",
      "implementation_summary": "IR/DR training requires review of incident-response-plan.md and participation in tabletop exercises. Attestations tracked in training/ir_dr_register.json.",
      "justification": "Validates 'GitOps' IR/DR Training. Checks the 'training/ir_dr_register.json' file. This proves that designated Incident Responders have reviewed the Incident Response Plan and attested to their readiness via version control commits, satisfying the requirement for role-specific IR/DR training effectiveness monitoring.",
      "long_name": "Cybersecurity Education",
      "category_prefix": "KSI-CED",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path training/ir_dr_register.json --output json; aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json",
      "timestamp": "2026-02-19T04:59:59.747570Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CED-04/codecommit_045715_6066.json",
      "total_category_controls": 4,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVIDENCE: Validate the IR/DR Training Register. Entries here confirm the IR team has reviewed the active response procedures.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path training/ir_dr_register.json --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CURRICULUM: Validate the existence of the Incident Response Plan (The core training material).",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/incident-response-plan.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CMT-01",
      "validation_id": "KSI-CMT-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Log and monitor modifications to the cloud service offering.",
      "implementation_summary": "All modifications logged via CloudTrail (management events) and AWS Config (resource state). Change management policy requires Terraform-only changes with PR approval.",
      "justification": "Validates Change Logging. Checks for: 1) Active CloudTrail (Logs the API calls/modifications), 2) Active AWS Config Recorder (Logs the resource state changes), and 3) The Change Management Policy.",
      "long_name": "Change Management",
      "category_prefix": "KSI-CMT",
      "cli_command": "aws cloudtrail describe-trails --output json; aws cloudtrail get-event-selectors --trail-name $(aws cloudtrail describe-trails --query 'trailList[0].TrailARN' --output text) --output json; aws configservice describe-configuration-recorder-status --output json; aws codecommit get-file --repository-name security-governance --file-path policies/change-management-policy.md --output json",
      "timestamp": "2026-02-19T04:59:59.747577Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CMT-01/cloudtrail_045715_6716.json",
      "total_category_controls": 1,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "AUDIT: Validate existence of CloudTrail trails (The primary change logger).",
          "command": "aws cloudtrail describe-trails --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "SCOPE: Validate that the trail is recording 'Management Events' (Read/Write API calls).",
          "command": "aws cloudtrail get-event-selectors --trail-name $(aws cloudtrail describe-trails --query 'trailList[0].TrailARN' --output text) --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.62s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "TRACKING: Validate that AWS Config is actively recording resource changes (Recording: true).",
          "command": "aws configservice describe-configuration-recorder-status --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "GOVERNANCE: Validate the Change Management Policy document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/change-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.97s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-CMT-02",
      "validation_id": "KSI-CMT-02",
      "assertion": true,
      "assertion_reason": "\u2705 Good (83%): 6 items: 5 verified, 1 failed",
      "recommended_action": "\u2705 Good compliance. Consider remediating 1 non-compliant resource to reach excellent status (\u226590%).",
      "requirement": "Execute changes to machine-based information resources through redeployment of version controlled immutable resources rather than direct modification wherever possible.",
      "implementation_summary": "Infrastructure deployed exclusively via Terraform with state stored in S3 (mks-states bucket) and DynamoDB locking. No console changes permitted in production.",
      "justification": "Validates Infrastructure as Code (IaC). Since ASGs are not used, this validates that changes are managed via Terraform State (Version Control) and State Locking (Concurrency Control), ensuring changes are tracked in code rather than manual console actions.",
      "long_name": "Change Management",
      "category_prefix": "KSI-CMT",
      "cli_command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'terraform') || contains(Name, 'state') || contains(Name, 'tfstate')]\" --output json; aws dynamodb list-tables --query \"TableNames[?contains(@, 'terraform') || contains(@, 'lock') || contains(@, 'state')]\" --output json; aws ec2 describe-instances --filters Name=instance-state-name,Values=running --output json; aws codecommit get-file --repository-name security-governance --file-path policies/configuration-management-policy.md --output json",
      "timestamp": "2026-02-19T04:59:59.747585Z",
      "score": 83,
      "evidence_path": "evidence_v2/KSI-CMT-02/ec2_045715_5112.json",
      "total_category_controls": 2,
      "resources_scanned": 6,
      "resources_passed": 5,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "VERSION CONTROL: Validate existence of the Terraform State bucket (Proof that infrastructure is defined as code).",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'terraform') || contains(Name, 'state') || contains(Name, 'tfstate')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "MANAGEMENT: Validate existence of the Terraform Lock Table (Proof of active, safe IaC workflows).",
          "command": "aws dynamodb list-tables --query \"TableNames[?contains(@, 'terraform') || contains(@, 'lock') || contains(@, 'state')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "INVENTORY: List the active EC2 instances managed by this Terraform state.",
          "command": "aws ec2 describe-instances --filters Name=instance-state-name,Values=running --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.05s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "GOVERNANCE: Validate the policy that mandates Terraform usage for all production changes.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/configuration-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-CMT-03",
      "validation_id": "KSI-CMT-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Automate persistent testing and validation of changes throughout deployment.",
      "implementation_summary": "Changes validated by Checkov scans in CI pipeline before deployment. AWS Config rules provide continuous drift detection post-deployment.",
      "justification": "Validates the Hybrid Compliance Strategy. Checks for: 1) Active AWS Config Recorder (The Persistent Monitor), 2) Active Config Rules (The Validation Logic), and 3) The Testing Policy (Governance of the CI/CD pipeline).",
      "long_name": "Change Management",
      "category_prefix": "KSI-CMT",
      "cli_command": "aws configservice describe-configuration-recorder-status --output json; aws configservice describe-config-rules --query \"ConfigRules[?RuleState=='ACTIVE']\" --max-items 5 --output json; aws codecommit get-file --repository-name security-governance --file-path policies/sdlc-policy.md --output json",
      "timestamp": "2026-02-19T04:59:59.747592Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CMT-03/configservice_045715_6127.json",
      "total_category_controls": 3,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "MONITOR: Validate that the Configuration Recorder is recording (The engine for persistent validation).",
          "command": "aws configservice describe-configuration-recorder-status --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "VALIDATION: Validate existence of active Config Rules that enforce security policies on live resources.",
          "command": "aws configservice describe-config-rules --query \"ConfigRules[?RuleState=='ACTIVE']\" --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "GOVERNANCE: Validate the SDLC Policy which mandates 'Automated Testing' (Checkov) before deployment.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/sdlc-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.96s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CMT-04",
      "validation_id": "KSI-CMT-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the effectiveness of documented change management procedures.",
      "implementation_summary": "Change management effectiveness measured via Terraform state version history and CloudTrail event analysis. All changes traceable to specific PRs and approvers.",
      "justification": "Validates Adherence to Procedure via State History. Checks for: 1) The Change Management Procedure Document (Governance) and 2) Terraform State File Version History (Technical proof of sequential, tracked changes to infrastructure).",
      "long_name": "Change Management",
      "category_prefix": "KSI-CMT",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path procedures/change-management-procedure.md --output json; aws s3api list-objects-v2 --bucket mks-states --prefix terraform.tfstate --max-items 1 --output json",
      "timestamp": "2026-02-19T04:59:59.747599Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CMT-04/codecommit_045715_8978.json",
      "total_category_controls": 4,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the existence of the Change Management Procedure document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path procedures/change-management-procedure.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "IMMUTABILITY: List Terraform State file with versioning metadata, proving version-controlled infrastructure changes.",
          "command": "aws s3api list-objects-v2 --bucket mks-states --prefix terraform.tfstate --max-items 1 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-CNA-01",
      "validation_id": "KSI-CNA-01",
      "assertion": true,
      "assertion_reason": "\u2705 Good (85%): 7 items: 6 verified, 1 failed",
      "recommended_action": "\u2705 Good compliance. Consider remediating 1 non-compliant resource to reach excellent status (\u226590%).",
      "requirement": "Persistently ensure all machine-based information resources are configured to limit inbound and outbound network traffic.",
      "implementation_summary": "Network traffic limited via Security Groups (default SG empty, specific allow-lists only) and NACLs at subnet boundaries. All ingress flows through ALB.",
      "justification": "Validates Network Traffic Limiting. Checks for: 1) The 'default' Security Group (Baseline Hygiene - should be empty), 2) Active Security Groups (Specific Ingress/Egress Rules), and 3) Network ACLs (Subnet Boundary Control).",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws ec2 describe-security-groups --filters Name=group-name,Values=default --output json; aws ec2 describe-security-groups --filters Name=ip-permission.protocol,Values=tcp --max-items 5 --output json; aws ec2 describe-network-acls --max-items 5 --output json",
      "timestamp": "2026-02-19T04:59:59.747606Z",
      "score": 85,
      "evidence_path": "evidence_v2/KSI-CNA-01/ec2_045715_8793.json",
      "total_category_controls": 1,
      "resources_scanned": 7,
      "resources_passed": 6,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "BASELINE: Validate that the 'default' VPC Security Group restricts all traffic (Best practice is to leave this empty/unused).",
          "command": "aws ec2 describe-security-groups --filters Name=group-name,Values=default --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.13s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "ACTIVE CONTROLS: Validate a sample of active Security Groups to verify specific port restrictions (Limit Inbound).",
          "command": "aws ec2 describe-security-groups --filters Name=ip-permission.protocol,Values=tcp --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.03s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "BOUNDARY: Validate Network ACLs which provide a stateless traffic filter at the subnet level.",
          "command": "aws ec2 describe-network-acls --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.03s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-02",
      "validation_id": "KSI-CNA-02",
      "assertion": true,
      "assertion_reason": "\u2705 Good (86%): 22 items: 19 verified, 3 failed",
      "recommended_action": "\u2705 Good compliance. Consider remediating 3 non-compliant resources to reach excellent status (\u226590%).",
      "requirement": "Persistently ensure machine-based information resources have a minimal attack surface and that lateral movement is minimized if compromised.",
      "implementation_summary": "Attack surface minimized via private subnets for compute/database, Security Group references (no IP-based rules), and RDS PubliclyAccessible=false.",
      "justification": "Validates Network Segmentation and Isolation. Checks for: 1) Private Subnets (Attack Surface Reduction), 2) Security Group References (Prevention of Lateral Movement by binding rules to logical groups, not IPs), and 3) Private Database Placement.",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws ec2 describe-subnets --filters \"Name=map-public-ip-on-launch,Values=false\" --max-items 5 --output json; aws ec2 describe-security-groups --max-items 20 --output json; aws rds describe-db-instances --output json",
      "timestamp": "2026-02-19T04:59:59.747615Z",
      "score": 86,
      "evidence_path": "evidence_v2/KSI-CNA-02/ec2_045715_5063.json",
      "total_category_controls": 2,
      "resources_scanned": 22,
      "resources_passed": 19,
      "resources_failed": 3,
      "command_executions": [
        {
          "index": 0,
          "description": "ATTACK SURFACE: Validate the existence of Private Subnets (where Public IP mapping is disabled).",
          "command": "aws ec2 describe-subnets --filters \"Name=map-public-ip-on-launch,Values=false\" --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.08s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "LATERAL MOVEMENT: Validate Security Groups that allow access ONLY from other specific Security Groups (Tiered Security), rather than broad IP ranges.",
          "command": "aws ec2 describe-security-groups --max-items 20 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.04s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "ISOLATION: Validate that RDS Databases are configured as 'PubliclyAccessible: false' and reside in defined subnets.",
          "command": "aws rds describe-db-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.01s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-03",
      "validation_id": "KSI-CNA-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 9 items: 9 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use logical networking and related capabilities to enforce traffic flow controls.",
      "implementation_summary": "Traffic flow enforced via VPC Endpoints (S3, DynamoDB), NAT Gateway for egress, and ALB for ingress. No direct internet access from compute tier.",
      "justification": "Validates Logical Traffic Enforcement. Checks for: 1) VPC Endpoints (Enforces private connectivity to AWS services), 2) NAT Gateways (Enforces centralized egress), and 3) Load Balancer Schemes (Enforces defined entry points).",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws ec2 describe-vpc-endpoints --output json; aws ec2 describe-nat-gateways --filter Name=state,Values=available --output json; aws elbv2 describe-load-balancers --output json",
      "timestamp": "2026-02-19T04:59:59.747622Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CNA-03/ec2_045715_7466.json",
      "total_category_controls": 3,
      "resources_scanned": 9,
      "resources_passed": 9,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIVATE FLOW: Validate existence of VPC Endpoints, ensuring traffic to services like S3/DynamoDB bypasses the public internet.",
          "command": "aws ec2 describe-vpc-endpoints --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.07s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "EGRESS CONTROL: Validate active NAT Gateways. This proves instances in private subnets route outbound traffic centrally, rather than having individual Public IPs.",
          "command": "aws ec2 describe-nat-gateways --filter Name=state,Values=available --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.00s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "INGRESS CONTROL: Validate Load Balancers. The 'Scheme' (internet-facing vs internal) proves that ingress traffic is logically separated and managed.",
          "command": "aws elbv2 describe-load-balancers --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-04",
      "validation_id": "KSI-CNA-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 77 items: 77 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use immutable infrastructure with strictly defined functionality and privileges by default.",
      "implementation_summary": "Immutable infrastructure via Terraform. EC2 instances replaced (not modified) on updates. IAM roles follow least-privilege with no wildcard permissions.",
      "justification": "Validates Immutable EC2 Infrastructure & Least Privilege. Checks for: 1) Terraform State (Proof of immutable IaC management), 2) Security Groups (Strict network functionality), and 3) Custom IAM Roles (Strictly defined privileges, excluding default AWS service roles).",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws s3api list-objects-v2 --bucket mks-states --prefix terraform.tfstate --max-items 1 --output json; aws ec2 describe-security-groups --filters Name=ip-permission.protocol,Values=-1 --output json; aws iam list-roles --query \"Roles[?!(contains(RoleName, 'AWSServiceRole') || contains(Path, '/aws-service-role/'))]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747634Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CNA-04/s3api_045715_52.json",
      "total_category_controls": 4,
      "resources_scanned": 77,
      "resources_passed": 77,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "IMMUTABILITY: List Terraform State file with versioning metadata, proving version-controlled infrastructure changes.",
          "command": "aws s3api list-objects-v2 --bucket mks-states --prefix terraform.tfstate --max-items 1 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "FUNCTIONALITY: Check for Security Groups allowing 'All Traffic' (-1). Absence of these proves strictly defined network functionality.",
          "command": "aws ec2 describe-security-groups --filters Name=ip-permission.protocol,Values=-1 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.04s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "PRIVILEGE: Audit Custom IAM Roles. This focuses the scan on roles you created, verifying they follow least-privilege principles.",
          "command": "aws iam list-roles --query \"Roles[?!(contains(RoleName, 'AWSServiceRole') || contains(Path, '/aws-service-role/'))]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-05",
      "validation_id": "KSI-CNA-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 6 items: 6 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the effectiveness of protection against denial of service attacks and other unwanted activity.",
      "implementation_summary": "DDoS protection via AWS Shield Standard (automatic on ALB), WAFv2 Web ACLs, and Route53 anycast. SES handles email with DKIM/SPF validation.",
      "justification": "Validates DDoS & Spoofing Defense. Checks for: 1) Regional WAF (Layer 7 Defense), 2) Load Balancers (Layer 3/4 Defense via AWS Shield Standard), and 3) Validated Email Identities (Spoofing protection via SES/DKIM).",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws wafv2 list-web-acls --scope REGIONAL --output json; aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, DNS:DNSName, Shield: 'Enabled (Standard)'}\" --output json; aws route53 list-hosted-zones --max-items 5 --output json; aws ses list-identities --max-items 5 --output json",
      "timestamp": "2026-02-19T04:59:59.747641Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CNA-05/wafv2_045715_5160.json",
      "total_category_controls": 5,
      "resources_scanned": 6,
      "resources_passed": 6,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "DDOS LAYER 7: Validate existence of Web Application Firewalls (WAF) to block malicious requests.",
          "command": "aws wafv2 list-web-acls --scope REGIONAL --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.89s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "DDOS LAYER 3/4: Validate Load Balancers. All ALBs act as the perimeter and automatically benefit from AWS Shield Standard.",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, DNS:DNSName, Shield: 'Enabled (Standard)'}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "DNS RESILIENCE: Validate Route53 usage (AWS AnyCast network provides DNS flood protection).",
          "command": "aws route53 list-hosted-zones --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.96s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "SPOOFING: Validate SES Identities. If email is sent, this checks for authorized identities (DKIM/SPF managed).",
          "command": "aws ses list-identities --max-items 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-CNA-06",
      "validation_id": "KSI-CNA-06",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Appropriately optimize machine-based information resources for high availability and rapid recovery.",
      "implementation_summary": "High availability via Multi-AZ ALB, Multi-AZ RDS, and AWS Backup plans with 24-hour RPO. RTO target: 4 hours for full recovery.",
      "justification": "Validates Multi-AZ High Availability. Checks for: 1) Load Balancers spanning multiple AZs (Network HA), 2) RDS instances with Multi-AZ enabled (Database HA), and 3) Active AWS Backup Plans (Recovery Capability).",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws elbv2 describe-load-balancers --output json; aws rds describe-db-instances --output json; aws backup list-backup-plans --output json",
      "timestamp": "2026-02-19T04:59:59.747647Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CNA-06/elbv2_045715_5025.json",
      "total_category_controls": 6,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "NETWORK HA: Validate that Load Balancers are configured across multiple Availability Zones.",
          "command": "aws elbv2 describe-load-balancers --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "DATABASE HA: Validate that critical RDS instances have Multi-AZ enabled for automatic failover.",
          "command": "aws rds describe-db-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.02s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "RECOVERY: Validate existence of Backup Plans to support rapid data recovery.",
          "command": "aws backup list-backup-plans --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-CNA-07",
      "validation_id": "KSI-CNA-07",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (97%): 34 items: 33 verified, 1 failed",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently ensure cloud-native machine-based information resources are implemented based on the host providers best practices and documented guidance.",
      "implementation_summary": "Cloud-native architecture: 21 Lambda functions, 1 managed RDS, API Gateway. Legacy EC2 (5 instances) hardened with IMDSv2, no public IPs, VPC-only Lambdas.",
      "justification": "Validates cloud-native maturity by comparing the ratio of legacy infrastructure (EC2) versus modern managed services (Lambda, RDS, API Gateway, etc).",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws ec2 describe-instances --output json; aws lambda list-functions --output json; aws rds describe-db-instances --output json; aws apigateway get-rest-apis --output json; aws elbv2 describe-load-balancers --output json; aws autoscaling describe-auto-scaling-groups --output json",
      "timestamp": "2026-02-19T04:59:59.747657Z",
      "score": 97,
      "evidence_path": "evidence_v2/KSI-CNA-07/ec2_045715_2328.json",
      "total_category_controls": 7,
      "resources_scanned": 34,
      "resources_passed": 33,
      "resources_failed": 1,
      "command_executions": [
        {
          "index": 0,
          "description": "BASELINE: Measure legacy compute footprint (Denominator) to compare against managed service adoption.",
          "command": "aws ec2 describe-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.07s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "ACCELERATOR: Validate adoption of serverless compute (High Impact).",
          "command": "aws lambda list-functions --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.03s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "ACCELERATOR: Validate use of fully managed databases vs self-hosted DBs.",
          "command": "aws rds describe-db-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "ACCELERATOR: Validate use of managed API hosting infrastructure.",
          "command": "aws apigateway get-rest-apis --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 4,
          "description": "ACCELERATOR: Validate use of managed application networking.",
          "command": "aws elbv2 describe-load-balancers --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        },
        {
          "index": 5,
          "description": "ACCELERATOR: Validate use of dynamic scaling/statelessness vs static servers.",
          "command": "aws autoscaling describe-auto-scaling-groups --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        }
      ],
      "commands_executed": 6,
      "successful_commands": 6
    },
    {
      "ksi_id": "KSI-CNA-08",
      "validation_id": "KSI-CNA-08",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 33 items: 33 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use automated services to persistently assess the security posture of all machine-based information resources and automatically enforce their intended operational state.",
      "implementation_summary": "Security posture assessed by SecurityHub (CIS/FedRAMP standards), GuardDuty (threat detection), AWS Config (compliance rules), and Inspector (vulnerability scanning).",
      "justification": "Validates that the 'Immune System' of the cloud is active by checking for enabled Security Hub Standards, GuardDuty Detectors, and Config Recorders.",
      "long_name": "Cloud Native Architecture",
      "category_prefix": "KSI-CNA",
      "cli_command": "aws securityhub get-enabled-standards --output json; aws guardduty list-detectors --output json; aws configservice describe-configuration-recorders --output json; aws inspector2 list-coverage --output json",
      "timestamp": "2026-02-19T04:59:59.747666Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-CNA-08/securityhub_045715_1417.json",
      "total_category_controls": 8,
      "resources_scanned": 33,
      "resources_passed": 33,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate that Security Hub is active and enforcing specific compliance standards (CIS, PCI, etc).",
          "command": "aws securityhub get-enabled-standards --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.34s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate that GuardDuty is enabled (Detector ID exists) for automated threat detection.",
          "command": "aws guardduty list-detectors --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Validate that AWS Config is actively recording resource changes for persistent assessment.",
          "command": "aws configservice describe-configuration-recorders --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.80s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "Validate that Amazon Inspector is actively scanning resources (EC2/ECR/Lambda).",
          "command": "aws inspector2 list-coverage --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.06s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-IAM-01",
      "validation_id": "KSI-IAM-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Enforce multi-factor authentication (MFA) using methods that are difficult to intercept or impersonate (phishing-resistant MFA) for all user authentication.",
      "implementation_summary": "MFA enforced for all human users via AWS Identity Center with FIDO2/WebAuthn support. Break-glass IAM users require hardware tokens.",
      "justification": "Validates MFA compliance by filtering for users who actively log in via password (Humans) and verifying Identity Center usage. Excludes API-only service accounts.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws iam list-users --query \"Users[?PasswordLastUsed!=null]\" --output json; aws sso-admin list-instances --output json; aws iam list-virtual-mfa-devices --output json",
      "timestamp": "2026-02-19T04:59:59.747673Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-01/ssoadmin_045715_6123.json",
      "total_category_controls": 1,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "FILTERED: Retrieve only IAM Users who have active password usage (Humans).",
          "command": "aws iam list-users --query \"Users[?PasswordLastUsed!=null]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Verify that AWS Identity Center is the primary identity platform.",
          "command": "aws sso-admin list-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.89s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Get list of all Virtual MFA devices to validate protection (replaces list-mfa-devices which requires user).",
          "command": "aws iam list-virtual-mfa-devices --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-IAM-02",
      "validation_id": "KSI-IAM-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use secure passwordless methods for user authentication and authorization when feasible, otherwise enforce strong passwords with MFA.",
      "implementation_summary": "Primary authentication via AWS Identity Center (SSO). Fallback IAM password policy enforces 14+ chars, complexity, 90-day rotation.",
      "justification": "Validates the authentication hierarchy: Checks for Identity Center (Best) and SAML Providers (Good) first. If those are absent, it validates the IAM Password Policy (Fallback) to ensure strong controls are in place.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws sso-admin list-instances --output json; aws iam list-saml-providers --output json; aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": null}'",
      "timestamp": "2026-02-19T04:59:59.747679Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-02/ssoadmin_045715_6123.json",
      "total_category_controls": 2,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "MODERN: Validate presence of AWS Identity Center (Single Sign-On).",
          "command": "aws sso-admin list-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "LEGACY/FEDERATED: Validate presence of external Identity Providers (Okta, Azure AD).",
          "command": "aws iam list-saml-providers --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "FALLBACK: Validate that if passwords ARE used, the policy enforces complexity and rotation.",
          "command": "aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": null}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.80s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-IAM-03",
      "validation_id": "KSI-IAM-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 76 items: 76 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Enforce appropriately secure authentication methods for non-user accounts and services.",
      "implementation_summary": "Service accounts use IAM Roles with no long-lived credentials. Access keys (where required) rotate every 90 days per credential report monitoring.",
      "justification": "Validates the security of machine identities. Filters out AWS-managed roles to focus strictly on Customer Roles (Trust Policies) and Service Accounts (Access Keys).",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws iam list-roles --query \"Roles[?!(contains(RoleName, 'AWSServiceRole') || contains(Path, '/aws-service-role/'))]\" --output json; aws iam list-users --query \"Users[?PasswordLastUsed==null]\" --output json; aws iam get-credential-report --output text > /dev/null && aws iam get-credential-report --output json || echo '{\"Content\": \"Permission Denied\"}'",
      "timestamp": "2026-02-19T04:59:59.747690Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-03/iam_045715_3915.json",
      "total_category_controls": 3,
      "resources_scanned": 76,
      "resources_passed": 76,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate Trust Policies for CUSTOMER managed roles only.",
          "command": "aws iam list-roles --query \"Roles[?!(contains(RoleName, 'AWSServiceRole') || contains(Path, '/aws-service-role/'))]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.93s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate Service Accounts (Bots) that do not have console access (should rely on keys/roles).",
          "command": "aws iam list-users --query \"Users[?PasswordLastUsed==null]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Deep inspection of access key rotation status for service accounts.",
          "command": "aws iam get-credential-report --output text > /dev/null && aws iam get-credential-report --output json || echo '{\"Content\": \"Permission Denied\"}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.68s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-IAM-04",
      "validation_id": "KSI-IAM-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Require a centralized identity management system.",
      "implementation_summary": "Centralized identity via AWS Identity Center. Legacy IAM users audited and minimized (target: 0 human IAM users).",
      "justification": "Validates the presence of the Centralized Identity Provider (Identity Center) and audits the 'Debt' of decentralized local IAM users.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws sso-admin list-instances --output json; aws iam list-users --query \"Users[?PasswordLastUsed!=null]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747696Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-04/ssoadmin_045715_6123.json",
      "total_category_controls": 4,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate that AWS Identity Center (SSO) is configured and running.",
          "command": "aws sso-admin list-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "AUDIT: List human users who are bypassing the Centralized System (should be empty or minimal).",
          "command": "aws iam list-users --query \"Users[?PasswordLastUsed!=null]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-IAM-05",
      "validation_id": "KSI-IAM-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently ensure that identity and access management employs measures to ensure each user or device can only access the resources they need.",
      "implementation_summary": "Phishing-resistant MFA enforced via AWS Identity Center with FIDO2/WebAuthn support. Virtual MFA devices audited to identify non-compliant tokens. IAM password policy provides hard-fail backstop if MFA is missing.",
      "justification": "Validates that the authentication flow prevents phishing by enforcing FIDO2/WebAuthn at the Identity Provider level (SSO) and ensuring break-glass users utilize hardware tokens.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws sso-admin list-instances --output json; aws iam list-virtual-mfa-devices --output json; aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": null}'",
      "timestamp": "2026-02-19T04:59:59.747727Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-05/ssoadmin_045715_6123.json",
      "total_category_controls": 5,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate Identity Center configuration for WebAuthn/FIDO2 enforcement.",
          "command": "aws sso-admin list-instances --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "AUDIT: Inventory MFA devices to identify non-FIDO compliant virtual tokens.",
          "command": "aws iam list-virtual-mfa-devices --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Validate that hard-fail measures are in place if MFA is missing.",
          "command": "aws iam get-account-password-policy --output json || echo '{\"PasswordPolicy\": null}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-IAM-06",
      "validation_id": "KSI-IAM-06",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Automatically disable or otherwise secure accounts with privileged access in response to suspicious activity",
      "implementation_summary": "Automated response to suspicious activity via GuardDuty \u2192 EventBridge \u2192 Lambda chain. High-severity findings trigger automatic credential rotation.",
      "justification": "Validates the 'Automated Response' chain: Checks if GuardDuty is watching (Detectors) AND if EventBridge has rules listening to GuardDuty to trigger automated remediation.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws guardduty list-detectors --output json; aws events list-rules --name-prefix GuardDuty --output json",
      "timestamp": "2026-02-19T04:59:59.747736Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-06/guardduty_045715_8515.json",
      "total_category_controls": 6,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "SENSOR: Validate that the Threat Detection sensor is active.",
          "command": "aws guardduty list-detectors --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.80s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "BRAIN: Validate existence of EventBridge rules that listen for GuardDuty signals (evidence of automated response logic).",
          "command": "aws events list-rules --name-prefix GuardDuty --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.79s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-IAM-07",
      "validation_id": "KSI-IAM-07",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Securely manage the lifecycle and privileges of all accounts, roles, and groups, using automation.",
      "implementation_summary": "Account lifecycle managed via credential report monitoring. Stale credentials (>90 days unused) flagged for removal. Termination process documented.",
      "justification": "Validates proper lifecycle management by auditing credential rotation. Instead of listing static roles, it scans the Credential Report for stale passwords (>90 days) and unused access keys.",
      "long_name": "Identity and Access Management",
      "category_prefix": "KSI-IAM",
      "cli_command": "aws iam generate-credential-report > /dev/null && aws iam get-credential-report --output text | base64 --decode || echo 'Permission Denied'; aws iam list-roles --query \"Roles[?CreateDate<='2024-01-01']\" --output json",
      "timestamp": "2026-02-19T04:59:59.747748Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-IAM-07/iam_045715_5281.json",
      "total_category_controls": 7,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Retrieve the full Credential Report to analyze password and key rotation ages.",
          "command": "aws iam generate-credential-report > /dev/null && aws iam get-credential-report --output text | base64 --decode || echo 'Permission Denied'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.67s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "AUDIT: Identify potential 'Zombie Roles' that are older than a specific threshold (adjust date as needed).",
          "command": "aws iam list-roles --query \"Roles[?CreateDate<='2024-01-01']\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.89s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-INR-01",
      "validation_id": "KSI-INR-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review of the effectiveness of documented incident response procedures.",
      "implementation_summary": "IR procedures documented in CodeCommit (security-governance/procedures/). Effectiveness reviewed via tabletop exercises and actual incident metrics.",
      "justification": "Validates the existence of Incident Response documentation. Specifically checks for the existence of a 'Governance as Code' repository containing procedures and playbooks.",
      "long_name": "Incident Response",
      "category_prefix": "KSI-INR",
      "cli_command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'policy') || contains(repositoryName, 'compliance') || contains(repositoryName, 'playbook') || contains(repositoryName, 'security') || contains(repositoryName, 'procedures') || contains(repositoryName, 'runbook')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747756Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-INR-01/codecommit_045715_2418.json",
      "total_category_controls": 1,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate existence of the designated Policy/Runbook repository (filters out application code).",
          "command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'policy') || contains(repositoryName, 'compliance') || contains(repositoryName, 'playbook') || contains(repositoryName, 'security') || contains(repositoryName, 'procedures') || contains(repositoryName, 'runbook')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-INR-02",
      "validation_id": "KSI-INR-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 13 items: 13 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review past incidents for patterns or vulnerabilities.",
      "implementation_summary": "Past incidents logged in CloudWatch Logs and S3 audit buckets. GuardDuty findings provide pattern analysis for recurring threats.",
      "justification": "Validates the existence of centralized incident logging infrastructure. Checks for specific CloudWatch Log Groups and S3 Buckets designated for security/audit data.",
      "long_name": "Incident Response",
      "category_prefix": "KSI-INR",
      "cli_command": "aws logs describe-log-groups --query \"logGroups[?contains(logGroupName, 'security') || contains(logGroupName, 'cloudtrail') || contains(logGroupName, 'audit') || contains(logGroupName, 'incident')]\" --output json; aws s3api list-buckets --query \"Buckets[?contains(Name, 'log') || contains(Name, 'audit') || contains(Name, 'security')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747763Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-INR-02/logs_045715_4577.json",
      "total_category_controls": 2,
      "resources_scanned": 13,
      "resources_passed": 13,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate existence of centralized CloudWatch Log Groups for security events.",
          "command": "aws logs describe-log-groups --query \"logGroups[?contains(logGroupName, 'security') || contains(logGroupName, 'cloudtrail') || contains(logGroupName, 'audit') || contains(logGroupName, 'incident')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate existence of immutable S3 storage for long-term incident retention.",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'log') || contains(Name, 'audit') || contains(Name, 'security')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-INR-03",
      "validation_id": "KSI-INR-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Generate incident after action reports and persistently incorporate lessons learned.",
      "implementation_summary": "After-action reports generated via Lambda function and stored in CodeCommit. Lessons learned incorporated into playbook updates.",
      "justification": "Validates the existence of a 'Lessons Learned' repository. Checks for CodeCommit repositories specifically designated for Post-Incident Analysis (Post-Mortems) or After Action Reports (AAR).",
      "long_name": "Incident Response",
      "category_prefix": "KSI-INR",
      "cli_command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'post-mortem') || contains(repositoryName, 'aar') || contains(repositoryName, 'lessons-learned') || contains(repositoryName, 'incident-reports') || contains(repositoryName, 'reports')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747769Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-INR-03/codecommit_045715_7663.json",
      "total_category_controls": 3,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Validate existence of the designated Post-Mortem/AAR repository.",
          "command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'post-mortem') || contains(repositoryName, 'aar') || contains(repositoryName, 'lessons-learned') || contains(repositoryName, 'incident-reports') || contains(repositoryName, 'reports')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-MLA-01",
      "validation_id": "KSI-MLA-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Log all activity on all information resources supporting the cloud service offering to a protected audit log.",
      "implementation_summary": "All activity logged to CloudTrail (multi-region, S3 delivery). VPC Flow Logs capture network traffic. Log integrity via S3 Object Lock.",
      "justification": "Validates the master audit record. Checks for the existence of an active CloudTrail and the security (ACLs/Encryption) of the specific S3 bucket storing those logs.",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws cloudtrail describe-trails --output json; aws cloudtrail get-trail-status --name $(aws cloudtrail describe-trails --query 'trailList[0].TrailARN' --output text) --output json; aws s3api list-buckets --query \"Buckets[?contains(Name, 'cloudtrail') || contains(Name, 'audit') || contains(Name, 'logs')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747776Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-MLA-01/cloudtrail_045715_6716.json",
      "total_category_controls": 1,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate existence and configuration of the CloudTrail trail.",
          "command": "aws cloudtrail describe-trails --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "STATUS: Confirm CloudTrail is actually 'IsLogging': true. Uses TrailARN to avoid naming conflicts.",
          "command": "aws cloudtrail get-trail-status --name $(aws cloudtrail describe-trails --query 'trailList[0].TrailARN' --output text) --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.71s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "STORAGE: Validate the specific S3 bucket used for audit log retention.",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'cloudtrail') || contains(Name, 'audit') || contains(Name, 'logs')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-MLA-02",
      "validation_id": "KSI-MLA-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 6 items: 6 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review and audit logs.",
      "implementation_summary": "Log review automated via CloudWatch Metric Filters (root login, unauthorized API calls) and SecurityHub Insights for trend analysis.",
      "justification": "Validates 'Automated Review'. Instead of expecting human review, checks for CloudWatch Metric Filters (automated pattern matching) and Security Hub Insights (aggregated analysis).",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws logs describe-metric-filters --output json; aws securityhub get-insights --output json; aws cloudwatch describe-alarms --query \"MetricAlarms[?contains(AlarmName, 'Log') || contains(AlarmName, 'Security') || contains(AlarmName, 'Filter')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747783Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-MLA-02/securityhub_045715_7027.json",
      "total_category_controls": 2,
      "resources_scanned": 6,
      "resources_passed": 6,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate existence of automated log scanning patterns (e.g., 'RootLogin', 'Unauthorized').",
          "command": "aws logs describe-metric-filters --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "SECONDARY: Validate usage of Security Hub for aggregated security trend analysis.",
          "command": "aws securityhub get-insights --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "4.73s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "ALERTING: Validate alarms specifically tied to log metric filters.",
          "command": "aws cloudwatch describe-alarms --query \"MetricAlarms[?contains(AlarmName, 'Log') || contains(AlarmName, 'Security') || contains(AlarmName, 'Filter')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-MLA-05",
      "validation_id": "KSI-MLA-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 12 items: 12 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently evaluate and test the configuration of machine-based information resources, especially infrastructure as code.",
      "implementation_summary": "IaC evaluated via Checkov in CI pipeline. Terraform plans reviewed pre-apply. Config rules detect drift post-deployment.",
      "justification": "Validates the IaC workflow using Terraform artifacts. Checks for '.tfplan' files (Proof of Evaluation/Testing) and '.tfstate' files (Proof of Configuration Management) in the central state bucket.",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws s3 ls s3://mks-states/ --recursive | grep -E '\\.tfstate|\\.tfplan' || echo 'No State Files Found'; aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'infra') || contains(repositoryName, 'terraform')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747790Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-MLA-05/s3_045715_8685.json",
      "total_category_controls": 3,
      "resources_scanned": 12,
      "resources_passed": 12,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Scan the Terraform State bucket. Presence of '.tfplan' proves pre-deployment evaluation; '.tfstate' proves active configuration management.",
          "command": "aws s3 ls s3://mks-states/ --recursive | grep -E '\\.tfstate|\\.tfplan' || echo 'No State Files Found'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "SOURCE: Validate existence of the Infrastructure-as-Code repository.",
          "command": "aws codecommit list-repositories --query \"repositories[?contains(repositoryName, 'infra') || contains(repositoryName, 'terraform')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-MLA-07",
      "validation_id": "KSI-MLA-07",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 11 items: 11 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Maintain a list of information resources and event types that will be monitored, logged, and audited.",
      "implementation_summary": "Resource inventory maintained by AWS Config (continuous recording). Event types defined in CloudTrail event selectors (management + data events).",
      "justification": "Validates the Resource Inventory and Logging Strategy. Checks AWS Config (The Resource List) and CloudTrail/Security Log Groups (The Audit Execution).",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws configservice describe-configuration-recorders --output json; aws cloudtrail describe-trails --output json; aws logs describe-log-groups --query \"logGroups[?contains(logGroupName, 'security') || contains(logGroupName, 'cloudtrail') || contains(logGroupName, 'audit') || contains(logGroupName, 'flow')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747797Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-MLA-07/configservice_045715_6468.json",
      "total_category_controls": 4,
      "resources_scanned": 11,
      "resources_passed": 11,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "INVENTORY: Validate that AWS Config is recording the 'List of Information Resources'.",
          "command": "aws configservice describe-configuration-recorders --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.78s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "EVENTS: Validate that CloudTrail is defining the 'Event Types' to be logged.",
          "command": "aws cloudtrail describe-trails --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "EXECUTION: Validate that the specific Security/Audit logs are actually being captured.",
          "command": "aws logs describe-log-groups --query \"logGroups[?contains(logGroupName, 'security') || contains(logGroupName, 'cloudtrail') || contains(logGroupName, 'audit') || contains(logGroupName, 'flow')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-MLA-08",
      "validation_id": "KSI-MLA-08",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 7 items: 7 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use a least-privileged, role and attribute-based, and just-in-time access authorization model for access to log data.",
      "implementation_summary": "Log access controlled via S3 bucket policies (security team read-only), KMS encryption, and CloudTrail access logging. No broad log access.",
      "justification": "Validates the Log Governance Model. Checks for: 1) The Audit Vault (S3), 2) The Encryption Key (KMS), and 3) The Access Policies (IAM) specifically designed for logging.",
      "long_name": "Monitoring, Logging, and Auditing",
      "category_prefix": "KSI-MLA",
      "cli_command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'security') || contains(Name, 'artifacts') || contains(Name, 'audit') || contains(Name, 'logs')]\" --output json; aws kms list-aliases --query \"Aliases[?contains(AliasName, 'aws/s3') || contains(AliasName, 'key') || contains(AliasName, 'encrypt')]\" --output json; aws iam list-policies --scope Local --query \"Policies[?contains(PolicyName, 'ReadOnly') || contains(PolicyName, 'Audit') || contains(PolicyName, 'Log') || contains(PolicyName, 'View')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747805Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-MLA-08/infrastructurevalidation_045715_1579.json",
      "total_category_controls": 5,
      "resources_scanned": 7,
      "resources_passed": 7,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "VAULT: Validate existence of compliance/security buckets.",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'compliance') || contains(Name, 'security') || contains(Name, 'artifacts') || contains(Name, 'audit') || contains(Name, 'logs')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "LOCK: Validate existence of encryption keys.",
          "command": "aws kms list-aliases --query \"Aliases[?contains(AliasName, 'aws/s3') || contains(AliasName, 'key') || contains(AliasName, 'encrypt')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "PERMIT: Validate existence of access control policies.",
          "command": "aws iam list-policies --scope Local --query \"Policies[?contains(PolicyName, 'ReadOnly') || contains(PolicyName, 'Audit') || contains(PolicyName, 'Log') || contains(PolicyName, 'View')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-PIY-01",
      "validation_id": "KSI-PIY-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use authoritative sources to automatically generate real-time inventories of all information resources when needed.",
      "implementation_summary": "Real-time inventory via AWS Config with automatic discovery. SSM Inventory provides OS-level software lists. Delivery to S3 for analysis.",
      "justification": "Validates the active 'Inventory Engine'. Checks for the AWS Config Recorder (which automatically tracks resource changes) and the Delivery Channel (where the inventory is stored).",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws configservice describe-configuration-recorders --output json; aws configservice describe-delivery-channels --output json; aws ssm list-inventory-entries --instance-id $(aws ec2 describe-instances --query 'Reservations[0].Instances[0].InstanceId' --output text) --type-name AWS:Application --output json || echo '{\"Entries\": []}'",
      "timestamp": "2026-02-19T04:59:59.747811Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-01/configservice_045715_6468.json",
      "total_category_controls": 1,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "PRIMARY: Validate that the Configuration Recorder is active (The 'Authoritative Source').",
          "command": "aws configservice describe-configuration-recorders --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.80s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "STORAGE: Validate that the inventory data is being delivered to a central S3 bucket.",
          "command": "aws configservice describe-delivery-channels --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.77s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "os-LEVEL: Sample check for SSM Inventory data (software list) on a live instance.",
          "command": "aws ssm list-inventory-entries --instance-id $(aws ec2 describe-instances --query 'Reservations[0].Instances[0].InstanceId' --output text) --type-name AWS:Application --output json || echo '{\"Entries\": []}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.90s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-PIY-03",
      "validation_id": "KSI-PIY-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the effectiveness of the providers vulnerability disclosure program.",
      "implementation_summary": "Vulnerability Disclosure Policy (VDP) published at trust.meridianks.com/security.txt and in CodeCommit governance repo.",
      "justification": "Validates the existence of the Vulnerability Disclosure Policy (VDP). Checks the governance repository for files matching standard naming conventions (vdp.md, security.txt, disclosure.md).",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --output json",
      "timestamp": "2026-02-19T04:59:59.747817Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-03/codecommit_045715_4976.json",
      "total_category_controls": 2,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "ARTIFACT: Scan the policies folder for the Disclosure Policy (filters for 'disclosure', 'vdp', or 'security' in filenames).",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.91s",
          "error_message": null
        }
      ],
      "commands_executed": 1,
      "successful_commands": 1
    },
    {
      "ksi_id": "KSI-PIY-04",
      "validation_id": "KSI-PIY-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the effectiveness of building security and privacy considerations into the Software Development Lifecycle and aligning with CISA Secure By Design principles.",
      "implementation_summary": "Secure SDLC enforced via GitHub PR requirements, Checkov scanning, and CodeBuild security projects. CISA Secure by Design principles documented.",
      "justification": "Validates the Secure SDLC. Checks for the specific 'Secure Software Development' policy in CodeCommit and identifies automated security/testing build projects (filtering out standard app builds).",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/secure-software-development.md --output json; aws codebuild list-projects --query \"projects[?contains(@, 'security') || contains(@, 'scan') || contains(@, 'test') || contains(@, 'lint') || contains(@, 'check') || contains(@, 'compliance')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747823Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-04/codecommit_045715_8872.json",
      "total_category_controls": 3,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate existence of the specific Secure SDLC policy document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/secure-software-development.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.00s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "MECHANISM: List only build projects dedicated to security scanning or testing (The Quality Control gates).",
          "command": "aws codebuild list-projects --query \"projects[?contains(@, 'security') || contains(@, 'scan') || contains(@, 'test') || contains(@, 'lint') || contains(@, 'check') || contains(@, 'compliance')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-PIY-06",
      "validation_id": "KSI-PIY-06",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the effectiveness of the organizations investments in achieving security objectives.",
      "implementation_summary": "Security investment effectiveness measured via SecurityHub scores, GuardDuty finding trends, and KSI pass rates over time.",
      "justification": "Validates the Security Effectiveness Program. Checks for the specific 'Security Monitoring and Alerting Plan' (Governance) and active Security Hub Standards (Technical Evidence of Investment).",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/security-objectives/security-monitoring-and-alerting-plan.md --output json; aws securityhub get-enabled-standards --output json",
      "timestamp": "2026-02-19T04:59:59.747829Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-06/codecommit_045715_7588.json",
      "total_category_controls": 4,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the existence of the specific Security Monitoring Plan document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/security-objectives/security-monitoring-and-alerting-plan.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.94s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "INVESTMENT: Validate that Security Hub Standards (CIS, PCI, FedRAMP) are enabled (The automated mechanism for monitoring effectiveness).",
          "command": "aws securityhub get-enabled-standards --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.07s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-PIY-08",
      "validation_id": "KSI-PIY-08",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review executive support for achieving the organizations security objectives.",
      "implementation_summary": "Executive support demonstrated via paid security tools (GuardDuty, SecurityHub, Inspector) and dedicated security budget tracked in AWS Budgets.",
      "justification": "Validates Executive Buy-in via 'Security Investment'. Checks for active, paid enterprise security tools (GuardDuty, Security Hub) that demonstrate financial commitment to the security program.",
      "long_name": "Policy and Inventory",
      "category_prefix": "KSI-PIY",
      "cli_command": "aws guardduty list-detectors --output json; aws securityhub get-enabled-standards --output json; aws budgets describe-budgets --account-id $(aws sts get-caller-identity --query Account --output text) --output json",
      "timestamp": "2026-02-19T04:59:59.747840Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-PIY-08/guardduty_045715_8515.json",
      "total_category_controls": 5,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "INVESTMENT: Validate that GuardDuty is enabled (Paid Threat Detection Service).",
          "command": "aws guardduty list-detectors --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "INVESTMENT: Validate that Security Hub is enabled (Paid Compliance Aggregation Service).",
          "command": "aws securityhub get-enabled-standards --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.05s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "CONTROL: Validate that a Budget exists to track this security spending.",
          "command": "aws budgets describe-budgets --account-id $(aws sts get-caller-identity --query Account --output text) --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.79s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-RPL-01",
      "validation_id": "KSI-RPL-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review desired Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).",
      "implementation_summary": "RTO/RPO defined in disaster-recovery-plan.md: RPO=24hrs, RTO=4hrs. AWS Backup enforces daily backups with 30-day retention.",
      "justification": "Validates the Disaster Recovery Strategy. Checks for the 'Disaster Recovery Plan' (Governance) where RTO/RPO are defined, and active AWS Backup Plans (Technical) which enforce the RPO.",
      "long_name": "Recovery Planning",
      "category_prefix": "KSI-RPL",
      "cli_command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'recovery') || contains(absolutePath, 'disaster') || contains(absolutePath, 'continuity') || contains(absolutePath, 'bcp')]\" --output json; aws backup list-backup-plans --output json",
      "timestamp": "2026-02-19T04:59:59.747846Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-RPL-01/codecommit_045715_536.json",
      "total_category_controls": 1,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate existence of the Disaster Recovery / Business Continuity Plan.",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'recovery') || contains(absolutePath, 'disaster') || contains(absolutePath, 'continuity') || contains(absolutePath, 'bcp')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.97s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "TECHNICAL: Validate existence of AWS Backup Plans (proof that RPO is being enforced via automated schedules).",
          "command": "aws backup list-backup-plans --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-RPL-02",
      "validation_id": "KSI-RPL-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 6 items: 6 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the alignment of recovery plans with defined recovery objectives.",
      "implementation_summary": "Recovery plan alignment validated via successful backup job completion (203 jobs tracked). Failed jobs trigger alerts for review.",
      "justification": "Validates the active execution of the Recovery Plan. Checks for the Governance Document (The Plan) and successful AWS Backup Jobs (The Maintenance/Execution).",
      "long_name": "Recovery Planning",
      "category_prefix": "KSI-RPL",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/disaster-recovery-plan.md --output json; aws backup list-backup-jobs --by-state COMPLETED --max-results 5 --output json",
      "timestamp": "2026-02-19T04:59:59.747853Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-RPL-02/codecommit_045715_6510.json",
      "total_category_controls": 2,
      "resources_scanned": 6,
      "resources_passed": 6,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate existence of the defined Recovery Plan.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/disaster-recovery-plan.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.94s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "EXECUTION: Validate that backup jobs are successfully completing (Proof of Maintenance).",
          "command": "aws backup list-backup-jobs --by-state COMPLETED --max-results 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-RPL-03",
      "validation_id": "KSI-RPL-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review the alignment of machine-based information resource backups with defined recovery objectives.",
      "implementation_summary": "Backup alignment validated via quarterly restore tests. Restore jobs documented with duration metrics. Current success rate: 92.9%.",
      "justification": "Validates DR Testing. Checks for technical evidence of 'Restore Jobs' (Active Testing) and the formal 'DR Test Report' (Governance Evidence).",
      "long_name": "Recovery Planning",
      "category_prefix": "KSI-RPL",
      "cli_command": "aws backup list-restore-jobs --by-status COMPLETED --max-results 5 --output json; aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'dr-test') || contains(absolutePath, 'restore-report') || contains(absolutePath, 'after-action')]\" --output json",
      "timestamp": "2026-02-19T04:59:59.747859Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-RPL-03/backup_045715_5648.json",
      "total_category_controls": 3,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "TECHNICAL: Validate that Restore Jobs have been successfully executed (Proof of Testing).",
          "command": "aws backup list-restore-jobs --by-status COMPLETED --max-results 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "GOVERNANCE: Validate existence of the Disaster Recovery Test Report.",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'dr-test') || contains(absolutePath, 'restore-report') || contains(absolutePath, 'after-action')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-RPL-04",
      "validation_id": "KSI-RPL-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 4 items: 4 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently test the capability to recover from incidents and contingencies, including alignment with defined recovery objectives.",
      "implementation_summary": "Contingency testing via tabletop exercises and actual restore operations. IR test reports stored in CodeCommit with remediation tracking.",
      "justification": "Validates Contingency/Incident Recovery Testing. Checks for the specific 'Incident Response Test Report' (Governance) and evidence of 'Restore Jobs' (Technical capability to recover).",
      "long_name": "Recovery Planning",
      "category_prefix": "KSI-RPL",
      "cli_command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'incident-response-test') || contains(absolutePath, 'contingency-test') || contains(absolutePath, 'ir-test')]\" --output json; aws backup list-restore-jobs --by-status COMPLETED --max-results 5 --output json",
      "timestamp": "2026-02-19T04:59:59.747865Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-RPL-04/codecommit_045715_9709.json",
      "total_category_controls": 4,
      "resources_scanned": 4,
      "resources_passed": 4,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate existence of the Incident Response / Contingency Test Report.",
          "command": "aws codecommit get-folder --repository-name security-governance --folder-path policies/ --query \"files[?contains(absolutePath, 'incident-response-test') || contains(absolutePath, 'contingency-test') || contains(absolutePath, 'ir-test')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "TECHNICAL: Validate that Restore Jobs have been executed (Proof of recovery capability).",
          "command": "aws backup list-restore-jobs --by-status COMPLETED --max-results 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.83s",
          "error_message": null
        }
      ],
      "commands_executed": 2,
      "successful_commands": 2
    },
    {
      "ksi_id": "KSI-SVC-01",
      "validation_id": "KSI-SVC-01",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 31 items: 31 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Implement improvements based on persistent evaluation of information resources for opportunities to improve security.",
      "implementation_summary": "Continuous improvement via Inspector findings \u2192 SSM Patch Manager remediation. Custom patch baselines for security-critical updates.",
      "justification": "Validates the Continuous Improvement Loop. Checks for 'Evaluators' (Inspector/GuardDuty) and 'Improvers' (SSM Patch Manager) alongside the governance policy.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws inspector2 list-coverage --output json; aws ssm describe-patch-baselines --filters \"Key=OWNER,Values=[Self]\" --output json; aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
      "timestamp": "2026-02-19T04:59:59.747874Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-01/inspector2_045715_6186.json",
      "total_category_controls": 1,
      "resources_scanned": 31,
      "resources_passed": 31,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "EVALUATION: Validate that Inspector is actively scanning resources (The 'Persistent Evaluation').",
          "command": "aws inspector2 list-coverage --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.12s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "IMPROVEMENT: Validate existence of custom Patch Baselines (The mechanism for 'Implementing Improvements').",
          "command": "aws ssm describe-patch-baselines --filters \"Key=OWNER,Values=[Self]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "GOVERNANCE: Validate the policy defining the evaluation and improvement cycle.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/vulnerability-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-02",
      "validation_id": "KSI-SVC-02",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 3 items: 3 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Encrypt or otherwise secure network traffic.",
      "implementation_summary": "Network traffic encryption enforced via ACM-managed TLS certificates on ALB and CloudFront distributions. Encryption policy documented in CodeCommit governance repo. All external-facing endpoints require HTTPS.",
      "justification": "Validates Encryption in Transit. Checks for the Encryption Policy (Governance), ACM Certificates (The Keys), and Load Balancer/CloudFront configurations (The Enforcers).",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws acm list-certificates --certificate-statuses ISSUED --output json; aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, DNS:DNSName, Scheme:Scheme}\" --output json; aws cloudfront list-distributions --query \"DistributionList.Items[].{Id:Id, Domain:DomainName, Certificate:ViewerCertificate.Certificate}\" --output json; aws codecommit get-file --repository-name security-governance --file-path policies/encryption-policy.md --output json",
      "timestamp": "2026-02-19T04:59:59.747880Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-02/acm_045715_2420.json",
      "total_category_controls": 2,
      "resources_scanned": 3,
      "resources_passed": 3,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "KEYS: Validate existence of active, issued TLS certificates.",
          "command": "aws acm list-certificates --certificate-statuses ISSUED --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "GATEKEEPERS: List Load Balancers handling traffic.",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, DNS:DNSName, Scheme:Scheme}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.84s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "EDGE: Validate CloudFront distributions (CDN) are configured with certificates.",
          "command": "aws cloudfront list-distributions --query \"DistributionList.Items[].{Id:Id, Domain:DomainName, Certificate:ViewerCertificate.Certificate}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "GOVERNANCE: Validate the Encryption Policy document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/encryption-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        }
      ],
      "commands_executed": 4,
      "successful_commands": 4
    },
    {
      "ksi_id": "KSI-SVC-04",
      "validation_id": "KSI-SVC-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 1 items: 1 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Manage configuration of machine-based information resources using automation.",
      "implementation_summary": "Configuration management automated via Terraform with state stored in S3 (mks-states bucket) and DynamoDB state locking for concurrency control. Configuration management policy in CodeCommit mandates IaC-only changes.",
      "justification": "Validates Automated Configuration via Terraform. Checks for the Terraform State Bucket (The Configuration Source), the State Lock Table (Concurrency Control), and the Governance Policy.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'terraform') || contains(Name, 'state') || contains(Name, 'tfstate')]\" --output json; aws dynamodb list-tables --query \"TableNames[?contains(@, 'terraform') || contains(@, 'lock') || contains(@, 'state')]\" --output json; aws codecommit get-file --repository-name security-governance --file-path policies/configuration-management-policy.md --output json",
      "timestamp": "2026-02-19T04:59:59.747885Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-04/codecommit_045715_1046.json",
      "total_category_controls": 3,
      "resources_scanned": 1,
      "resources_passed": 1,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "IAC STATE: Validate existence of the Terraform State S3 bucket (The Proof of Automation).",
          "command": "aws s3api list-buckets --query \"Buckets[?contains(Name, 'terraform') || contains(Name, 'state') || contains(Name, 'tfstate')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.83s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CONCURRENCY: Validate existence of the Terraform State Lock table.",
          "command": "aws dynamodb list-tables --query \"TableNames[?contains(@, 'terraform') || contains(@, 'lock') || contains(@, 'state')]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "GOVERNANCE: Validate the Configuration Management Policy document.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/configuration-management-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.92s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-05",
      "validation_id": "KSI-SVC-05",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 6 items: 6 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Use cryptographic methods to validate the integrity of machine-based information resources.",
      "implementation_summary": "Cryptographic integrity validated via CloudTrail Log File Validation (digest hashing of audit trails), S3 bucket versioning on audit/artifact storage (tamper prevention), and SSM Session Manager for TLS-encrypted, IAM-signed instance access replacing SSH.",
      "justification": "Validates Cryptographic Integrity for EC2 Environments. Checks for: 1) CloudTrail Log File Validation (Cryptographic proof of audit logs), 2) S3 Versioning (Integrity of build artifacts/backups), and 3) SSM Session Manager (Cryptographically authenticated/encrypted console access).",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws cloudtrail describe-trails --query \"trailList[?LogFileValidationEnabled==true]\" --output json; aws s3api get-bucket-versioning --bucket $(aws cloudtrail describe-trails --query 'trailList[0].S3BucketName' --output text) --output json; aws ssm describe-instance-information --query \"InstanceInformationList[].{ID:InstanceId, PingStatus:PingStatus, AgentVersion:AgentVersion}\" --output json",
      "timestamp": "2026-02-19T04:59:59.747892Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-05/s3api_045715_5699.json",
      "total_category_controls": 4,
      "resources_scanned": 6,
      "resources_passed": 6,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "LOGS: Validate that CloudTrail Log File Validation is enabled (Cryptographic hashing of audit trails).",
          "command": "aws cloudtrail describe-trails --query \"trailList[?LogFileValidationEnabled==true]\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.80s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "STORAGE: Validate that the Audit/Artifact bucket has Versioning enabled (Prevents overwrite tampering).",
          "command": "aws s3api get-bucket-versioning --bucket $(aws cloudtrail describe-trails --query 'trailList[0].S3BucketName' --output text) --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.68s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "SESSIONS: Validate active SSM Agents, which enforce TLS-encrypted, IAM-signed channels for session integrity (Replacing insecure SSH).",
          "command": "aws ssm describe-instance-information --query \"InstanceInformationList[].{ID:InstanceId, PingStatus:PingStatus, AgentVersion:AgentVersion}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.88s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-06",
      "validation_id": "KSI-SVC-06",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 15 items: 15 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Automate management, protection, and regular rotation of digital keys, certificates, and other secrets.",
      "implementation_summary": "Cryptographic operations use AWS KMS with automatic key rotation (annual). Certificate management via ACM with auto-renewal.",
      "justification": "Validates Automated Secret Lifecycle. Checks for: 1) KMS Keys (Encryption Foundation), 2) Secrets Manager (Automated Rotation of credentials), and 3) ACM Certificates (Automated Renewal of TLS identities).",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws kms list-keys --limit 10 --output json; aws secretsmanager list-secrets --max-results 5 --output json; aws acm list-certificates --certificate-statuses ISSUED --max-items 10 --output json",
      "timestamp": "2026-02-19T04:59:59.747899Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-06/kms_045715_529.json",
      "total_category_controls": 5,
      "resources_scanned": 15,
      "resources_passed": 15,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "KEYS: Validate existence of KMS Customer Managed Keys (CMKs) for centralized management.",
          "command": "aws kms list-keys --limit 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.79s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "ROTATION: Validate Secrets Manager entries (Look for 'RotationEnabled': true in the output).",
          "command": "aws secretsmanager list-secrets --max-results 5 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "CERTIFICATES: Validate active ACM Certificates (Proof of managed renewal).",
          "command": "aws acm list-certificates --certificate-statuses ISSUED --max-items 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-08",
      "validation_id": "KSI-SVC-08",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 12 items: 12 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently review plans, procedures, and the state of information resources after making changes to limit and remove unwanted residual elements that would likely negatively affect the confidentiality, integrity, or availability of federal customer data.",
      "implementation_summary": "Residual data removal automated via S3 Lifecycle Policies (automatic expiration of temporary data), KMS key management (enabling crypto-shredding of encrypted backups), and a formal Data Sanitization Policy defining destruction procedures.",
      "justification": "Validates Data Sanitization and Destruction Capabilities. Checks for S3 Lifecycle Policies (Automated removal of residual data), KMS Keys (Capability for crypto-shredding backups), and the Data Sanitization Policy.",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws s3api get-bucket-lifecycle-configuration --bucket $(aws s3api list-buckets --query 'Buckets[0].Name' --output text) --output json || echo '{\"Rules\": []}'; aws kms list-keys --limit 10 --output json; aws codecommit get-file --repository-name security-governance --file-path policies/data-sanitization-policy.md --output json",
      "timestamp": "2026-02-19T04:59:59.747905Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-08/s3api_045715_4424.json",
      "total_category_controls": 6,
      "resources_scanned": 12,
      "resources_passed": 12,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "AUTOMATION: Validate S3 Lifecycle Rules that automatically expire/delete temporary or residual data.",
          "command": "aws s3api get-bucket-lifecycle-configuration --bucket $(aws s3api list-buckets --query 'Buckets[0].Name' --output text) --output json || echo '{\"Rules\": []}'",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.64s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "CAPABILITY: Validate existence of KMS keys. Deleting a key is the industry-standard method for 'Crypto-Shredding' data from immutable backups.",
          "command": "aws kms list-keys --limit 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.79s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "GOVERNANCE: Validate the Data Sanitization Policy which defines the procedure for destroying customer data.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/data-sanitization-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.89s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-09",
      "validation_id": "KSI-SVC-09",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 2 items: 2 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently validate the authenticity and integrity of communications between machine-based information resources using automation.",
      "implementation_summary": "Communication authenticity and integrity validated via HTTPS/TLS enforcement on ALB listeners with specific SSL policies (TLS 1.2+), and ACM-issued certificates proving endpoint identity. All load balancer traffic encrypted in transit.",
      "justification": "Validates Communication Integrity. Checks for Active TLS Listeners (Enforcement of Encryption) and ACM Certificates (Validation of Authenticity/Identity).",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, Scheme:Scheme}\" --output json; for arn in $(aws elbv2 describe-load-balancers --query 'LoadBalancers[].LoadBalancerArn' --output text 2>/dev/null || echo ''); do aws elbv2 describe-listeners --load-balancer-arn \"$arn\" --query \"Listeners[?Protocol=='HTTPS' || Protocol=='TLS'].{Port:Port, SslPolicy:SslPolicy, Certificates:Certificates}\" --output json; done; aws acm list-certificates --certificate-statuses ISSUED --max-items 10 --output json",
      "timestamp": "2026-02-19T04:59:59.747911Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-09/elbv2_045715_5941.json",
      "total_category_controls": 7,
      "resources_scanned": 2,
      "resources_passed": 2,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "ENFORCERS: Identify active Load Balancers handling traffic.",
          "command": "aws elbv2 describe-load-balancers --query \"LoadBalancers[].{ARN:LoadBalancerArn, Scheme:Scheme}\" --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.86s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "VALIDATION: Verify that listeners are enforcing HTTPS/TLS with specific SSL Policies (authenticity/integrity checks).",
          "command": "for arn in $(aws elbv2 describe-load-balancers --query 'LoadBalancers[].LoadBalancerArn' --output text 2>/dev/null || echo ''); do aws elbv2 describe-listeners --load-balancer-arn \"$arn\" --query \"Listeners[?Protocol=='HTTPS' || Protocol=='TLS'].{Port:Port, SslPolicy:SslPolicy, Certificates:Certificates}\" --output json; done",
          "status": "success",
          "exit_code": 0,
          "execution_time": null,
          "error_message": null
        },
        {
          "index": 2,
          "description": "IDENTITY: Validate existence of issued ACM certificates used to prove authenticity.",
          "command": "aws acm list-certificates --certificate-statuses ISSUED --max-items 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-SVC-10",
      "validation_id": "KSI-SVC-10",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 13 items: 13 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Remove unwanted federal customer data promptly when requested by an agency in alignment with customer agreements, including from backups if appropriate.",
      "implementation_summary": "Data removal capabilities validated via Data Sanitization Policy (defining promptly SLA and procedures), AWS Backup Plans with automated retention/expiration rules, and KMS keys enabling crypto-shredding of data from immutable backups.",
      "justification": "Validates Data Removal Capabilities. Checks for: 1) The Sanitization Policy (SLA for removal), 2) Backup Plans (Automated Retention/Expiration), and 3) KMS Keys (Immediate Destruction via Crypto-Shredding).",
      "long_name": "Service Configuration Management",
      "category_prefix": "KSI-SVC",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/data-sanitization-policy.md --output json; aws backup list-backup-plans --output json; aws kms list-keys --limit 10 --output json",
      "timestamp": "2026-02-19T04:59:59.747917Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-SVC-10/codecommit_045715_1638.json",
      "total_category_controls": 8,
      "resources_scanned": 13,
      "resources_passed": 13,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "GOVERNANCE: Validate the Data Sanitization Policy (defines the 'Promptly' SLA and procedure).",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/data-sanitization-policy.md --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.02s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "RETENTION: Validate Backup Plans to ensure automated expiration rules are in place (Data doesn't live forever).",
          "command": "aws backup list-backup-plans --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.81s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "DESTRUCTION: Validate KMS Keys (The mechanism for 'Crypto-Shredding' data from immutable backups).",
          "command": "aws kms list-keys --limit 10 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.82s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-TPR-03",
      "validation_id": "KSI-TPR-03",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 48 items: 48 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Persistently identify, review, and mitigate potential supply chain risks.",
      "implementation_summary": "Supply chain risk management policy maintained in CodeCommit (security-governance repo) with formal approval rule templates and version-controlled commit history providing an audit trail of policy reviews and updates.",
      "justification": "Validates the supply chain risk management policy's existence, its maintenance history, and the existence of a formal approval workflow.",
      "long_name": "Third-Party Information Resources",
      "category_prefix": "KSI-TPR",
      "cli_command": "aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md; aws codecommit list-approval-rule-templates --output json; aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
      "timestamp": "2026-02-19T04:59:59.747927Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-TPR-03/codecommit_045715_97.json",
      "total_category_controls": 1,
      "resources_scanned": 48,
      "resources_passed": 48,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Retrieve the supply chain risk management policy from CodeCommit to verify its existence and size.",
          "command": "aws codecommit get-file --repository-name security-governance --file-path policies/supply-chain-risk-management.md",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.95s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate that a formal approval rule process is configured for the repository.",
          "command": "aws codecommit list-approval-rule-templates --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.80s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Check the commit history for an audit trail of recent policy updates.",
          "command": "aws codecommit get-differences --repository-name security-governance --after-commit-specifier refs/heads/main --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.90s",
          "error_message": null
        }
      ],
      "commands_executed": 3,
      "successful_commands": 3
    },
    {
      "ksi_id": "KSI-TPR-04",
      "validation_id": "KSI-TPR-04",
      "assertion": true,
      "assertion_reason": "\u2705 Excellent (100%): 8 items: 8 verified",
      "recommended_action": "\u2705 No action required - excellent compliance maintained.",
      "requirement": "Automatically monitor third party software information resources for upstream vulnerabilities using mechanisms that may include contractual notification requirements or active monitoring services.",
      "implementation_summary": "Third-party software vulnerabilities monitored via AWS Inspector with continuous scanning enabled for OS and application components. Active findings tracked for remediation. EC2 coverage validated alongside SSM agent deployment for patch management.",
      "justification": "Validates comprehensive vulnerability scanning from basic Inspector to enterprise-grade continuous scanning and automated remediation",
      "long_name": "Third-Party Information Resources",
      "category_prefix": "KSI-TPR",
      "cli_command": "aws inspector2 get-configuration --output json; aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"OPERATING_SYSTEM\"}]}' --max-results 50 --output json; aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"APPLICATION\"}]}' --max-results 50 --output json; aws inspector2 list-findings --filter-criteria '{\"findingStatus\":[{\"comparison\":\"EQUALS\",\"value\":\"ACTIVE\"}]}' --max-results 100 --output json; aws inspector2 list-coverage --filter-criteria '{\"resourceType\":[{\"comparison\":\"EQUALS\",\"value\":\"AWS_EC2_INSTANCE\"}]}' --max-results 100 --output json; aws ssm describe-instance-information --output json",
      "timestamp": "2026-02-19T04:59:59.747934Z",
      "score": 100,
      "evidence_path": "evidence_v2/KSI-TPR-04/inspector2_045715_8306.json",
      "total_category_controls": 2,
      "resources_scanned": 8,
      "resources_passed": 8,
      "resources_failed": 0,
      "command_executions": [
        {
          "index": 0,
          "description": "Check Inspector configuration for vulnerability scanning",
          "command": "aws inspector2 get-configuration --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.85s",
          "error_message": null
        },
        {
          "index": 1,
          "description": "Validate OS vulnerability findings from Inspector",
          "command": "aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"OPERATING_SYSTEM\"}]}' --max-results 50 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.96s",
          "error_message": null
        },
        {
          "index": 2,
          "description": "Check application vulnerability findings from Inspector",
          "command": "aws inspector2 list-findings --filter-criteria '{\"componentType\":[{\"comparison\":\"EQUALS\",\"value\":\"APPLICATION\"}]}' --max-results 50 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.93s",
          "error_message": null
        },
        {
          "index": 3,
          "description": "Validate active vulnerability findings requiring remediation",
          "command": "aws inspector2 list-findings --filter-criteria '{\"findingStatus\":[{\"comparison\":\"EQUALS\",\"value\":\"ACTIVE\"}]}' --max-results 100 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "1.28s",
          "error_message": null
        },
        {
          "index": 4,
          "description": "Check Inspector coverage for EC2 instances",
          "command": "aws inspector2 list-coverage --filter-criteria '{\"resourceType\":[{\"comparison\":\"EQUALS\",\"value\":\"AWS_EC2_INSTANCE\"}]}' --max-results 100 --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.97s",
          "error_message": null
        },
        {
          "index": 5,
          "description": "Validate SSM agent deployment for vulnerability management",
          "command": "aws ssm describe-instance-information --output json",
          "status": "success",
          "exit_code": 0,
          "execution_time": "0.87s",
          "error_message": null
        }
      ],
      "commands_executed": 6,
      "successful_commands": 6
    }
  ]
}